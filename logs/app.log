2025-05-19 14:48:27 - root - INFO - Configuración de logging inicializada
2025-05-19 14:51:29 - hydrous - WARNING - Token expirado
2025-05-19 14:51:50 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-05-19 14:51:50 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-05-19 14:51:50 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-05-19 14:51:50 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-05-19 14:51:50 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-05-19 14:51:50 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-05-19 14:51:50 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:51:50 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.email = %(email_1)s 
 LIMIT %(param_1)s
2025-05-19 14:51:50 - sqlalchemy.engine.Engine - INFO - [generated in 0.00092s] {'email_1': 'hydrous20@gmail.com', 'param_1': 1}
2025-05-19 14:51:50 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-05-19 14:51:51 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - [generated in 0.00191s] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 14:51:53 - hydrous - INFO - Datos del usuario al iniciar conversación: nombre=Ricardo Altamirano, empresa=hydrous, sector=commercial, subsector=Hotel, ubicación=los mochis, email=hydrous20@gmail.com
2025-05-19 14:51:53 - hydrous - INFO - Metadata inicial de la conversación: {'client_name': 'Ricardo Altamirano', 'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'selected_sector': 'commercial', 'selected_subsector': 'Hotel', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversations (user_id, selected_sector, selected_subsector, current_question_id, is_complete, has_proposal, client_name, proposal_text, pdf_path, id, created_at) VALUES (%(user_id)s::UUID, %(selected_sector)s, %(selected_subsector)s, %(current_question_id)s, %(is_complete)s, %(has_proposal)s, %(client_name)s, %(proposal_text)s, %(pdf_path)s, %(id)s::UUID, %(created_at)s)
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - [generated in 0.00076s] {'user_id': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'selected_sector': 'commercial', 'selected_subsector': 'Hotel', 'current_question_id': None, 'is_complete': False, 'has_proposal': False, 'client_name': 'Ricardo Altamirano', 'proposal_text': None, 'pdf_path': None, 'id': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'created_at': datetime.datetime(2025, 5, 19, 14, 51, 53, 811781)}
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversation_metadata (conversation_id, key, value, id, created_at) VALUES (%(conversation_id__0)s::UUID, %(key__0)s, %(value__0)s::JSONB, %(id__0)s::UUID, %(created_at__0)s), (%(conversation_id__1)s::UUID, %(key__1)s, %(value__1)s::JSONB ... 543 characters truncated ...  (%(conversation_id__7)s::UUID, %(key__7)s, %(value__7)s::JSONB, %(id__7)s::UUID, %(created_at__7)s)
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - [generated in 0.00020s (insertmanyvalues) 1/1 (unordered)] {'key__0': 'user_name', 'value__0': '"Ricardo Altamirano"', 'created_at__0': datetime.datetime(2025, 5, 19, 14, 51, 53, 832883), 'id__0': UUID('ed27e261-c79b-4b38-b2c8-dfb0372a6e04'), 'conversation_id__0': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'key__1': 'user_location', 'value__1': '"los mochis"', 'created_at__1': datetime.datetime(2025, 5, 19, 14, 51, 53, 832888), 'id__1': UUID('2877206b-0d58-4cb7-a993-7948420e7c0c'), 'conversation_id__1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'key__2': 'sector', 'value__2': '"commercial"', 'created_at__2': datetime.datetime(2025, 5, 19, 14, 51, 53, 832890), 'id__2': UUID('68616c10-97b6-4cb4-9262-dd1cfdae6052'), 'conversation_id__2': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'key__3': 'subsector', 'value__3': '"Hotel"', 'created_at__3': datetime.datetime(2025, 5, 19, 14, 51, 53, 832891), 'id__3': UUID('73ae377f-a861-4762-b094-ed8e364efe15'), 'conversation_id__3': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'key__4': 'company_name', 'value__4': '"hydrous"', 'created_at__4': datetime.datetime(2025, 5, 19, 14, 51, 53, 832893), 'id__4': UUID('cb2c4129-7146-4851-9644-d3c87c2f67ea'), 'conversation_id__4': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'key__5': 'user_email', 'value__5': '"hydrous20@gmail.com"', 'created_at__5': datetime.datetime(2025, 5, 19, 14, 51, 53, 832894), 'id__5': UUID('6eb8dcf4-2b90-4bf8-a97c-5c36d3de112f'), 'conversation_id__5': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'key__6': 'is_new_conversation', 'value__6': 'true', 'created_at__6': datetime.datetime(2025, 5, 19, 14, 51, 53, 832896), 'id__6': UUID('8d5e2c1a-425b-4b59-a817-d02a9fe3e76c'), 'conversation_id__6': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'key__7': 'first_interaction', 'value__7': 'true', 'created_at__7': datetime.datetime(2025, 5, 19, 14, 51, 53, 832897), 'id__7': UUID('1fd09383-aebb-4058-baa9-421fd306f780'), 'conversation_id__7': UUID('b433cbcb-a80e-4dc1-be27-466800c52463')}
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - [generated in 0.00121s] {'pk_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463')}
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - [generated in 0.00106s] {'id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'param_1': 1}
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - [cached since 0.01978s ago] {'pk_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463')}
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - [generated in 0.00168s] {'conversation_id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'key_1': 'user_name', 'param_1': 1}
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - [cached since 0.009459s ago] {'conversation_id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'key_1': 'user_location', 'param_1': 1}
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - [cached since 0.01482s ago] {'conversation_id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'key_1': 'sector', 'param_1': 1}
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - [cached since 0.02317s ago] {'conversation_id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'key_1': 'subsector', 'param_1': 1}
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - [cached since 0.03648s ago] {'conversation_id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'key_1': 'company_name', 'param_1': 1}
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - [cached since 0.04847s ago] {'conversation_id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'key_1': 'user_email', 'param_1': 1}
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - [cached since 0.05558s ago] {'conversation_id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'key_1': 'is_new_conversation', 'param_1': 1}
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - [cached since 0.06421s ago] {'conversation_id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'key_1': 'first_interaction', 'param_1': 1}
2025-05-19 14:51:53 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:51:53 - hydrous - INFO - DBG_SS: Conversación b433cbcb-a80e-4dc1-be27-466800c52463 actualizada en base de datos.
2025-05-19 14:52:00 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:00 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 14:52:00 - sqlalchemy.engine.Engine - INFO - [cached since 6.307s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 14:52:00 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 14:52:00 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:00 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 14:52:00 - sqlalchemy.engine.Engine - INFO - [cached since 6.235s ago] {'id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'param_1': 1}
2025-05-19 14:52:00 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE messages.conversation_id = %(conversation_id_1)s::UUID ORDER BY messages.created_at
2025-05-19 14:52:00 - sqlalchemy.engine.Engine - INFO - [generated in 0.00089s] {'conversation_id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463')}
2025-05-19 14:52:00 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID
2025-05-19 14:52:00 - sqlalchemy.engine.Engine - INFO - [generated in 0.00031s] {'conversation_id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463')}
2025-05-19 14:52:00 - hydrous - INFO - DBG_SS: Conversación b433cbcb-a80e-4dc1-be27-466800c52463 RECUPERADA. Metadata actual: {'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 14:52:00 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 14:52:00 - sqlalchemy.engine.Engine - INFO - [cached since 6.27s ago] {'id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'param_1': 1}
2025-05-19 14:52:00 - hydrous - INFO - PDF_CHECK: ConvID=b433cbcb-a80e-4dc1-be27-466800c52463, Input='si', is_pdf_req=False, proposal_ready=False, is_complete=False, pdf_path=None, ready_for_proposal=False
2025-05-19 14:52:00 - hydrous - INFO - Normal flow for conversation b433cbcb-a80e-4dc1-be27-466800c52463
2025-05-19 14:52:00 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 14:52:00 - sqlalchemy.engine.Engine - INFO - [cached since 6.272s ago] {'id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'param_1': 1}
2025-05-19 14:52:00 - sqlalchemy.engine.Engine - INFO - INSERT INTO messages (conversation_id, role, content, id, created_at) VALUES (%(conversation_id)s::UUID, %(role)s, %(content)s, %(id)s::UUID, %(created_at)s)
2025-05-19 14:52:00 - sqlalchemy.engine.Engine - INFO - [generated in 0.00056s] {'conversation_id': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'role': 'user', 'content': 'si', 'id': UUID('92ed53de-28c3-460f-b1fc-af21576e8374'), 'created_at': datetime.datetime(2025, 5, 19, 14, 52, 0, 140631)}
2025-05-19 14:52:00 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:00 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:00 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id, messages.role, messages.content, messages.id, messages.created_at 
FROM messages 
WHERE messages.id = %(pk_1)s::UUID
2025-05-19 14:52:00 - sqlalchemy.engine.Engine - INFO - [generated in 0.00019s] {'pk_1': UUID('92ed53de-28c3-460f-b1fc-af21576e8374')}
2025-05-19 14:52:00 - hydrous - INFO - Primera interacción detectada para conversación b433cbcb-a80e-4dc1-be27-466800c52463. Actualizando metadata.
2025-05-19 14:52:00 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 14:52:00 - sqlalchemy.engine.Engine - INFO - [cached since 6.292s ago] {'id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'param_1': 1}
2025-05-19 14:52:00 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE messages.conversation_id = %(conversation_id_1)s::UUID ORDER BY messages.created_at
2025-05-19 14:52:00 - sqlalchemy.engine.Engine - INFO - [cached since 0.04765s ago] {'conversation_id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463')}
2025-05-19 14:52:00 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID
2025-05-19 14:52:00 - sqlalchemy.engine.Engine - INFO - [cached since 0.02705s ago] {'conversation_id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463')}
2025-05-19 14:52:00 - hydrous - INFO - DBG_SS: Conversación b433cbcb-a80e-4dc1-be27-466800c52463 RECUPERADA. Metadata actual: {'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 14:52:00 - hydrous - INFO - DBG_AI_HANDLE: Iniciando handle_conversation para conv b433cbcb-a80e-4dc1-be27-466800c52463
2025-05-19 14:52:00 - hydrous - INFO - Metadata recibida en _prepare_messages: sector=commercial, subsector=Hotel, location=los mochis, client_name=Ricardo Altamirano, company_name=hydrous, is_new_conversation=True
2025-05-19 14:52:00 - hydrous - INFO - Datos de usuario procesados: nombre=Ricardo Altamirano, empresa=hydrous, sector=commercial, subsector=Hotel, ubicacion=los mochis, nueva_conversacion=True, primera_interaccion=True
2025-05-19 14:52:00 - hydrous - INFO - Added additional user context and conversation state to the prompt.
2025-05-19 14:52:00 - hydrous - INFO - DBG_AI_HANDLE: Mensajes preparados OK (Total: 3).
2025-05-19 14:52:00 - hydrous - INFO - DBG_AI_CALL: Iniciando llamada a API LLM. URL: https://api.openai.com/v1/chat/completions, Model: gpt-4o-mini, #Msgs: 3
2025-05-19 14:52:05 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-19 14:52:05 - hydrous - INFO - DBG_AI_CALL: Llamada a API completada. Status: 200
2025-05-19 14:52:05 - hydrous - INFO - DBG_AI_CALL: Contenido LLM extraído exitosamente (longitud: 682).
2025-05-19 14:52:05 - hydrous - INFO - DBG_AI_HANDLE: Respuesta LLM recibida (primeros 50 chars): 'Entiendo que confirmas tu información. Gracias por'
2025-05-19 14:52:05 - hydrous - INFO - Metadata[current_question_asked_summary] actualizada a: '¿Cuál es el costo del agua en tu ubicación?'
2025-05-19 14:52:05 - hydrous - INFO - DBG_AI_HANDLE: Finalizando handle_conversation para b433cbcb-a80e-4dc1-be27-466800c52463. Respuesta final: 'Entiendo que confirmas tu información. Gracias por...'
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 11.4s ago] {'id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'param_1': 1}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - INSERT INTO messages (conversation_id, role, content, id, created_at) VALUES (%(conversation_id)s::UUID, %(role)s, %(content)s, %(id)s::UUID, %(created_at)s)
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 5.14s ago] {'conversation_id': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'role': 'assistant', 'content': 'Entiendo que confirmas tu información. Gracias por hacerlo. Vamos a continuar recopilando datos clave para diseñar una solución de tratamiento y reci ... (390 characters truncated) ... ué preguntamos esto?* Conocer el costo del agua es fundamental para evaluar la viabilidad económica de las soluciones de tratamiento y reutilización.', 'id': UUID('d3cf2caa-d8d7-4a92-9d04-dc2b432ebb32'), 'created_at': datetime.datetime(2025, 5, 19, 14, 52, 5, 278806)}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id, messages.role, messages.content, messages.id, messages.created_at 
FROM messages 
WHERE messages.id = %(pk_1)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 5.139s ago] {'pk_1': UUID('d3cf2caa-d8d7-4a92-9d04-dc2b432ebb32')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 11.43s ago] {'id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'param_1': 1}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - UPDATE conversations SET current_question_id=%(current_question_id)s WHERE conversations.id = %(conversations_id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [generated in 0.00064s] {'current_question_id': 'q_4', 'conversations_id': UUID('b433cbcb-a80e-4dc1-be27-466800c52463')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 11.46s ago] {'pk_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 11.44s ago] {'conversation_id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'key_1': 'user_name', 'param_1': 1}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 11.44s ago] {'conversation_id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'key_1': 'user_location', 'param_1': 1}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 11.45s ago] {'conversation_id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'key_1': 'sector', 'param_1': 1}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 11.45s ago] {'conversation_id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'key_1': 'subsector', 'param_1': 1}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 11.45s ago] {'conversation_id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'key_1': 'company_name', 'param_1': 1}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 11.46s ago] {'conversation_id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'key_1': 'user_email', 'param_1': 1}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 11.46s ago] {'conversation_id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'key_1': 'is_new_conversation', 'param_1': 1}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 11.46s ago] {'conversation_id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'key_1': 'first_interaction', 'param_1': 1}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 11.47s ago] {'conversation_id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'key_1': 'location', 'param_1': 1}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversation_metadata (conversation_id, key, value, id, created_at) VALUES (%(conversation_id)s::UUID, %(key)s, %(value)s::JSONB, %(id)s::UUID, %(created_at)s)
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [generated in 0.00032s] {'conversation_id': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'key': 'location', 'value': '"los mochis"', 'id': UUID('8e734ca5-4e79-451d-a06d-fed91c107b5e'), 'created_at': datetime.datetime(2025, 5, 19, 14, 52, 5, 347752)}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 11.47s ago] {'conversation_id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'key_1': 'current_question_asked_summary', 'param_1': 1}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversation_metadata (conversation_id, key, value, id, created_at) VALUES (%(conversation_id)s::UUID, %(key)s, %(value)s::JSONB, %(id)s::UUID, %(created_at)s)
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.005405s ago] {'conversation_id': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'key': 'current_question_asked_summary', 'value': '"\\u00bfCu\\u00e1l es el costo del agua en tu ubicaci\\u00f3n?"', 'id': UUID('c24ae289-cd3a-4f8e-87b3-a80439896449'), 'created_at': datetime.datetime(2025, 5, 19, 14, 52, 5, 352837)}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:05 - hydrous - INFO - DBG_SS: Conversación b433cbcb-a80e-4dc1-be27-466800c52463 actualizada en base de datos.
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.created_at < %(created_at_1)s
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [generated in 0.00037s] {'created_at_1': datetime.datetime(2025, 5, 18, 14, 52, 5, 358443)}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE %(param_1)s::UUID = messages.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [generated in 0.00059s] {'param_1': UUID('0c1985d6-2f08-4fe4-adb9-937dc5cfe77f')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE %(param_1)s::UUID = conversation_metadata.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [generated in 0.00063s] {'param_1': UUID('0c1985d6-2f08-4fe4-adb9-937dc5cfe77f')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT documents.conversation_id AS documents_conversation_id, documents.filename AS documents_filename, documents.file_path AS documents_file_path, documents.content_type AS documents_content_type, documents.processed_text AS documents_processed_text, documents.id AS documents_id, documents.created_at AS documents_created_at 
FROM documents 
WHERE %(param_1)s::UUID = documents.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [generated in 0.00307s] {'param_1': UUID('0c1985d6-2f08-4fe4-adb9-937dc5cfe77f')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM conversation_metadata WHERE conversation_metadata.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [generated in 0.00034s] [{'id': UUID('1a67a9a3-02dd-4c75-ab85-124da4c01279')}, {'id': UUID('3b77c4f5-63ab-4ceb-80c9-06da0ceafb52')}, {'id': UUID('7f5743c5-86ed-4e86-8312-4d4bf5649a3c')}, {'id': UUID('879c2ab8-b36d-4ec3-807b-2cf8b356555c')}, {'id': UUID('8814c96a-acf2-40d5-be77-0d3c0f0f2bd0')}, {'id': UUID('bc05c554-ebb5-4364-a1c4-ea17191a8f67')}, {'id': UUID('db9f45da-90a6-4875-ad8c-00dad2be6650')}]
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM messages WHERE messages.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [generated in 0.00030s] [{'id': UUID('1e710638-5e0c-470f-87c3-9d4fc87cba0e')}, {'id': UUID('8d8d7b5a-cc72-46be-9c0c-c4c2eb6cf473')}]
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM conversations WHERE conversations.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [generated in 0.00069s] {'id': UUID('0c1985d6-2f08-4fe4-adb9-937dc5cfe77f')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [generated in 0.00025s] {'pk_1': UUID('2bdc7b8a-a3ce-46b4-b9a3-5e0c644948f8')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE %(param_1)s::UUID = messages.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.0238s ago] {'param_1': UUID('2bdc7b8a-a3ce-46b4-b9a3-5e0c644948f8')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE %(param_1)s::UUID = conversation_metadata.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.02089s ago] {'param_1': UUID('2bdc7b8a-a3ce-46b4-b9a3-5e0c644948f8')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT documents.conversation_id AS documents_conversation_id, documents.filename AS documents_filename, documents.file_path AS documents_file_path, documents.content_type AS documents_content_type, documents.processed_text AS documents_processed_text, documents.id AS documents_id, documents.created_at AS documents_created_at 
FROM documents 
WHERE %(param_1)s::UUID = documents.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.01879s ago] {'param_1': UUID('2bdc7b8a-a3ce-46b4-b9a3-5e0c644948f8')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM conversation_metadata WHERE conversation_metadata.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.01456s ago] [{'id': UUID('14986c3e-0da5-4ca7-b6d3-2de71d2da420')}, {'id': UUID('425a183c-8d8e-4fdf-bf19-2bf667138e6d')}, {'id': UUID('71700429-e079-47f5-adff-d1b5fa6172b5')}, {'id': UUID('a4773572-9d42-4747-b3e3-abef3563d78f')}, {'id': UUID('cb919ab0-8982-4c2e-a5b7-4b24065e7aae')}, {'id': UUID('d4a2760e-b1a8-48eb-979d-f9e77955bbca')}]
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM conversations WHERE conversations.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.01195s ago] {'id': UUID('2bdc7b8a-a3ce-46b4-b9a3-5e0c644948f8')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.01186s ago] {'pk_1': UUID('fe925664-5676-430d-97af-70b851d96a04')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE %(param_1)s::UUID = messages.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.03697s ago] {'param_1': UUID('fe925664-5676-430d-97af-70b851d96a04')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE %(param_1)s::UUID = conversation_metadata.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.03487s ago] {'param_1': UUID('fe925664-5676-430d-97af-70b851d96a04')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT documents.conversation_id AS documents_conversation_id, documents.filename AS documents_filename, documents.file_path AS documents_file_path, documents.content_type AS documents_content_type, documents.processed_text AS documents_processed_text, documents.id AS documents_id, documents.created_at AS documents_created_at 
FROM documents 
WHERE %(param_1)s::UUID = documents.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.03355s ago] {'param_1': UUID('fe925664-5676-430d-97af-70b851d96a04')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM conversation_metadata WHERE conversation_metadata.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.02875s ago] [{'id': UUID('28b4aa13-3f1c-469b-a303-b94db18ed06f')}, {'id': UUID('4241b9ce-2206-4da5-ac79-695c5a8205bd')}, {'id': UUID('4b6b7993-bbf0-4181-88e2-3aa96ce3d8db')}, {'id': UUID('8c21b89d-d6c4-4ba7-8063-08d4c22d06df')}, {'id': UUID('a54e55ff-d715-4b45-a42e-92c75ff3e2f2')}, {'id': UUID('f9d03798-b9d1-4a38-b4b8-2d6cd715d7e3')}]
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM conversations WHERE conversations.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.02629s ago] {'id': UUID('fe925664-5676-430d-97af-70b851d96a04')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.02604s ago] {'pk_1': UUID('ccf97137-889c-4fbd-8b10-07aa775fa42b')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE %(param_1)s::UUID = messages.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.05033s ago] {'param_1': UUID('ccf97137-889c-4fbd-8b10-07aa775fa42b')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE %(param_1)s::UUID = conversation_metadata.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.04792s ago] {'param_1': UUID('ccf97137-889c-4fbd-8b10-07aa775fa42b')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT documents.conversation_id AS documents_conversation_id, documents.filename AS documents_filename, documents.file_path AS documents_file_path, documents.content_type AS documents_content_type, documents.processed_text AS documents_processed_text, documents.id AS documents_id, documents.created_at AS documents_created_at 
FROM documents 
WHERE %(param_1)s::UUID = documents.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.04627s ago] {'param_1': UUID('ccf97137-889c-4fbd-8b10-07aa775fa42b')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM conversation_metadata WHERE conversation_metadata.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.04195s ago] [{'id': UUID('02dd8d5b-b274-421f-982c-131f495ef6f4')}, {'id': UUID('3806b62e-5350-46ce-9cf3-2d977ab6329c')}, {'id': UUID('587e047a-b9c7-42ca-90fb-6542b1a08556')}, {'id': UUID('5cc7a20e-685c-43f0-bedb-4988d9a12cce')}, {'id': UUID('bcc0028f-d4c1-4643-a9b3-5d5db560c06a')}, {'id': UUID('d69f6c4f-527b-4e35-adb7-59efe8cb0543')}, {'id': UUID('e6840ac4-a539-40db-b3ce-f37d95ab912a')}]
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM messages WHERE messages.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.04089s ago] [{'id': UUID('8cf72e11-347b-41b5-9c99-9c04df963638')}, {'id': UUID('cc5c0c9d-a234-4920-846b-6fb936f392d3')}]
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM conversations WHERE conversations.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.03976s ago] {'id': UUID('ccf97137-889c-4fbd-8b10-07aa775fa42b')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.03887s ago] {'pk_1': UUID('79a68915-8ef9-4e9c-b2c7-dedffad791d4')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE %(param_1)s::UUID = messages.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.06331s ago] {'param_1': UUID('79a68915-8ef9-4e9c-b2c7-dedffad791d4')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE %(param_1)s::UUID = conversation_metadata.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.06109s ago] {'param_1': UUID('79a68915-8ef9-4e9c-b2c7-dedffad791d4')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT documents.conversation_id AS documents_conversation_id, documents.filename AS documents_filename, documents.file_path AS documents_file_path, documents.content_type AS documents_content_type, documents.processed_text AS documents_processed_text, documents.id AS documents_id, documents.created_at AS documents_created_at 
FROM documents 
WHERE %(param_1)s::UUID = documents.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.06036s ago] {'param_1': UUID('79a68915-8ef9-4e9c-b2c7-dedffad791d4')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM conversation_metadata WHERE conversation_metadata.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.05549s ago] [{'id': UUID('0175228d-491a-47d5-9b92-b0505c508b98')}, {'id': UUID('1f26e363-19de-4169-8e24-d7c46e2bd682')}, {'id': UUID('2ceac5e2-b6fd-492d-8c52-2b69e3245cf1')}, {'id': UUID('38ef7de6-1aa3-4574-89dc-a298972b661a')}, {'id': UUID('3e374bff-2849-4189-bca4-8cad232580f6')}, {'id': UUID('a7a250d2-b1ea-481d-b8d7-c1a5ff5f271a')}, {'id': UUID('e4f12756-03a1-4cf6-89c1-e2282425f3ff')}]
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM messages WHERE messages.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.05483s ago] [{'id': UUID('70a63f69-2b7b-4a9c-9a83-8e70e9921dfe')}, {'id': UUID('bd3944c3-16dc-4c5e-a017-e9ba06184806')}]
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM conversations WHERE conversations.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.05408s ago] {'id': UUID('79a68915-8ef9-4e9c-b2c7-dedffad791d4')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.05293s ago] {'pk_1': UUID('a5897182-4761-49c8-9294-20f543b44b46')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE %(param_1)s::UUID = messages.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.07659s ago] {'param_1': UUID('a5897182-4761-49c8-9294-20f543b44b46')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE %(param_1)s::UUID = conversation_metadata.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.07403s ago] {'param_1': UUID('a5897182-4761-49c8-9294-20f543b44b46')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT documents.conversation_id AS documents_conversation_id, documents.filename AS documents_filename, documents.file_path AS documents_file_path, documents.content_type AS documents_content_type, documents.processed_text AS documents_processed_text, documents.id AS documents_id, documents.created_at AS documents_created_at 
FROM documents 
WHERE %(param_1)s::UUID = documents.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.07316s ago] {'param_1': UUID('a5897182-4761-49c8-9294-20f543b44b46')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM conversation_metadata WHERE conversation_metadata.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.06874s ago] [{'id': UUID('10648068-be8b-432e-99fc-849e241bd60e')}, {'id': UUID('249def24-acd6-49b1-88cb-3177a5f9847a')}, {'id': UUID('8b86c11c-845e-45e7-97c9-0a0ae45cead7')}, {'id': UUID('90af892e-c47d-49be-82a7-323c1ec743a9')}, {'id': UUID('9b9fa145-c890-4a76-b996-b49c10739a2f')}, {'id': UUID('ccfac7ea-403b-4e2f-b484-269485841f52')}, {'id': UUID('efb6f9ab-6179-40a1-a8ad-cf24d2423f1f')}]
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM messages WHERE messages.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.06757s ago] [{'id': UUID('6766a760-5255-49bd-b391-41232814cf2e')}, {'id': UUID('ea1be913-c21f-475b-bb64-7c5e249f9e1a')}]
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM conversations WHERE conversations.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.06682s ago] {'id': UUID('a5897182-4761-49c8-9294-20f543b44b46')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.06546s ago] {'pk_1': UUID('26839552-645f-4aab-94d4-649cb7c16c4d')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE %(param_1)s::UUID = messages.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.08938s ago] {'param_1': UUID('26839552-645f-4aab-94d4-649cb7c16c4d')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE %(param_1)s::UUID = conversation_metadata.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.08642s ago] {'param_1': UUID('26839552-645f-4aab-94d4-649cb7c16c4d')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT documents.conversation_id AS documents_conversation_id, documents.filename AS documents_filename, documents.file_path AS documents_file_path, documents.content_type AS documents_content_type, documents.processed_text AS documents_processed_text, documents.id AS documents_id, documents.created_at AS documents_created_at 
FROM documents 
WHERE %(param_1)s::UUID = documents.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.08427s ago] {'param_1': UUID('26839552-645f-4aab-94d4-649cb7c16c4d')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM conversation_metadata WHERE conversation_metadata.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.07939s ago] [{'id': UUID('12e878bc-a5b8-44df-96a0-de5052ddaae1')}, {'id': UUID('18e28b5a-3785-4f0f-b83c-90d83626ac58')}, {'id': UUID('66be2621-401e-4368-8342-05d7177e0fc0')}, {'id': UUID('74987d35-735d-4c8f-b2a6-c893a7054e2c')}, {'id': UUID('daa6e316-0644-44f4-b1c6-9a9ada697d40')}, {'id': UUID('e53ec0fd-2445-4ef5-8604-38de504a1813')}, {'id': UUID('fdc7fd64-69c0-4536-8666-71df05b624ea')}]
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM messages WHERE messages.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.07877s ago] [{'id': UUID('4bdd1ad6-3dba-4091-899a-b382bb9bf3bb')}, {'id': UUID('88426761-37b1-4196-9d72-eb73d3177e2e')}]
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM conversations WHERE conversations.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.07875s ago] {'id': UUID('26839552-645f-4aab-94d4-649cb7c16c4d')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.07831s ago] {'pk_1': UUID('6858012a-9c46-4d77-bf0b-293ef8cddeb4')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE %(param_1)s::UUID = messages.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1019s ago] {'param_1': UUID('6858012a-9c46-4d77-bf0b-293ef8cddeb4')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE %(param_1)s::UUID = conversation_metadata.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.09889s ago] {'param_1': UUID('6858012a-9c46-4d77-bf0b-293ef8cddeb4')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT documents.conversation_id AS documents_conversation_id, documents.filename AS documents_filename, documents.file_path AS documents_file_path, documents.content_type AS documents_content_type, documents.processed_text AS documents_processed_text, documents.id AS documents_id, documents.created_at AS documents_created_at 
FROM documents 
WHERE %(param_1)s::UUID = documents.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.09693s ago] {'param_1': UUID('6858012a-9c46-4d77-bf0b-293ef8cddeb4')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM conversation_metadata WHERE conversation_metadata.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.0923s ago] [{'id': UUID('0e3ae97c-7928-47ed-98e6-cf9b0d85a25a')}, {'id': UUID('5c619421-5677-413e-b5db-50bf6ac91464')}, {'id': UUID('6e4adc80-7bc3-40b4-b47e-1bd96b5efd68')}, {'id': UUID('d82f4eca-4f21-46a5-8e05-7638ff5613c5')}, {'id': UUID('dc32d047-a80e-4351-bef3-abe3e24c3f5e')}, {'id': UUID('ed8b82fc-848a-4717-87ed-1437863f9e67')}, {'id': UUID('ff7ef2e4-9c41-4472-b8ad-95492a9f3f09')}]
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM messages WHERE messages.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.09133s ago] [{'id': UUID('4c64c4df-7507-498b-8e2c-1324a3b7ab5c')}, {'id': UUID('b45d58d8-01f2-458f-979d-9126dc0773b5')}]
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM conversations WHERE conversations.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.09032s ago] {'id': UUID('6858012a-9c46-4d77-bf0b-293ef8cddeb4')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.0887s ago] {'pk_1': UUID('2c61377e-236d-473b-9023-bb4616a70d71')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE %(param_1)s::UUID = messages.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1121s ago] {'param_1': UUID('2c61377e-236d-473b-9023-bb4616a70d71')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE %(param_1)s::UUID = conversation_metadata.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1089s ago] {'param_1': UUID('2c61377e-236d-473b-9023-bb4616a70d71')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT documents.conversation_id AS documents_conversation_id, documents.filename AS documents_filename, documents.file_path AS documents_file_path, documents.content_type AS documents_content_type, documents.processed_text AS documents_processed_text, documents.id AS documents_id, documents.created_at AS documents_created_at 
FROM documents 
WHERE %(param_1)s::UUID = documents.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1073s ago] {'param_1': UUID('2c61377e-236d-473b-9023-bb4616a70d71')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM conversation_metadata WHERE conversation_metadata.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.103s ago] [{'id': UUID('03546800-2062-4a62-adda-94aa47fa664f')}, {'id': UUID('635306f4-e893-4b8c-b82e-28d6cb329425')}, {'id': UUID('69bf347a-0f43-4b25-b3ef-d469732003f6')}, {'id': UUID('6b7f54b4-e8b6-436f-85d8-5bf2bafcff62')}, {'id': UUID('c4e9d68f-8308-4223-881d-9433db2f4112')}, {'id': UUID('e7a96492-67f1-44b0-8acf-d5e5005f8c3e')}, {'id': UUID('fb22960e-4d56-4b54-b7f4-231965565b91')}]
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM messages WHERE messages.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1019s ago] [{'id': UUID('36b4b039-af68-451d-8593-7c6b89d929d6')}, {'id': UUID('410edd5e-d792-4a29-b50a-23e59d338930')}]
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM conversations WHERE conversations.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1007s ago] {'id': UUID('2c61377e-236d-473b-9023-bb4616a70d71')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.09905s ago] {'pk_1': UUID('cd59860f-65ff-4cda-a182-a2a129af54e0')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE %(param_1)s::UUID = messages.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1239s ago] {'param_1': UUID('cd59860f-65ff-4cda-a182-a2a129af54e0')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE %(param_1)s::UUID = conversation_metadata.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1219s ago] {'param_1': UUID('cd59860f-65ff-4cda-a182-a2a129af54e0')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT documents.conversation_id AS documents_conversation_id, documents.filename AS documents_filename, documents.file_path AS documents_file_path, documents.content_type AS documents_content_type, documents.processed_text AS documents_processed_text, documents.id AS documents_id, documents.created_at AS documents_created_at 
FROM documents 
WHERE %(param_1)s::UUID = documents.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1215s ago] {'param_1': UUID('cd59860f-65ff-4cda-a182-a2a129af54e0')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM conversation_metadata WHERE conversation_metadata.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1182s ago] [{'id': UUID('0f1ccf67-028a-42a5-ba37-29e7666a7ec2')}, {'id': UUID('24ea981e-11f9-406b-aaa1-86f94db8d92f')}, {'id': UUID('3869f8cb-90ba-47ba-b48e-31687b7df416')}, {'id': UUID('481cef3a-bb1b-488e-8055-fbc5611ac2bf')}, {'id': UUID('534e39f5-4788-4151-85df-779d7ea8cb76')}, {'id': UUID('58e42563-487b-422c-b708-4604a7e5fd6d')}, {'id': UUID('c0db18bd-2fc4-47af-bf5c-dd0fbb5362d4')}, {'id': UUID('ed67bac7-2b11-41d2-ac9e-d14e2dd94745')}]
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM messages WHERE messages.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1192s ago] [{'id': UUID('4193f73e-ddee-49fb-b060-8cb592f40b89')}, {'id': UUID('c3a75b1d-f023-480a-a41a-b849bbab92c6')}]
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM conversations WHERE conversations.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1189s ago] {'id': UUID('cd59860f-65ff-4cda-a182-a2a129af54e0')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.118s ago] {'pk_1': UUID('970b5cc6-24eb-4704-b642-739b6e640714')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE %(param_1)s::UUID = messages.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.142s ago] {'param_1': UUID('970b5cc6-24eb-4704-b642-739b6e640714')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE %(param_1)s::UUID = conversation_metadata.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1394s ago] {'param_1': UUID('970b5cc6-24eb-4704-b642-739b6e640714')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT documents.conversation_id AS documents_conversation_id, documents.filename AS documents_filename, documents.file_path AS documents_file_path, documents.content_type AS documents_content_type, documents.processed_text AS documents_processed_text, documents.id AS documents_id, documents.created_at AS documents_created_at 
FROM documents 
WHERE %(param_1)s::UUID = documents.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1373s ago] {'param_1': UUID('970b5cc6-24eb-4704-b642-739b6e640714')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM conversation_metadata WHERE conversation_metadata.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.133s ago] [{'id': UUID('415034ef-ba35-4ad3-9f2c-71b9fc59c41c')}, {'id': UUID('5539e872-7533-4974-8251-0c29a242def5')}, {'id': UUID('6cb7c02d-8cda-4864-8c0c-6e83ec05ed48')}, {'id': UUID('96bd0102-d3ef-42ea-8356-faa9b6804834')}, {'id': UUID('997f23de-b3d9-4c42-85ef-ba34812baa6b')}, {'id': UUID('a3257684-fcb3-4757-bc2b-7544132fb36d')}, {'id': UUID('a948bc7f-a111-4e47-824c-e8326191b5cf')}, {'id': UUID('c6b95bb3-a901-415e-b862-6e7a45478631')}]
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM messages WHERE messages.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1321s ago] [{'id': UUID('24ba3286-8f9d-4f02-b7a4-954c00f132ff')}, {'id': UUID('d6ddb0d5-1e61-4d1a-a68e-a8cad171ee2b')}]
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM conversations WHERE conversations.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1319s ago] {'id': UUID('970b5cc6-24eb-4704-b642-739b6e640714')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1317s ago] {'pk_1': UUID('76ef08d5-9e5c-4a76-8957-2331a956f47c')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE %(param_1)s::UUID = messages.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1557s ago] {'param_1': UUID('76ef08d5-9e5c-4a76-8957-2331a956f47c')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE %(param_1)s::UUID = conversation_metadata.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1531s ago] {'param_1': UUID('76ef08d5-9e5c-4a76-8957-2331a956f47c')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT documents.conversation_id AS documents_conversation_id, documents.filename AS documents_filename, documents.file_path AS documents_file_path, documents.content_type AS documents_content_type, documents.processed_text AS documents_processed_text, documents.id AS documents_id, documents.created_at AS documents_created_at 
FROM documents 
WHERE %(param_1)s::UUID = documents.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1508s ago] {'param_1': UUID('76ef08d5-9e5c-4a76-8957-2331a956f47c')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM conversation_metadata WHERE conversation_metadata.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1461s ago] [{'id': UUID('53496cd0-adff-4665-90b3-573d35d91a77')}, {'id': UUID('7ea45d11-2ddd-4c54-92d2-be22eb21a29b')}, {'id': UUID('82c7de35-6883-4d99-8b6f-b68dd0f06514')}, {'id': UUID('a1300008-0b0d-4c26-9965-0019f8da2123')}, {'id': UUID('a47d451e-0715-4b5d-a98a-550fdda68421')}, {'id': UUID('a9daafc3-bf09-407c-a5c6-9c55e61fb20d')}, {'id': UUID('c156df05-a8b1-44de-ae62-449726479227')}, {'id': UUID('e8f4dbfb-ebfa-4c26-b0b0-d23475d586cc')}]
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM messages WHERE messages.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1467s ago] [{'id': UUID('72701e30-0214-4d09-9dda-97db52660386')}, {'id': UUID('7c8e17da-973e-4c38-ba94-697eee24b7f5')}]
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM conversations WHERE conversations.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1462s ago] {'id': UUID('76ef08d5-9e5c-4a76-8957-2331a956f47c')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1446s ago] {'pk_1': UUID('dfa422b1-86ca-4a18-9869-cce9df756dcd')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE %(param_1)s::UUID = messages.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1686s ago] {'param_1': UUID('dfa422b1-86ca-4a18-9869-cce9df756dcd')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE %(param_1)s::UUID = conversation_metadata.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.166s ago] {'param_1': UUID('dfa422b1-86ca-4a18-9869-cce9df756dcd')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT documents.conversation_id AS documents_conversation_id, documents.filename AS documents_filename, documents.file_path AS documents_file_path, documents.content_type AS documents_content_type, documents.processed_text AS documents_processed_text, documents.id AS documents_id, documents.created_at AS documents_created_at 
FROM documents 
WHERE %(param_1)s::UUID = documents.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1643s ago] {'param_1': UUID('dfa422b1-86ca-4a18-9869-cce9df756dcd')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM conversation_metadata WHERE conversation_metadata.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1598s ago] [{'id': UUID('04e2a7bb-4319-4bb7-bd56-9d6d2e2c1c59')}, {'id': UUID('69a06baa-0f3a-4c76-983a-aec4934b0cb3')}, {'id': UUID('7e2b7680-0458-4e43-844c-f2cbe89f9dee')}, {'id': UUID('a9391af1-6b58-494b-8296-991261e96c46')}, {'id': UUID('bfba92b3-ce87-4a65-a636-6434d28c5c92')}, {'id': UUID('c57d87d0-ad86-4858-9983-055f5e99936e')}, {'id': UUID('d793ce41-63c2-45d3-beed-de960cef505d')}, {'id': UUID('ecc95465-6aa0-4f20-937f-36ff1b91e03c')}, {'id': UUID('f79fab88-b5d5-4120-93a2-e8f0b5da96f9')}]
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM messages WHERE messages.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1595s ago] [{'id': UUID('6ee48948-5d3f-4e55-b54e-cb58e83b69ce')}, {'id': UUID('881ca4f6-c315-4c85-9773-8d9cafff542b')}]
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM conversations WHERE conversations.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1587s ago] {'id': UUID('dfa422b1-86ca-4a18-9869-cce9df756dcd')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1581s ago] {'pk_1': UUID('fd45cea0-6e3d-4560-a086-12668384aa9d')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE %(param_1)s::UUID = messages.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1824s ago] {'param_1': UUID('fd45cea0-6e3d-4560-a086-12668384aa9d')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE %(param_1)s::UUID = conversation_metadata.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1798s ago] {'param_1': UUID('fd45cea0-6e3d-4560-a086-12668384aa9d')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT documents.conversation_id AS documents_conversation_id, documents.filename AS documents_filename, documents.file_path AS documents_file_path, documents.content_type AS documents_content_type, documents.processed_text AS documents_processed_text, documents.id AS documents_id, documents.created_at AS documents_created_at 
FROM documents 
WHERE %(param_1)s::UUID = documents.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1786s ago] {'param_1': UUID('fd45cea0-6e3d-4560-a086-12668384aa9d')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM conversation_metadata WHERE conversation_metadata.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1744s ago] [{'id': UUID('02041c6d-b361-4e28-a1cf-4e4fdfcd7428')}, {'id': UUID('1a046515-78c8-495f-a974-91e86ee7a091')}, {'id': UUID('231bf9a9-2464-43d2-a6e4-45582bf9f879')}, {'id': UUID('311cd46a-99e0-41eb-a5a0-28f3f39a7b8a')}, {'id': UUID('37a7f77b-51fd-43f2-ab4a-1ddbab227cf1')}, {'id': UUID('7967a722-b105-401e-9e8d-7b17ce6c115c')}, {'id': UUID('afd9cf3f-df96-42db-a418-b4c86061403c')}, {'id': UUID('ed150fdd-addb-4c7a-9851-cf46bcdffc18')}, {'id': UUID('f01da2a7-e0ae-472c-b867-6ec00ad71567')}, {'id': UUID('f50626fd-6d13-47cb-8c15-dfccc8ae4a75')}]
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM messages WHERE messages.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1746s ago] [{'id': UUID('8a9582ae-8675-465c-905a-b9387aaf1fd5')}, {'id': UUID('e676a548-3a70-4fa4-bdd3-d394c7d39f67')}]
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM conversations WHERE conversations.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1738s ago] {'id': UUID('fd45cea0-6e3d-4560-a086-12668384aa9d')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1726s ago] {'pk_1': UUID('810177e9-c18d-444c-974f-2534757780aa')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE %(param_1)s::UUID = messages.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.197s ago] {'param_1': UUID('810177e9-c18d-444c-974f-2534757780aa')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE %(param_1)s::UUID = conversation_metadata.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1948s ago] {'param_1': UUID('810177e9-c18d-444c-974f-2534757780aa')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT documents.conversation_id AS documents_conversation_id, documents.filename AS documents_filename, documents.file_path AS documents_file_path, documents.content_type AS documents_content_type, documents.processed_text AS documents_processed_text, documents.id AS documents_id, documents.created_at AS documents_created_at 
FROM documents 
WHERE %(param_1)s::UUID = documents.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1928s ago] {'param_1': UUID('810177e9-c18d-444c-974f-2534757780aa')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM conversation_metadata WHERE conversation_metadata.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1881s ago] [{'id': UUID('33f86256-ecab-4a39-a19c-3992b67ead2f')}, {'id': UUID('4e737315-8ed5-4008-a610-215efa64cfc4')}, {'id': UUID('8305ce1f-5431-49b4-8fc5-781ebe1807a4')}, {'id': UUID('9ab016fa-0eda-4bc5-850b-ec0f25f08344')}, {'id': UUID('a1dd4e19-83ad-4209-b5bc-1435a20f1fd4')}, {'id': UUID('aed0fa2d-967a-4edf-ae8d-66f85dba780e')}, {'id': UUID('d96c97f5-66da-4c52-9933-b5f0a518d297')}, {'id': UUID('e7e4e82e-2046-42cb-a4da-6dbd32e64eb8')}, {'id': UUID('f5c01b45-c843-45b9-885e-1be2de6a549c')}, {'id': UUID('fc8f091f-3a45-45fa-9482-af95c3dc95e6')}]
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM messages WHERE messages.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1878s ago] [{'id': UUID('3bd18491-e260-4ae5-b324-8c75a46a0b11')}, {'id': UUID('5b550cfb-bb03-4024-a027-4db497f512b4')}]
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM conversations WHERE conversations.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1867s ago] {'id': UUID('810177e9-c18d-444c-974f-2534757780aa')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1856s ago] {'pk_1': UUID('8cfde0ca-5b20-464c-ba99-f0c2e74e0413')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE %(param_1)s::UUID = messages.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.2092s ago] {'param_1': UUID('8cfde0ca-5b20-464c-ba99-f0c2e74e0413')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE %(param_1)s::UUID = conversation_metadata.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.2061s ago] {'param_1': UUID('8cfde0ca-5b20-464c-ba99-f0c2e74e0413')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - SELECT documents.conversation_id AS documents_conversation_id, documents.filename AS documents_filename, documents.file_path AS documents_file_path, documents.content_type AS documents_content_type, documents.processed_text AS documents_processed_text, documents.id AS documents_id, documents.created_at AS documents_created_at 
FROM documents 
WHERE %(param_1)s::UUID = documents.conversation_id
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.204s ago] {'param_1': UUID('8cfde0ca-5b20-464c-ba99-f0c2e74e0413')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM conversation_metadata WHERE conversation_metadata.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1995s ago] [{'id': UUID('27c21c52-8d5c-47bb-8508-6451c85af8d1')}, {'id': UUID('3f3f3c98-0444-4c69-93bb-53b3f48271b7')}, {'id': UUID('4a66fd13-c0e1-4f3f-a46b-8fc929d295b1')}, {'id': UUID('788d4bad-100e-4971-9a64-09ea12493bcd')}, {'id': UUID('7e1e868a-ad88-427c-982a-953035bbfc83')}, {'id': UUID('a1cbc441-57b1-47ad-8f12-0ccb6c0ae00b')}, {'id': UUID('c15de6a7-33c9-4541-b931-7f33b948b63c')}, {'id': UUID('d764d752-23b4-4c33-960d-22f2413377fc')}, {'id': UUID('e900cccf-7c72-41cc-9100-6cd076ba4acc')}, {'id': UUID('f01243c5-f3ea-4346-a3ae-c95837f5e5d2')}]
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM messages WHERE messages.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1996s ago] [{'id': UUID('5a0f17cc-e657-4473-9857-8a5ee3b52d31')}, {'id': UUID('91808feb-dba9-4401-a4d0-2ac2053c0e28')}]
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - DELETE FROM conversations WHERE conversations.id = %(id)s::UUID
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - [cached since 0.1992s ago] {'id': UUID('8cfde0ca-5b20-464c-ba99-f0c2e74e0413')}
2025-05-19 14:52:05 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:05 - hydrous - INFO - Limpieza completada. 16 conversaciones antiguas eliminadas.
2025-05-19 14:52:19 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:19 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 14:52:19 - sqlalchemy.engine.Engine - INFO - [cached since 25.48s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 14:52:19 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 14:52:19 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:19 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 14:52:19 - sqlalchemy.engine.Engine - INFO - [cached since 25.4s ago] {'id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'param_1': 1}
2025-05-19 14:52:19 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE messages.conversation_id = %(conversation_id_1)s::UUID ORDER BY messages.created_at
2025-05-19 14:52:19 - sqlalchemy.engine.Engine - INFO - [cached since 19.16s ago] {'conversation_id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463')}
2025-05-19 14:52:19 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID
2025-05-19 14:52:19 - sqlalchemy.engine.Engine - INFO - [cached since 19.14s ago] {'conversation_id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463')}
2025-05-19 14:52:19 - hydrous - INFO - DBG_SS: Conversación b433cbcb-a80e-4dc1-be27-466800c52463 RECUPERADA. Metadata actual: {'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True, 'location': 'los mochis', 'current_question_asked_summary': '¿Cuál es el costo del agua en tu ubicación?'}
2025-05-19 14:52:19 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 14:52:19 - sqlalchemy.engine.Engine - INFO - [cached since 25.41s ago] {'id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'param_1': 1}
2025-05-19 14:52:19 - hydrous - INFO - PDF_CHECK: ConvID=b433cbcb-a80e-4dc1-be27-466800c52463, Input='120MXN/m3', is_pdf_req=False, proposal_ready=False, is_complete=False, pdf_path=None, ready_for_proposal=False
2025-05-19 14:52:19 - hydrous - INFO - Normal flow for conversation b433cbcb-a80e-4dc1-be27-466800c52463
2025-05-19 14:52:19 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 14:52:19 - sqlalchemy.engine.Engine - INFO - [cached since 25.41s ago] {'id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'param_1': 1}
2025-05-19 14:52:19 - sqlalchemy.engine.Engine - INFO - INSERT INTO messages (conversation_id, role, content, id, created_at) VALUES (%(conversation_id)s::UUID, %(role)s, %(content)s, %(id)s::UUID, %(created_at)s)
2025-05-19 14:52:19 - sqlalchemy.engine.Engine - INFO - [cached since 19.15s ago] {'conversation_id': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'role': 'user', 'content': '120MXN/m3', 'id': UUID('d0757182-7169-43a3-8d1f-2a0d596ada22'), 'created_at': datetime.datetime(2025, 5, 19, 14, 52, 19, 285246)}
2025-05-19 14:52:19 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:19 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:19 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id, messages.role, messages.content, messages.id, messages.created_at 
FROM messages 
WHERE messages.id = %(pk_1)s::UUID
2025-05-19 14:52:19 - sqlalchemy.engine.Engine - INFO - [cached since 19.14s ago] {'pk_1': UUID('d0757182-7169-43a3-8d1f-2a0d596ada22')}
2025-05-19 14:52:19 - hydrous - INFO - Primera interacción detectada para conversación b433cbcb-a80e-4dc1-be27-466800c52463. Actualizando metadata.
2025-05-19 14:52:19 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 14:52:19 - sqlalchemy.engine.Engine - INFO - [cached since 25.43s ago] {'id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'param_1': 1}
2025-05-19 14:52:19 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE messages.conversation_id = %(conversation_id_1)s::UUID ORDER BY messages.created_at
2025-05-19 14:52:19 - sqlalchemy.engine.Engine - INFO - [cached since 19.19s ago] {'conversation_id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463')}
2025-05-19 14:52:19 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID
2025-05-19 14:52:19 - sqlalchemy.engine.Engine - INFO - [cached since 19.17s ago] {'conversation_id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463')}
2025-05-19 14:52:19 - hydrous - INFO - DBG_SS: Conversación b433cbcb-a80e-4dc1-be27-466800c52463 RECUPERADA. Metadata actual: {'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True, 'location': 'los mochis', 'current_question_asked_summary': '¿Cuál es el costo del agua en tu ubicación?'}
2025-05-19 14:52:19 - hydrous - INFO - DBG_AI_HANDLE: Iniciando handle_conversation para conv b433cbcb-a80e-4dc1-be27-466800c52463
2025-05-19 14:52:19 - hydrous - INFO - Metadata recibida en _prepare_messages: sector=commercial, subsector=Hotel, location=los mochis, client_name=Ricardo Altamirano, company_name=hydrous, is_new_conversation=True
2025-05-19 14:52:19 - hydrous - INFO - Datos de usuario procesados: nombre=Ricardo Altamirano, empresa=hydrous, sector=commercial, subsector=Hotel, ubicacion=los mochis, nueva_conversacion=True, primera_interaccion=True
2025-05-19 14:52:19 - hydrous - INFO - Added additional user context and conversation state to the prompt.
2025-05-19 14:52:19 - hydrous - INFO - DBG_AI_HANDLE: Mensajes preparados OK (Total: 5).
2025-05-19 14:52:19 - hydrous - INFO - DBG_AI_CALL: Iniciando llamada a API LLM. URL: https://api.openai.com/v1/chat/completions, Model: gpt-4o-mini, #Msgs: 5
2025-05-19 14:52:22 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-19 14:52:22 - hydrous - INFO - DBG_AI_CALL: Llamada a API completada. Status: 200
2025-05-19 14:52:22 - hydrous - INFO - DBG_AI_CALL: Contenido LLM extraído exitosamente (longitud: 546).
2025-05-19 14:52:22 - hydrous - INFO - DBG_AI_HANDLE: Respuesta LLM recibida (primeros 50 chars): 'Gracias por proporcionar el costo del agua, que es'
2025-05-19 14:52:22 - hydrous - INFO - Metadata[current_question_asked_summary] actualizada a: '¿Cuánta agua consumes actualmente en tu hotel?'
2025-05-19 14:52:22 - hydrous - INFO - DBG_AI_HANDLE: Finalizando handle_conversation para b433cbcb-a80e-4dc1-be27-466800c52463. Respuesta final: 'Gracias por proporcionar el costo del agua, que es...'
2025-05-19 14:52:22 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 14:52:22 - sqlalchemy.engine.Engine - INFO - [cached since 29.11s ago] {'id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'param_1': 1}
2025-05-19 14:52:22 - sqlalchemy.engine.Engine - INFO - INSERT INTO messages (conversation_id, role, content, id, created_at) VALUES (%(conversation_id)s::UUID, %(role)s, %(content)s, %(id)s::UUID, %(created_at)s)
2025-05-19 14:52:22 - sqlalchemy.engine.Engine - INFO - [cached since 22.85s ago] {'conversation_id': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'role': 'assistant', 'content': 'Gracias por proporcionar el costo del agua, que es de **120 MXN/m³**. \n\n💧 **Dato relevante:** La optimización del uso del agua en la industria hote ... (254 characters truncated) ... .  \n*¿Por qué preguntamos esto?* Saber la cantidad de agua consumida nos permitirá dimensionar correctamente la solución de tratamiento y reciclaje.', 'id': UUID('bf1994eb-1db9-4049-9cf1-20d3e5981a1d'), 'created_at': datetime.datetime(2025, 5, 19, 14, 52, 22, 992211)}
2025-05-19 14:52:22 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:22 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id, messages.role, messages.content, messages.id, messages.created_at 
FROM messages 
WHERE messages.id = %(pk_1)s::UUID
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - [cached since 22.85s ago] {'pk_1': UUID('bf1994eb-1db9-4049-9cf1-20d3e5981a1d')}
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - [cached since 29.15s ago] {'id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'param_1': 1}
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - [cached since 29.16s ago] {'pk_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463')}
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - [cached since 29.14s ago] {'conversation_id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'key_1': 'user_name', 'param_1': 1}
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - [cached since 29.14s ago] {'conversation_id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'key_1': 'user_location', 'param_1': 1}
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - [cached since 29.14s ago] {'conversation_id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'key_1': 'sector', 'param_1': 1}
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - [cached since 29.14s ago] {'conversation_id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'key_1': 'subsector', 'param_1': 1}
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - [cached since 29.15s ago] {'conversation_id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'key_1': 'company_name', 'param_1': 1}
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - [cached since 29.15s ago] {'conversation_id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'key_1': 'user_email', 'param_1': 1}
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - [cached since 29.15s ago] {'conversation_id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'key_1': 'is_new_conversation', 'param_1': 1}
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - [cached since 29.16s ago] {'conversation_id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'key_1': 'first_interaction', 'param_1': 1}
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - [cached since 29.16s ago] {'conversation_id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'key_1': 'location', 'param_1': 1}
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - [cached since 29.16s ago] {'conversation_id_1': UUID('b433cbcb-a80e-4dc1-be27-466800c52463'), 'key_1': 'current_question_asked_summary', 'param_1': 1}
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - UPDATE conversation_metadata SET value=%(value)s::JSONB WHERE conversation_metadata.id = %(conversation_metadata_id)s::UUID
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - [generated in 0.00068s] {'value': '"\\u00bfCu\\u00e1nta agua consumes actualmente en tu hotel?"', 'conversation_metadata_id': UUID('c24ae289-cd3a-4f8e-87b3-a80439896449')}
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:23 - hydrous - INFO - DBG_SS: Conversación b433cbcb-a80e-4dc1-be27-466800c52463 actualizada en base de datos.
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.created_at < %(created_at_1)s
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - [cached since 17.67s ago] {'created_at_1': datetime.datetime(2025, 5, 18, 14, 52, 23, 53888)}
2025-05-19 14:52:23 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 14:52:33 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:33 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 14:52:33 - sqlalchemy.engine.Engine - INFO - [cached since 40.22s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 14:52:33 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 14:52:33 - hydrous - INFO - Datos del usuario al iniciar conversación: nombre=Ricardo Altamirano, empresa=hydrous, sector=commercial, subsector=Hotel, ubicación=los mochis, email=hydrous20@gmail.com
2025-05-19 14:52:33 - hydrous - INFO - Metadata inicial de la conversación: {'client_name': 'Ricardo Altamirano', 'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'selected_sector': 'commercial', 'selected_subsector': 'Hotel', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 14:52:33 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversations (user_id, selected_sector, selected_subsector, current_question_id, is_complete, has_proposal, client_name, proposal_text, pdf_path, id, created_at) VALUES (%(user_id)s::UUID, %(selected_sector)s, %(selected_subsector)s, %(current_question_id)s, %(is_complete)s, %(has_proposal)s, %(client_name)s, %(proposal_text)s, %(pdf_path)s, %(id)s::UUID, %(created_at)s)
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - [cached since 40.19s ago] {'user_id': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'selected_sector': 'commercial', 'selected_subsector': 'Hotel', 'current_question_id': None, 'is_complete': False, 'has_proposal': False, 'client_name': 'Ricardo Altamirano', 'proposal_text': None, 'pdf_path': None, 'id': UUID('7babb2a9-91fa-4d36-b836-d39a89428658'), 'created_at': datetime.datetime(2025, 5, 19, 14, 52, 34, 685)}
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversation_metadata (conversation_id, key, value, id, created_at) VALUES (%(conversation_id__0)s::UUID, %(key__0)s, %(value__0)s::JSONB, %(id__0)s::UUID, %(created_at__0)s), (%(conversation_id__1)s::UUID, %(key__1)s, %(value__1)s::JSONB ... 543 characters truncated ...  (%(conversation_id__7)s::UUID, %(key__7)s, %(value__7)s::JSONB, %(id__7)s::UUID, %(created_at__7)s)
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - [cached since 40.18s ago (insertmanyvalues) 1/1 (unordered)] {'key__0': 'user_name', 'value__0': '"Ricardo Altamirano"', 'created_at__0': datetime.datetime(2025, 5, 19, 14, 52, 34, 15325), 'id__0': UUID('5d81a78a-a9eb-4342-86dd-215d3d2ecc4f'), 'conversation_id__0': UUID('7babb2a9-91fa-4d36-b836-d39a89428658'), 'key__1': 'user_location', 'value__1': '"los mochis"', 'created_at__1': datetime.datetime(2025, 5, 19, 14, 52, 34, 15332), 'id__1': UUID('d12e65a2-17d0-4f23-bc8d-2b42dfeef687'), 'conversation_id__1': UUID('7babb2a9-91fa-4d36-b836-d39a89428658'), 'key__2': 'sector', 'value__2': '"commercial"', 'created_at__2': datetime.datetime(2025, 5, 19, 14, 52, 34, 15333), 'id__2': UUID('774d4cc5-e0f8-450b-b684-55e201cee3e6'), 'conversation_id__2': UUID('7babb2a9-91fa-4d36-b836-d39a89428658'), 'key__3': 'subsector', 'value__3': '"Hotel"', 'created_at__3': datetime.datetime(2025, 5, 19, 14, 52, 34, 15335), 'id__3': UUID('3377f662-5bd2-48c6-8ccc-712d0562bb6d'), 'conversation_id__3': UUID('7babb2a9-91fa-4d36-b836-d39a89428658'), 'key__4': 'company_name', 'value__4': '"hydrous"', 'created_at__4': datetime.datetime(2025, 5, 19, 14, 52, 34, 15336), 'id__4': UUID('5e8e1a0b-8345-4820-a49d-60aae7cbc0c0'), 'conversation_id__4': UUID('7babb2a9-91fa-4d36-b836-d39a89428658'), 'key__5': 'user_email', 'value__5': '"hydrous20@gmail.com"', 'created_at__5': datetime.datetime(2025, 5, 19, 14, 52, 34, 15337), 'id__5': UUID('3603c930-fc33-4c0d-a105-c7fd6adc2516'), 'conversation_id__5': UUID('7babb2a9-91fa-4d36-b836-d39a89428658'), 'key__6': 'is_new_conversation', 'value__6': 'true', 'created_at__6': datetime.datetime(2025, 5, 19, 14, 52, 34, 15338), 'id__6': UUID('bd31d3e1-4271-413b-8df7-68f5b6ef01f1'), 'conversation_id__6': UUID('7babb2a9-91fa-4d36-b836-d39a89428658'), 'key__7': 'first_interaction', 'value__7': 'true', 'created_at__7': datetime.datetime(2025, 5, 19, 14, 52, 34, 15340), 'id__7': UUID('f289d9a1-d406-4df6-b218-5981137c731d'), 'conversation_id__7': UUID('7babb2a9-91fa-4d36-b836-d39a89428658')}
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - [cached since 40.18s ago] {'pk_1': UUID('7babb2a9-91fa-4d36-b836-d39a89428658')}
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - [cached since 40.17s ago] {'id_1': UUID('7babb2a9-91fa-4d36-b836-d39a89428658'), 'param_1': 1}
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - [cached since 40.19s ago] {'pk_1': UUID('7babb2a9-91fa-4d36-b836-d39a89428658')}
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - [cached since 40.17s ago] {'conversation_id_1': UUID('7babb2a9-91fa-4d36-b836-d39a89428658'), 'key_1': 'user_name', 'param_1': 1}
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - [cached since 40.17s ago] {'conversation_id_1': UUID('7babb2a9-91fa-4d36-b836-d39a89428658'), 'key_1': 'user_location', 'param_1': 1}
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - [cached since 40.18s ago] {'conversation_id_1': UUID('7babb2a9-91fa-4d36-b836-d39a89428658'), 'key_1': 'sector', 'param_1': 1}
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - [cached since 40.18s ago] {'conversation_id_1': UUID('7babb2a9-91fa-4d36-b836-d39a89428658'), 'key_1': 'subsector', 'param_1': 1}
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - [cached since 40.18s ago] {'conversation_id_1': UUID('7babb2a9-91fa-4d36-b836-d39a89428658'), 'key_1': 'company_name', 'param_1': 1}
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - [cached since 40.19s ago] {'conversation_id_1': UUID('7babb2a9-91fa-4d36-b836-d39a89428658'), 'key_1': 'user_email', 'param_1': 1}
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - [cached since 40.19s ago] {'conversation_id_1': UUID('7babb2a9-91fa-4d36-b836-d39a89428658'), 'key_1': 'is_new_conversation', 'param_1': 1}
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - [cached since 40.2s ago] {'conversation_id_1': UUID('7babb2a9-91fa-4d36-b836-d39a89428658'), 'key_1': 'first_interaction', 'param_1': 1}
2025-05-19 14:52:34 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:34 - hydrous - INFO - DBG_SS: Conversación 7babb2a9-91fa-4d36-b836-d39a89428658 actualizada en base de datos.
2025-05-19 14:52:39 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:39 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 14:52:39 - sqlalchemy.engine.Engine - INFO - [cached since 45.8s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 14:52:39 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 14:52:39 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:39 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 14:52:39 - sqlalchemy.engine.Engine - INFO - [cached since 45.72s ago] {'id_1': UUID('7babb2a9-91fa-4d36-b836-d39a89428658'), 'param_1': 1}
2025-05-19 14:52:39 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE messages.conversation_id = %(conversation_id_1)s::UUID ORDER BY messages.created_at
2025-05-19 14:52:39 - sqlalchemy.engine.Engine - INFO - [cached since 39.48s ago] {'conversation_id_1': UUID('7babb2a9-91fa-4d36-b836-d39a89428658')}
2025-05-19 14:52:39 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID
2025-05-19 14:52:39 - sqlalchemy.engine.Engine - INFO - [cached since 39.46s ago] {'conversation_id_1': UUID('7babb2a9-91fa-4d36-b836-d39a89428658')}
2025-05-19 14:52:39 - hydrous - INFO - DBG_SS: Conversación 7babb2a9-91fa-4d36-b836-d39a89428658 RECUPERADA. Metadata actual: {'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 14:52:39 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 14:52:39 - sqlalchemy.engine.Engine - INFO - [cached since 45.74s ago] {'id_1': UUID('7babb2a9-91fa-4d36-b836-d39a89428658'), 'param_1': 1}
2025-05-19 14:52:39 - hydrous - INFO - PDF_CHECK: ConvID=7babb2a9-91fa-4d36-b836-d39a89428658, Input='si', is_pdf_req=False, proposal_ready=False, is_complete=False, pdf_path=None, ready_for_proposal=False
2025-05-19 14:52:39 - hydrous - INFO - Normal flow for conversation 7babb2a9-91fa-4d36-b836-d39a89428658
2025-05-19 14:52:39 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 14:52:39 - sqlalchemy.engine.Engine - INFO - [cached since 45.75s ago] {'id_1': UUID('7babb2a9-91fa-4d36-b836-d39a89428658'), 'param_1': 1}
2025-05-19 14:52:39 - sqlalchemy.engine.Engine - INFO - INSERT INTO messages (conversation_id, role, content, id, created_at) VALUES (%(conversation_id)s::UUID, %(role)s, %(content)s, %(id)s::UUID, %(created_at)s)
2025-05-19 14:52:39 - sqlalchemy.engine.Engine - INFO - [cached since 39.47s ago] {'conversation_id': UUID('7babb2a9-91fa-4d36-b836-d39a89428658'), 'role': 'user', 'content': 'si', 'id': UUID('61cbe80f-700a-458f-b954-3647f9246dce'), 'created_at': datetime.datetime(2025, 5, 19, 14, 52, 39, 609560)}
2025-05-19 14:52:39 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:39 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:39 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id, messages.role, messages.content, messages.id, messages.created_at 
FROM messages 
WHERE messages.id = %(pk_1)s::UUID
2025-05-19 14:52:39 - sqlalchemy.engine.Engine - INFO - [cached since 39.47s ago] {'pk_1': UUID('61cbe80f-700a-458f-b954-3647f9246dce')}
2025-05-19 14:52:39 - hydrous - INFO - Primera interacción detectada para conversación 7babb2a9-91fa-4d36-b836-d39a89428658. Actualizando metadata.
2025-05-19 14:52:39 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 14:52:39 - sqlalchemy.engine.Engine - INFO - [cached since 45.76s ago] {'id_1': UUID('7babb2a9-91fa-4d36-b836-d39a89428658'), 'param_1': 1}
2025-05-19 14:52:39 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE messages.conversation_id = %(conversation_id_1)s::UUID ORDER BY messages.created_at
2025-05-19 14:52:39 - sqlalchemy.engine.Engine - INFO - [cached since 39.52s ago] {'conversation_id_1': UUID('7babb2a9-91fa-4d36-b836-d39a89428658')}
2025-05-19 14:52:39 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID
2025-05-19 14:52:39 - sqlalchemy.engine.Engine - INFO - [cached since 39.5s ago] {'conversation_id_1': UUID('7babb2a9-91fa-4d36-b836-d39a89428658')}
2025-05-19 14:52:39 - hydrous - INFO - DBG_SS: Conversación 7babb2a9-91fa-4d36-b836-d39a89428658 RECUPERADA. Metadata actual: {'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 14:52:39 - hydrous - INFO - DBG_AI_HANDLE: Iniciando handle_conversation para conv 7babb2a9-91fa-4d36-b836-d39a89428658
2025-05-19 14:52:39 - hydrous - INFO - Metadata recibida en _prepare_messages: sector=commercial, subsector=Hotel, location=los mochis, client_name=Ricardo Altamirano, company_name=hydrous, is_new_conversation=True
2025-05-19 14:52:39 - hydrous - INFO - Datos de usuario procesados: nombre=Ricardo Altamirano, empresa=hydrous, sector=commercial, subsector=Hotel, ubicacion=los mochis, nueva_conversacion=True, primera_interaccion=True
2025-05-19 14:52:39 - hydrous - INFO - Added additional user context and conversation state to the prompt.
2025-05-19 14:52:39 - hydrous - INFO - DBG_AI_HANDLE: Mensajes preparados OK (Total: 3).
2025-05-19 14:52:39 - hydrous - INFO - DBG_AI_CALL: Iniciando llamada a API LLM. URL: https://api.openai.com/v1/chat/completions, Model: gpt-4o-mini, #Msgs: 3
2025-05-19 14:52:42 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-19 14:52:42 - hydrous - INFO - DBG_AI_CALL: Llamada a API completada. Status: 200
2025-05-19 14:52:42 - hydrous - INFO - DBG_AI_CALL: Contenido LLM extraído exitosamente (longitud: 573).
2025-05-19 14:52:42 - hydrous - INFO - DBG_AI_HANDLE: Respuesta LLM recibida (primeros 50 chars): 'I see you're in the sector hotelero en Los Mochis.'
2025-05-19 14:52:42 - hydrous - INFO - Metadata[current_question_asked_summary] actualizada a: '¿Cuál es el costo del agua en tu área? (por favor, proporciona la moneda y la unidad de medición).'
2025-05-19 14:52:42 - hydrous - INFO - DBG_AI_HANDLE: Finalizando handle_conversation para 7babb2a9-91fa-4d36-b836-d39a89428658. Respuesta final: 'I see you're in the sector hotelero en Los Mochis....'
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - [cached since 48.35s ago] {'id_1': UUID('7babb2a9-91fa-4d36-b836-d39a89428658'), 'param_1': 1}
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - INSERT INTO messages (conversation_id, role, content, id, created_at) VALUES (%(conversation_id)s::UUID, %(role)s, %(content)s, %(id)s::UUID, %(created_at)s)
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - [cached since 42.08s ago] {'conversation_id': UUID('7babb2a9-91fa-4d36-b836-d39a89428658'), 'role': 'assistant', 'content': "I see you're in the sector hotelero en Los Mochis. Para comenzar a diseñar una solución de tratamiento de aguas residuales adaptada a tus necesidades ... (281 characters truncated) ... r, proporciona la moneda y la unidad de medición). \n\n*Esta información es importante para evaluar la viabilidad económica de distintas soluciones.*", 'id': UUID('9a46ad42-3b4e-4c31-b538-338afee134f2'), 'created_at': datetime.datetime(2025, 5, 19, 14, 52, 42, 222315)}
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id, messages.role, messages.content, messages.id, messages.created_at 
FROM messages 
WHERE messages.id = %(pk_1)s::UUID
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - [cached since 42.09s ago] {'pk_1': UUID('9a46ad42-3b4e-4c31-b538-338afee134f2')}
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - [cached since 48.39s ago] {'id_1': UUID('7babb2a9-91fa-4d36-b836-d39a89428658'), 'param_1': 1}
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - UPDATE conversations SET current_question_id=%(current_question_id)s WHERE conversations.id = %(conversations_id)s::UUID
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - [cached since 36.94s ago] {'current_question_id': 'q_4', 'conversations_id': UUID('7babb2a9-91fa-4d36-b836-d39a89428658')}
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - [cached since 48.41s ago] {'pk_1': UUID('7babb2a9-91fa-4d36-b836-d39a89428658')}
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - [cached since 48.38s ago] {'conversation_id_1': UUID('7babb2a9-91fa-4d36-b836-d39a89428658'), 'key_1': 'user_name', 'param_1': 1}
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - [cached since 48.39s ago] {'conversation_id_1': UUID('7babb2a9-91fa-4d36-b836-d39a89428658'), 'key_1': 'user_location', 'param_1': 1}
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - [cached since 48.39s ago] {'conversation_id_1': UUID('7babb2a9-91fa-4d36-b836-d39a89428658'), 'key_1': 'sector', 'param_1': 1}
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - [cached since 48.4s ago] {'conversation_id_1': UUID('7babb2a9-91fa-4d36-b836-d39a89428658'), 'key_1': 'subsector', 'param_1': 1}
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - [cached since 48.41s ago] {'conversation_id_1': UUID('7babb2a9-91fa-4d36-b836-d39a89428658'), 'key_1': 'company_name', 'param_1': 1}
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - [cached since 48.42s ago] {'conversation_id_1': UUID('7babb2a9-91fa-4d36-b836-d39a89428658'), 'key_1': 'user_email', 'param_1': 1}
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - [cached since 48.43s ago] {'conversation_id_1': UUID('7babb2a9-91fa-4d36-b836-d39a89428658'), 'key_1': 'is_new_conversation', 'param_1': 1}
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - [cached since 48.44s ago] {'conversation_id_1': UUID('7babb2a9-91fa-4d36-b836-d39a89428658'), 'key_1': 'first_interaction', 'param_1': 1}
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - [cached since 48.44s ago] {'conversation_id_1': UUID('7babb2a9-91fa-4d36-b836-d39a89428658'), 'key_1': 'location', 'param_1': 1}
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversation_metadata (conversation_id, key, value, id, created_at) VALUES (%(conversation_id)s::UUID, %(key)s, %(value)s::JSONB, %(id)s::UUID, %(created_at)s)
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - [cached since 36.97s ago] {'conversation_id': UUID('7babb2a9-91fa-4d36-b836-d39a89428658'), 'key': 'location', 'value': '"los mochis"', 'id': UUID('7572d58e-7eba-40b4-9bce-bc39c4055009'), 'created_at': datetime.datetime(2025, 5, 19, 14, 52, 42, 318879)}
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - [cached since 48.45s ago] {'conversation_id_1': UUID('7babb2a9-91fa-4d36-b836-d39a89428658'), 'key_1': 'current_question_asked_summary', 'param_1': 1}
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversation_metadata (conversation_id, key, value, id, created_at) VALUES (%(conversation_id)s::UUID, %(key)s, %(value)s::JSONB, %(id)s::UUID, %(created_at)s)
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - [cached since 36.98s ago] {'conversation_id': UUID('7babb2a9-91fa-4d36-b836-d39a89428658'), 'key': 'current_question_asked_summary', 'value': '"\\u00bfCu\\u00e1l es el costo del agua en tu \\u00e1rea? (por favor, proporciona la moneda y la unidad de medici\\u00f3n)."', 'id': UUID('0244b087-a399-4acc-90a3-818a5ba1526b'), 'created_at': datetime.datetime(2025, 5, 19, 14, 52, 42, 323382)}
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:52:42 - hydrous - INFO - DBG_SS: Conversación 7babb2a9-91fa-4d36-b836-d39a89428658 actualizada en base de datos.
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.created_at < %(created_at_1)s
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - [cached since 36.95s ago] {'created_at_1': datetime.datetime(2025, 5, 18, 14, 52, 42, 328977)}
2025-05-19 14:52:42 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 14:57:38 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:57:38 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 14:57:38 - sqlalchemy.engine.Engine - INFO - [cached since 345.1s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 14:57:38 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 14:57:38 - hydrous - INFO - Datos del usuario al iniciar conversación: nombre=Ricardo Altamirano, empresa=hydrous, sector=commercial, subsector=Hotel, ubicación=los mochis, email=hydrous20@gmail.com
2025-05-19 14:57:38 - hydrous - INFO - Metadata inicial de la conversación: {'client_name': 'Ricardo Altamirano', 'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'selected_sector': 'commercial', 'selected_subsector': 'Hotel', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 14:57:38 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:57:38 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversations (user_id, selected_sector, selected_subsector, current_question_id, is_complete, has_proposal, client_name, proposal_text, pdf_path, id, created_at) VALUES (%(user_id)s::UUID, %(selected_sector)s, %(selected_subsector)s, %(current_question_id)s, %(is_complete)s, %(has_proposal)s, %(client_name)s, %(proposal_text)s, %(pdf_path)s, %(id)s::UUID, %(created_at)s)
2025-05-19 14:57:38 - sqlalchemy.engine.Engine - INFO - [cached since 345.2s ago] {'user_id': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'selected_sector': 'commercial', 'selected_subsector': 'Hotel', 'current_question_id': None, 'is_complete': False, 'has_proposal': False, 'client_name': 'Ricardo Altamirano', 'proposal_text': None, 'pdf_path': None, 'id': UUID('fc7d713b-57dc-42b6-81f5-f0017c713d5c'), 'created_at': datetime.datetime(2025, 5, 19, 14, 57, 38, 990898)}
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversation_metadata (conversation_id, key, value, id, created_at) VALUES (%(conversation_id__0)s::UUID, %(key__0)s, %(value__0)s::JSONB, %(id__0)s::UUID, %(created_at__0)s), (%(conversation_id__1)s::UUID, %(key__1)s, %(value__1)s::JSONB ... 543 characters truncated ...  (%(conversation_id__7)s::UUID, %(key__7)s, %(value__7)s::JSONB, %(id__7)s::UUID, %(created_at__7)s)
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - [cached since 345.2s ago (insertmanyvalues) 1/1 (unordered)] {'key__0': 'user_name', 'value__0': '"Ricardo Altamirano"', 'created_at__0': datetime.datetime(2025, 5, 19, 14, 57, 39, 9453), 'id__0': UUID('04811478-6477-4062-9b4e-abc88a9ffca7'), 'conversation_id__0': UUID('fc7d713b-57dc-42b6-81f5-f0017c713d5c'), 'key__1': 'user_location', 'value__1': '"los mochis"', 'created_at__1': datetime.datetime(2025, 5, 19, 14, 57, 39, 9458), 'id__1': UUID('2eb12867-6532-4631-829e-0cc6310b6d71'), 'conversation_id__1': UUID('fc7d713b-57dc-42b6-81f5-f0017c713d5c'), 'key__2': 'sector', 'value__2': '"commercial"', 'created_at__2': datetime.datetime(2025, 5, 19, 14, 57, 39, 9460), 'id__2': UUID('9ad1b29f-8c9d-4ff5-b0ca-1d197cf439b1'), 'conversation_id__2': UUID('fc7d713b-57dc-42b6-81f5-f0017c713d5c'), 'key__3': 'subsector', 'value__3': '"Hotel"', 'created_at__3': datetime.datetime(2025, 5, 19, 14, 57, 39, 9461), 'id__3': UUID('85bcfd17-edf8-412e-97e7-057b0a534cbc'), 'conversation_id__3': UUID('fc7d713b-57dc-42b6-81f5-f0017c713d5c'), 'key__4': 'company_name', 'value__4': '"hydrous"', 'created_at__4': datetime.datetime(2025, 5, 19, 14, 57, 39, 9463), 'id__4': UUID('3a35ccb7-61a1-4b8d-bad1-e51492608c95'), 'conversation_id__4': UUID('fc7d713b-57dc-42b6-81f5-f0017c713d5c'), 'key__5': 'user_email', 'value__5': '"hydrous20@gmail.com"', 'created_at__5': datetime.datetime(2025, 5, 19, 14, 57, 39, 9464), 'id__5': UUID('7ff3a74f-9001-4326-97bb-b3aafc02ef24'), 'conversation_id__5': UUID('fc7d713b-57dc-42b6-81f5-f0017c713d5c'), 'key__6': 'is_new_conversation', 'value__6': 'true', 'created_at__6': datetime.datetime(2025, 5, 19, 14, 57, 39, 9466), 'id__6': UUID('8d444740-8086-49f3-a2f1-d4cc31de5f77'), 'conversation_id__6': UUID('fc7d713b-57dc-42b6-81f5-f0017c713d5c'), 'key__7': 'first_interaction', 'value__7': 'true', 'created_at__7': datetime.datetime(2025, 5, 19, 14, 57, 39, 9467), 'id__7': UUID('4edf18f7-3ce1-4a13-9653-09fd9888a33d'), 'conversation_id__7': UUID('fc7d713b-57dc-42b6-81f5-f0017c713d5c')}
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - [cached since 345.2s ago] {'pk_1': UUID('fc7d713b-57dc-42b6-81f5-f0017c713d5c')}
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - [cached since 345.2s ago] {'id_1': UUID('fc7d713b-57dc-42b6-81f5-f0017c713d5c'), 'param_1': 1}
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - [cached since 345.2s ago] {'pk_1': UUID('fc7d713b-57dc-42b6-81f5-f0017c713d5c')}
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - [cached since 345.2s ago] {'conversation_id_1': UUID('fc7d713b-57dc-42b6-81f5-f0017c713d5c'), 'key_1': 'user_name', 'param_1': 1}
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - [cached since 345.2s ago] {'conversation_id_1': UUID('fc7d713b-57dc-42b6-81f5-f0017c713d5c'), 'key_1': 'user_location', 'param_1': 1}
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - [cached since 345.2s ago] {'conversation_id_1': UUID('fc7d713b-57dc-42b6-81f5-f0017c713d5c'), 'key_1': 'sector', 'param_1': 1}
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - [cached since 345.2s ago] {'conversation_id_1': UUID('fc7d713b-57dc-42b6-81f5-f0017c713d5c'), 'key_1': 'subsector', 'param_1': 1}
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - [cached since 345.2s ago] {'conversation_id_1': UUID('fc7d713b-57dc-42b6-81f5-f0017c713d5c'), 'key_1': 'company_name', 'param_1': 1}
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - [cached since 345.2s ago] {'conversation_id_1': UUID('fc7d713b-57dc-42b6-81f5-f0017c713d5c'), 'key_1': 'user_email', 'param_1': 1}
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - [cached since 345.2s ago] {'conversation_id_1': UUID('fc7d713b-57dc-42b6-81f5-f0017c713d5c'), 'key_1': 'is_new_conversation', 'param_1': 1}
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - [cached since 345.2s ago] {'conversation_id_1': UUID('fc7d713b-57dc-42b6-81f5-f0017c713d5c'), 'key_1': 'first_interaction', 'param_1': 1}
2025-05-19 14:57:39 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 14:57:39 - hydrous - INFO - DBG_SS: Conversación fc7d713b-57dc-42b6-81f5-f0017c713d5c actualizada en base de datos.
2025-05-19 15:01:35 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:01:35 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:01:35 - sqlalchemy.engine.Engine - INFO - [cached since 581.6s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 15:01:35 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:01:35 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:01:35 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:01:35 - sqlalchemy.engine.Engine - INFO - [cached since 581.6s ago] {'id_1': UUID('fc7d713b-57dc-42b6-81f5-f0017c713d5c'), 'param_1': 1}
2025-05-19 15:01:35 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE messages.conversation_id = %(conversation_id_1)s::UUID ORDER BY messages.created_at
2025-05-19 15:01:35 - sqlalchemy.engine.Engine - INFO - [cached since 575.4s ago] {'conversation_id_1': UUID('fc7d713b-57dc-42b6-81f5-f0017c713d5c')}
2025-05-19 15:01:35 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID
2025-05-19 15:01:35 - sqlalchemy.engine.Engine - INFO - [cached since 575.4s ago] {'conversation_id_1': UUID('fc7d713b-57dc-42b6-81f5-f0017c713d5c')}
2025-05-19 15:01:35 - hydrous - INFO - DBG_SS: Conversación fc7d713b-57dc-42b6-81f5-f0017c713d5c RECUPERADA. Metadata actual: {'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:01:35 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:01:35 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:01:35 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:01:35 - sqlalchemy.engine.Engine - INFO - [cached since 581.8s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 15:01:35 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:01:35 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:01:35 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:01:35 - sqlalchemy.engine.Engine - INFO - [cached since 581.7s ago] {'id_1': UUID('fc7d713b-57dc-42b6-81f5-f0017c713d5c'), 'param_1': 1}
2025-05-19 15:01:35 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE messages.conversation_id = %(conversation_id_1)s::UUID ORDER BY messages.created_at
2025-05-19 15:01:35 - sqlalchemy.engine.Engine - INFO - [cached since 575.5s ago] {'conversation_id_1': UUID('fc7d713b-57dc-42b6-81f5-f0017c713d5c')}
2025-05-19 15:01:35 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID
2025-05-19 15:01:35 - sqlalchemy.engine.Engine - INFO - [cached since 575.4s ago] {'conversation_id_1': UUID('fc7d713b-57dc-42b6-81f5-f0017c713d5c')}
2025-05-19 15:01:35 - hydrous - INFO - DBG_SS: Conversación fc7d713b-57dc-42b6-81f5-f0017c713d5c RECUPERADA. Metadata actual: {'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:01:35 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:02:03 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:02:03 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:02:03 - sqlalchemy.engine.Engine - INFO - [cached since 609.7s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 15:02:03 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:02:03 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:02:03 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:02:03 - sqlalchemy.engine.Engine - INFO - [cached since 609.6s ago] {'id_1': UUID('fc7d713b-57dc-42b6-81f5-f0017c713d5c'), 'param_1': 1}
2025-05-19 15:02:03 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE messages.conversation_id = %(conversation_id_1)s::UUID ORDER BY messages.created_at
2025-05-19 15:02:03 - sqlalchemy.engine.Engine - INFO - [cached since 603.4s ago] {'conversation_id_1': UUID('fc7d713b-57dc-42b6-81f5-f0017c713d5c')}
2025-05-19 15:02:03 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID
2025-05-19 15:02:03 - sqlalchemy.engine.Engine - INFO - [cached since 603.4s ago] {'conversation_id_1': UUID('fc7d713b-57dc-42b6-81f5-f0017c713d5c')}
2025-05-19 15:02:03 - hydrous - INFO - DBG_SS: Conversación fc7d713b-57dc-42b6-81f5-f0017c713d5c RECUPERADA. Metadata actual: {'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:02:03 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:02:03 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:02:03 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:02:03 - sqlalchemy.engine.Engine - INFO - [cached since 609.8s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 15:02:03 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:02:03 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:02:03 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:02:03 - sqlalchemy.engine.Engine - INFO - [cached since 609.7s ago] {'id_1': UUID('fc7d713b-57dc-42b6-81f5-f0017c713d5c'), 'param_1': 1}
2025-05-19 15:02:03 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE messages.conversation_id = %(conversation_id_1)s::UUID ORDER BY messages.created_at
2025-05-19 15:02:03 - sqlalchemy.engine.Engine - INFO - [cached since 603.5s ago] {'conversation_id_1': UUID('fc7d713b-57dc-42b6-81f5-f0017c713d5c')}
2025-05-19 15:02:03 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID
2025-05-19 15:02:03 - sqlalchemy.engine.Engine - INFO - [cached since 603.5s ago] {'conversation_id_1': UUID('fc7d713b-57dc-42b6-81f5-f0017c713d5c')}
2025-05-19 15:02:03 - hydrous - INFO - DBG_SS: Conversación fc7d713b-57dc-42b6-81f5-f0017c713d5c RECUPERADA. Metadata actual: {'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:02:03 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - [cached since 613.3s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:02:07 - hydrous - INFO - Datos del usuario al iniciar conversación: nombre=Ricardo Altamirano, empresa=hydrous, sector=commercial, subsector=Hotel, ubicación=los mochis, email=hydrous20@gmail.com
2025-05-19 15:02:07 - hydrous - INFO - Metadata inicial de la conversación: {'client_name': 'Ricardo Altamirano', 'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'selected_sector': 'commercial', 'selected_subsector': 'Hotel', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversations (user_id, selected_sector, selected_subsector, current_question_id, is_complete, has_proposal, client_name, proposal_text, pdf_path, id, created_at) VALUES (%(user_id)s::UUID, %(selected_sector)s, %(selected_subsector)s, %(current_question_id)s, %(is_complete)s, %(has_proposal)s, %(client_name)s, %(proposal_text)s, %(pdf_path)s, %(id)s::UUID, %(created_at)s)
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - [cached since 613.3s ago] {'user_id': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'selected_sector': 'commercial', 'selected_subsector': 'Hotel', 'current_question_id': None, 'is_complete': False, 'has_proposal': False, 'client_name': 'Ricardo Altamirano', 'proposal_text': None, 'pdf_path': None, 'id': UUID('da1e61da-983a-4f9a-97b0-79afc943ef7b'), 'created_at': datetime.datetime(2025, 5, 19, 15, 2, 7, 108768)}
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversation_metadata (conversation_id, key, value, id, created_at) VALUES (%(conversation_id__0)s::UUID, %(key__0)s, %(value__0)s::JSONB, %(id__0)s::UUID, %(created_at__0)s), (%(conversation_id__1)s::UUID, %(key__1)s, %(value__1)s::JSONB ... 543 characters truncated ...  (%(conversation_id__7)s::UUID, %(key__7)s, %(value__7)s::JSONB, %(id__7)s::UUID, %(created_at__7)s)
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - [cached since 613.3s ago (insertmanyvalues) 1/1 (unordered)] {'key__0': 'user_name', 'value__0': '"Ricardo Altamirano"', 'created_at__0': datetime.datetime(2025, 5, 19, 15, 2, 7, 130834), 'id__0': UUID('246a8b6a-6529-43a5-88ac-129496148743'), 'conversation_id__0': UUID('da1e61da-983a-4f9a-97b0-79afc943ef7b'), 'key__1': 'user_location', 'value__1': '"los mochis"', 'created_at__1': datetime.datetime(2025, 5, 19, 15, 2, 7, 130863), 'id__1': UUID('5ebcee08-c408-49bf-8935-5b4acbde2f04'), 'conversation_id__1': UUID('da1e61da-983a-4f9a-97b0-79afc943ef7b'), 'key__2': 'sector', 'value__2': '"commercial"', 'created_at__2': datetime.datetime(2025, 5, 19, 15, 2, 7, 130865), 'id__2': UUID('bcfa6134-40d9-4141-a312-d50dd238ff5d'), 'conversation_id__2': UUID('da1e61da-983a-4f9a-97b0-79afc943ef7b'), 'key__3': 'subsector', 'value__3': '"Hotel"', 'created_at__3': datetime.datetime(2025, 5, 19, 15, 2, 7, 130866), 'id__3': UUID('fb02fb14-20a4-4870-a86f-b2374550745a'), 'conversation_id__3': UUID('da1e61da-983a-4f9a-97b0-79afc943ef7b'), 'key__4': 'company_name', 'value__4': '"hydrous"', 'created_at__4': datetime.datetime(2025, 5, 19, 15, 2, 7, 130868), 'id__4': UUID('7279f9fd-66f4-4808-94c6-7229fe81d3a4'), 'conversation_id__4': UUID('da1e61da-983a-4f9a-97b0-79afc943ef7b'), 'key__5': 'user_email', 'value__5': '"hydrous20@gmail.com"', 'created_at__5': datetime.datetime(2025, 5, 19, 15, 2, 7, 130869), 'id__5': UUID('0eb1e419-e2a8-4238-b224-5a68c738df01'), 'conversation_id__5': UUID('da1e61da-983a-4f9a-97b0-79afc943ef7b'), 'key__6': 'is_new_conversation', 'value__6': 'true', 'created_at__6': datetime.datetime(2025, 5, 19, 15, 2, 7, 130871), 'id__6': UUID('5e099987-0674-48bf-b708-3a3634850d9c'), 'conversation_id__6': UUID('da1e61da-983a-4f9a-97b0-79afc943ef7b'), 'key__7': 'first_interaction', 'value__7': 'true', 'created_at__7': datetime.datetime(2025, 5, 19, 15, 2, 7, 130873), 'id__7': UUID('cafc52ea-6a75-4bdf-88b9-69a5f20edab2'), 'conversation_id__7': UUID('da1e61da-983a-4f9a-97b0-79afc943ef7b')}
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - [cached since 613.3s ago] {'pk_1': UUID('da1e61da-983a-4f9a-97b0-79afc943ef7b')}
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - [cached since 613.3s ago] {'id_1': UUID('da1e61da-983a-4f9a-97b0-79afc943ef7b'), 'param_1': 1}
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - [cached since 613.3s ago] {'pk_1': UUID('da1e61da-983a-4f9a-97b0-79afc943ef7b')}
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - [cached since 613.3s ago] {'conversation_id_1': UUID('da1e61da-983a-4f9a-97b0-79afc943ef7b'), 'key_1': 'user_name', 'param_1': 1}
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - [cached since 613.3s ago] {'conversation_id_1': UUID('da1e61da-983a-4f9a-97b0-79afc943ef7b'), 'key_1': 'user_location', 'param_1': 1}
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - [cached since 613.3s ago] {'conversation_id_1': UUID('da1e61da-983a-4f9a-97b0-79afc943ef7b'), 'key_1': 'sector', 'param_1': 1}
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - [cached since 613.3s ago] {'conversation_id_1': UUID('da1e61da-983a-4f9a-97b0-79afc943ef7b'), 'key_1': 'subsector', 'param_1': 1}
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - [cached since 613.3s ago] {'conversation_id_1': UUID('da1e61da-983a-4f9a-97b0-79afc943ef7b'), 'key_1': 'company_name', 'param_1': 1}
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - [cached since 613.3s ago] {'conversation_id_1': UUID('da1e61da-983a-4f9a-97b0-79afc943ef7b'), 'key_1': 'user_email', 'param_1': 1}
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - [cached since 613.3s ago] {'conversation_id_1': UUID('da1e61da-983a-4f9a-97b0-79afc943ef7b'), 'key_1': 'is_new_conversation', 'param_1': 1}
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - [cached since 613.3s ago] {'conversation_id_1': UUID('da1e61da-983a-4f9a-97b0-79afc943ef7b'), 'key_1': 'first_interaction', 'param_1': 1}
2025-05-19 15:02:07 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:02:07 - hydrous - INFO - DBG_SS: Conversación da1e61da-983a-4f9a-97b0-79afc943ef7b actualizada en base de datos.
2025-05-19 15:06:48 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:06:48 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:06:48 - sqlalchemy.engine.Engine - INFO - [cached since 895.2s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 15:06:49 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:06:49 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:06:49 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:06:49 - sqlalchemy.engine.Engine - INFO - [cached since 895.3s ago] {'id_1': UUID('da1e61da-983a-4f9a-97b0-79afc943ef7b'), 'param_1': 1}
2025-05-19 15:06:49 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE messages.conversation_id = %(conversation_id_1)s::UUID ORDER BY messages.created_at
2025-05-19 15:06:49 - sqlalchemy.engine.Engine - INFO - [cached since 889.1s ago] {'conversation_id_1': UUID('da1e61da-983a-4f9a-97b0-79afc943ef7b')}
2025-05-19 15:06:49 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID
2025-05-19 15:06:49 - sqlalchemy.engine.Engine - INFO - [cached since 889.1s ago] {'conversation_id_1': UUID('da1e61da-983a-4f9a-97b0-79afc943ef7b')}
2025-05-19 15:06:49 - hydrous - INFO - DBG_SS: Conversación da1e61da-983a-4f9a-97b0-79afc943ef7b RECUPERADA. Metadata actual: {'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:06:49 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:06:49 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:06:49 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:06:49 - sqlalchemy.engine.Engine - INFO - [cached since 895.5s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 15:06:49 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:06:49 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:06:49 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:06:49 - sqlalchemy.engine.Engine - INFO - [cached since 895.4s ago] {'id_1': UUID('da1e61da-983a-4f9a-97b0-79afc943ef7b'), 'param_1': 1}
2025-05-19 15:06:49 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE messages.conversation_id = %(conversation_id_1)s::UUID ORDER BY messages.created_at
2025-05-19 15:06:49 - sqlalchemy.engine.Engine - INFO - [cached since 889.2s ago] {'conversation_id_1': UUID('da1e61da-983a-4f9a-97b0-79afc943ef7b')}
2025-05-19 15:06:49 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID
2025-05-19 15:06:49 - sqlalchemy.engine.Engine - INFO - [cached since 889.1s ago] {'conversation_id_1': UUID('da1e61da-983a-4f9a-97b0-79afc943ef7b')}
2025-05-19 15:06:49 - hydrous - INFO - DBG_SS: Conversación da1e61da-983a-4f9a-97b0-79afc943ef7b RECUPERADA. Metadata actual: {'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:06:49 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - [cached since 901.4s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:06:55 - hydrous - INFO - Datos del usuario al iniciar conversación: nombre=Ricardo Altamirano, empresa=hydrous, sector=commercial, subsector=Hotel, ubicación=los mochis, email=hydrous20@gmail.com
2025-05-19 15:06:55 - hydrous - INFO - Metadata inicial de la conversación: {'client_name': 'Ricardo Altamirano', 'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'selected_sector': 'commercial', 'selected_subsector': 'Hotel', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversations (user_id, selected_sector, selected_subsector, current_question_id, is_complete, has_proposal, client_name, proposal_text, pdf_path, id, created_at) VALUES (%(user_id)s::UUID, %(selected_sector)s, %(selected_subsector)s, %(current_question_id)s, %(is_complete)s, %(has_proposal)s, %(client_name)s, %(proposal_text)s, %(pdf_path)s, %(id)s::UUID, %(created_at)s)
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - [cached since 901.4s ago] {'user_id': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'selected_sector': 'commercial', 'selected_subsector': 'Hotel', 'current_question_id': None, 'is_complete': False, 'has_proposal': False, 'client_name': 'Ricardo Altamirano', 'proposal_text': None, 'pdf_path': None, 'id': UUID('fa2d2d3d-8b51-4564-8ff4-d7712007118f'), 'created_at': datetime.datetime(2025, 5, 19, 15, 6, 55, 193702)}
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversation_metadata (conversation_id, key, value, id, created_at) VALUES (%(conversation_id__0)s::UUID, %(key__0)s, %(value__0)s::JSONB, %(id__0)s::UUID, %(created_at__0)s), (%(conversation_id__1)s::UUID, %(key__1)s, %(value__1)s::JSONB ... 543 characters truncated ...  (%(conversation_id__7)s::UUID, %(key__7)s, %(value__7)s::JSONB, %(id__7)s::UUID, %(created_at__7)s)
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - [cached since 901.4s ago (insertmanyvalues) 1/1 (unordered)] {'key__0': 'user_name', 'value__0': '"Ricardo Altamirano"', 'created_at__0': datetime.datetime(2025, 5, 19, 15, 6, 55, 235716), 'id__0': UUID('3673cca4-7498-496d-a2b2-ce6329c17f38'), 'conversation_id__0': UUID('fa2d2d3d-8b51-4564-8ff4-d7712007118f'), 'key__1': 'user_location', 'value__1': '"los mochis"', 'created_at__1': datetime.datetime(2025, 5, 19, 15, 6, 55, 235807), 'id__1': UUID('7fdba50b-be9d-45a9-8306-6aa6fd2765b5'), 'conversation_id__1': UUID('fa2d2d3d-8b51-4564-8ff4-d7712007118f'), 'key__2': 'sector', 'value__2': '"commercial"', 'created_at__2': datetime.datetime(2025, 5, 19, 15, 6, 55, 235812), 'id__2': UUID('bd0ed66d-60bd-40e6-8349-1077ac1e35e5'), 'conversation_id__2': UUID('fa2d2d3d-8b51-4564-8ff4-d7712007118f'), 'key__3': 'subsector', 'value__3': '"Hotel"', 'created_at__3': datetime.datetime(2025, 5, 19, 15, 6, 55, 235814), 'id__3': UUID('4efc3a22-5125-43ef-b0d5-98526eaa7ea1'), 'conversation_id__3': UUID('fa2d2d3d-8b51-4564-8ff4-d7712007118f'), 'key__4': 'company_name', 'value__4': '"hydrous"', 'created_at__4': datetime.datetime(2025, 5, 19, 15, 6, 55, 235816), 'id__4': UUID('2917b835-c034-4a4f-8372-ea46d8b3a31a'), 'conversation_id__4': UUID('fa2d2d3d-8b51-4564-8ff4-d7712007118f'), 'key__5': 'user_email', 'value__5': '"hydrous20@gmail.com"', 'created_at__5': datetime.datetime(2025, 5, 19, 15, 6, 55, 235817), 'id__5': UUID('206b0bf7-3ae3-40ce-87ac-8cc860fa62b9'), 'conversation_id__5': UUID('fa2d2d3d-8b51-4564-8ff4-d7712007118f'), 'key__6': 'is_new_conversation', 'value__6': 'true', 'created_at__6': datetime.datetime(2025, 5, 19, 15, 6, 55, 235819), 'id__6': UUID('913f19d4-6854-4aa5-ad60-ae178f5375ff'), 'conversation_id__6': UUID('fa2d2d3d-8b51-4564-8ff4-d7712007118f'), 'key__7': 'first_interaction', 'value__7': 'true', 'created_at__7': datetime.datetime(2025, 5, 19, 15, 6, 55, 235820), 'id__7': UUID('acb9da17-3e06-4026-a4ac-0437b5c2f05b'), 'conversation_id__7': UUID('fa2d2d3d-8b51-4564-8ff4-d7712007118f')}
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - [cached since 901.4s ago] {'pk_1': UUID('fa2d2d3d-8b51-4564-8ff4-d7712007118f')}
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - [cached since 901.4s ago] {'id_1': UUID('fa2d2d3d-8b51-4564-8ff4-d7712007118f'), 'param_1': 1}
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - [cached since 901.4s ago] {'pk_1': UUID('fa2d2d3d-8b51-4564-8ff4-d7712007118f')}
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - [cached since 901.4s ago] {'conversation_id_1': UUID('fa2d2d3d-8b51-4564-8ff4-d7712007118f'), 'key_1': 'user_name', 'param_1': 1}
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - [cached since 901.4s ago] {'conversation_id_1': UUID('fa2d2d3d-8b51-4564-8ff4-d7712007118f'), 'key_1': 'user_location', 'param_1': 1}
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - [cached since 901.4s ago] {'conversation_id_1': UUID('fa2d2d3d-8b51-4564-8ff4-d7712007118f'), 'key_1': 'sector', 'param_1': 1}
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - [cached since 901.4s ago] {'conversation_id_1': UUID('fa2d2d3d-8b51-4564-8ff4-d7712007118f'), 'key_1': 'subsector', 'param_1': 1}
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - [cached since 901.4s ago] {'conversation_id_1': UUID('fa2d2d3d-8b51-4564-8ff4-d7712007118f'), 'key_1': 'company_name', 'param_1': 1}
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - [cached since 901.4s ago] {'conversation_id_1': UUID('fa2d2d3d-8b51-4564-8ff4-d7712007118f'), 'key_1': 'user_email', 'param_1': 1}
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - [cached since 901.4s ago] {'conversation_id_1': UUID('fa2d2d3d-8b51-4564-8ff4-d7712007118f'), 'key_1': 'is_new_conversation', 'param_1': 1}
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - [cached since 901.4s ago] {'conversation_id_1': UUID('fa2d2d3d-8b51-4564-8ff4-d7712007118f'), 'key_1': 'first_interaction', 'param_1': 1}
2025-05-19 15:06:55 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:06:55 - hydrous - INFO - DBG_SS: Conversación fa2d2d3d-8b51-4564-8ff4-d7712007118f actualizada en base de datos.
2025-05-19 15:07:45 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:07:45 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:07:45 - sqlalchemy.engine.Engine - INFO - [cached since 951.3s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 15:07:45 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:07:45 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:07:45 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:07:45 - sqlalchemy.engine.Engine - INFO - [cached since 951.2s ago] {'id_1': UUID('fa2d2d3d-8b51-4564-8ff4-d7712007118f'), 'param_1': 1}
2025-05-19 15:07:45 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE messages.conversation_id = %(conversation_id_1)s::UUID ORDER BY messages.created_at
2025-05-19 15:07:45 - sqlalchemy.engine.Engine - INFO - [cached since 945s ago] {'conversation_id_1': UUID('fa2d2d3d-8b51-4564-8ff4-d7712007118f')}
2025-05-19 15:07:45 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID
2025-05-19 15:07:45 - sqlalchemy.engine.Engine - INFO - [cached since 945s ago] {'conversation_id_1': UUID('fa2d2d3d-8b51-4564-8ff4-d7712007118f')}
2025-05-19 15:07:45 - hydrous - INFO - DBG_SS: Conversación fa2d2d3d-8b51-4564-8ff4-d7712007118f RECUPERADA. Metadata actual: {'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:07:45 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:07:45 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:07:45 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:07:45 - sqlalchemy.engine.Engine - INFO - [cached since 951.4s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 15:07:45 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:07:45 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:07:45 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:07:45 - sqlalchemy.engine.Engine - INFO - [cached since 951.3s ago] {'id_1': UUID('fa2d2d3d-8b51-4564-8ff4-d7712007118f'), 'param_1': 1}
2025-05-19 15:07:45 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE messages.conversation_id = %(conversation_id_1)s::UUID ORDER BY messages.created_at
2025-05-19 15:07:45 - sqlalchemy.engine.Engine - INFO - [cached since 945s ago] {'conversation_id_1': UUID('fa2d2d3d-8b51-4564-8ff4-d7712007118f')}
2025-05-19 15:07:45 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID
2025-05-19 15:07:45 - sqlalchemy.engine.Engine - INFO - [cached since 945s ago] {'conversation_id_1': UUID('fa2d2d3d-8b51-4564-8ff4-d7712007118f')}
2025-05-19 15:07:45 - hydrous - INFO - DBG_SS: Conversación fa2d2d3d-8b51-4564-8ff4-d7712007118f RECUPERADA. Metadata actual: {'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:07:45 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - [cached since 958.7s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:07:52 - hydrous - INFO - Datos del usuario al iniciar conversación: nombre=Ricardo Altamirano, empresa=hydrous, sector=commercial, subsector=Hotel, ubicación=los mochis, email=hydrous20@gmail.com
2025-05-19 15:07:52 - hydrous - INFO - Metadata inicial de la conversación: {'client_name': 'Ricardo Altamirano', 'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'selected_sector': 'commercial', 'selected_subsector': 'Hotel', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversations (user_id, selected_sector, selected_subsector, current_question_id, is_complete, has_proposal, client_name, proposal_text, pdf_path, id, created_at) VALUES (%(user_id)s::UUID, %(selected_sector)s, %(selected_subsector)s, %(current_question_id)s, %(is_complete)s, %(has_proposal)s, %(client_name)s, %(proposal_text)s, %(pdf_path)s, %(id)s::UUID, %(created_at)s)
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - [cached since 958.7s ago] {'user_id': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'selected_sector': 'commercial', 'selected_subsector': 'Hotel', 'current_question_id': None, 'is_complete': False, 'has_proposal': False, 'client_name': 'Ricardo Altamirano', 'proposal_text': None, 'pdf_path': None, 'id': UUID('bba0c861-3a20-42ac-957e-7be2555de45b'), 'created_at': datetime.datetime(2025, 5, 19, 15, 7, 52, 473305)}
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversation_metadata (conversation_id, key, value, id, created_at) VALUES (%(conversation_id__0)s::UUID, %(key__0)s, %(value__0)s::JSONB, %(id__0)s::UUID, %(created_at__0)s), (%(conversation_id__1)s::UUID, %(key__1)s, %(value__1)s::JSONB ... 543 characters truncated ...  (%(conversation_id__7)s::UUID, %(key__7)s, %(value__7)s::JSONB, %(id__7)s::UUID, %(created_at__7)s)
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - [cached since 958.6s ago (insertmanyvalues) 1/1 (unordered)] {'key__0': 'user_name', 'value__0': '"Ricardo Altamirano"', 'created_at__0': datetime.datetime(2025, 5, 19, 15, 7, 52, 479269), 'id__0': UUID('14446197-b6b2-459a-a12f-23af0e35d0a7'), 'conversation_id__0': UUID('bba0c861-3a20-42ac-957e-7be2555de45b'), 'key__1': 'user_location', 'value__1': '"los mochis"', 'created_at__1': datetime.datetime(2025, 5, 19, 15, 7, 52, 479274), 'id__1': UUID('bf510c8a-141a-43e3-b553-5a54304070d8'), 'conversation_id__1': UUID('bba0c861-3a20-42ac-957e-7be2555de45b'), 'key__2': 'sector', 'value__2': '"commercial"', 'created_at__2': datetime.datetime(2025, 5, 19, 15, 7, 52, 479276), 'id__2': UUID('0085041b-2327-47b6-bf91-f6259cf8faee'), 'conversation_id__2': UUID('bba0c861-3a20-42ac-957e-7be2555de45b'), 'key__3': 'subsector', 'value__3': '"Hotel"', 'created_at__3': datetime.datetime(2025, 5, 19, 15, 7, 52, 479278), 'id__3': UUID('875bfba9-e3c0-4021-93e2-15bc2365625b'), 'conversation_id__3': UUID('bba0c861-3a20-42ac-957e-7be2555de45b'), 'key__4': 'company_name', 'value__4': '"hydrous"', 'created_at__4': datetime.datetime(2025, 5, 19, 15, 7, 52, 479279), 'id__4': UUID('ff9c510a-a05d-4417-b4e7-f6956c30764b'), 'conversation_id__4': UUID('bba0c861-3a20-42ac-957e-7be2555de45b'), 'key__5': 'user_email', 'value__5': '"hydrous20@gmail.com"', 'created_at__5': datetime.datetime(2025, 5, 19, 15, 7, 52, 479281), 'id__5': UUID('0b01b95d-86a3-4563-9a85-0fa6e68c19b7'), 'conversation_id__5': UUID('bba0c861-3a20-42ac-957e-7be2555de45b'), 'key__6': 'is_new_conversation', 'value__6': 'true', 'created_at__6': datetime.datetime(2025, 5, 19, 15, 7, 52, 479282), 'id__6': UUID('3582c0d8-d4b0-4551-a90c-0cc887be26e0'), 'conversation_id__6': UUID('bba0c861-3a20-42ac-957e-7be2555de45b'), 'key__7': 'first_interaction', 'value__7': 'true', 'created_at__7': datetime.datetime(2025, 5, 19, 15, 7, 52, 479284), 'id__7': UUID('9d589c3e-7c99-43ab-a24b-787750a2de03'), 'conversation_id__7': UUID('bba0c861-3a20-42ac-957e-7be2555de45b')}
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - [cached since 958.6s ago] {'pk_1': UUID('bba0c861-3a20-42ac-957e-7be2555de45b')}
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - [cached since 958.6s ago] {'id_1': UUID('bba0c861-3a20-42ac-957e-7be2555de45b'), 'param_1': 1}
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - [cached since 958.6s ago] {'pk_1': UUID('bba0c861-3a20-42ac-957e-7be2555de45b')}
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - [cached since 958.6s ago] {'conversation_id_1': UUID('bba0c861-3a20-42ac-957e-7be2555de45b'), 'key_1': 'user_name', 'param_1': 1}
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - [cached since 958.6s ago] {'conversation_id_1': UUID('bba0c861-3a20-42ac-957e-7be2555de45b'), 'key_1': 'user_location', 'param_1': 1}
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - [cached since 958.6s ago] {'conversation_id_1': UUID('bba0c861-3a20-42ac-957e-7be2555de45b'), 'key_1': 'sector', 'param_1': 1}
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - [cached since 958.6s ago] {'conversation_id_1': UUID('bba0c861-3a20-42ac-957e-7be2555de45b'), 'key_1': 'subsector', 'param_1': 1}
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - [cached since 958.6s ago] {'conversation_id_1': UUID('bba0c861-3a20-42ac-957e-7be2555de45b'), 'key_1': 'company_name', 'param_1': 1}
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - [cached since 958.6s ago] {'conversation_id_1': UUID('bba0c861-3a20-42ac-957e-7be2555de45b'), 'key_1': 'user_email', 'param_1': 1}
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - [cached since 958.6s ago] {'conversation_id_1': UUID('bba0c861-3a20-42ac-957e-7be2555de45b'), 'key_1': 'is_new_conversation', 'param_1': 1}
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - [cached since 958.6s ago] {'conversation_id_1': UUID('bba0c861-3a20-42ac-957e-7be2555de45b'), 'key_1': 'first_interaction', 'param_1': 1}
2025-05-19 15:07:52 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:07:52 - hydrous - INFO - DBG_SS: Conversación bba0c861-3a20-42ac-957e-7be2555de45b actualizada en base de datos.
2025-05-19 15:10:45 - root - INFO - Configuración de logging inicializada
2025-05-19 15:11:43 - root - INFO - Configuración de logging inicializada
2025-05-19 15:12:25 - root - INFO - Configuración de logging inicializada
2025-05-19 15:13:13 - root - INFO - Configuración de logging inicializada
2025-05-19 15:14:13 - root - INFO - Configuración de logging inicializada
2025-05-19 15:14:34 - root - INFO - Configuración de logging inicializada
2025-05-19 15:15:03 - root - INFO - Configuración de logging inicializada
2025-05-19 15:15:32 - root - INFO - Configuración de logging inicializada
2025-05-19 15:15:40 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-05-19 15:15:40 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-05-19 15:15:40 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-05-19 15:15:40 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-05-19 15:15:40 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-05-19 15:15:40 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-05-19 15:15:40 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:15:40 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:15:40 - sqlalchemy.engine.Engine - INFO - [generated in 0.00152s] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 15:15:40 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:15:40 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:15:40 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:15:40 - sqlalchemy.engine.Engine - INFO - [generated in 0.00065s] {'id_1': UUID('bba0c861-3a20-42ac-957e-7be2555de45b'), 'param_1': 1}
2025-05-19 15:15:40 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE messages.conversation_id = %(conversation_id_1)s::UUID ORDER BY messages.created_at
2025-05-19 15:15:40 - sqlalchemy.engine.Engine - INFO - [generated in 0.00285s] {'conversation_id_1': UUID('bba0c861-3a20-42ac-957e-7be2555de45b')}
2025-05-19 15:15:40 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID
2025-05-19 15:15:40 - sqlalchemy.engine.Engine - INFO - [generated in 0.00060s] {'conversation_id_1': UUID('bba0c861-3a20-42ac-957e-7be2555de45b')}
2025-05-19 15:15:40 - hydrous - INFO - DBG_SS: Conversación bba0c861-3a20-42ac-957e-7be2555de45b RECUPERADA. Metadata actual: {'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:15:40 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:15:40 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:15:40 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:15:40 - sqlalchemy.engine.Engine - INFO - [cached since 0.09904s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 15:15:40 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:15:40 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:15:40 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:15:40 - sqlalchemy.engine.Engine - INFO - [cached since 0.08178s ago] {'id_1': UUID('bba0c861-3a20-42ac-957e-7be2555de45b'), 'param_1': 1}
2025-05-19 15:15:40 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE messages.conversation_id = %(conversation_id_1)s::UUID ORDER BY messages.created_at
2025-05-19 15:15:40 - sqlalchemy.engine.Engine - INFO - [cached since 0.07785s ago] {'conversation_id_1': UUID('bba0c861-3a20-42ac-957e-7be2555de45b')}
2025-05-19 15:15:40 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID
2025-05-19 15:15:40 - sqlalchemy.engine.Engine - INFO - [cached since 0.07154s ago] {'conversation_id_1': UUID('bba0c861-3a20-42ac-957e-7be2555de45b')}
2025-05-19 15:15:40 - hydrous - INFO - DBG_SS: Conversación bba0c861-3a20-42ac-957e-7be2555de45b RECUPERADA. Metadata actual: {'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:15:40 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - [cached since 3.656s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:15:44 - hydrous - INFO - Datos del usuario al iniciar conversación: nombre=Ricardo Altamirano, empresa=hydrous, sector=commercial, subsector=Hotel, ubicación=los mochis, email=hydrous20@gmail.com
2025-05-19 15:15:44 - hydrous - INFO - Metadata inicial de la conversación: {'client_name': 'Ricardo Altamirano', 'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'selected_sector': 'commercial', 'selected_subsector': 'Hotel', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversations (user_id, selected_sector, selected_subsector, current_question_id, is_complete, has_proposal, client_name, proposal_text, pdf_path, id, created_at) VALUES (%(user_id)s::UUID, %(selected_sector)s, %(selected_subsector)s, %(current_question_id)s, %(is_complete)s, %(has_proposal)s, %(client_name)s, %(proposal_text)s, %(pdf_path)s, %(id)s::UUID, %(created_at)s)
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - [generated in 0.00092s] {'user_id': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'selected_sector': 'commercial', 'selected_subsector': 'Hotel', 'current_question_id': None, 'is_complete': False, 'has_proposal': False, 'client_name': 'Ricardo Altamirano', 'proposal_text': None, 'pdf_path': None, 'id': UUID('a7165b82-889b-4907-9504-000c40fdb175'), 'created_at': datetime.datetime(2025, 5, 19, 15, 15, 44, 325420)}
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversation_metadata (conversation_id, key, value, id, created_at) VALUES (%(conversation_id__0)s::UUID, %(key__0)s, %(value__0)s::JSONB, %(id__0)s::UUID, %(created_at__0)s), (%(conversation_id__1)s::UUID, %(key__1)s, %(value__1)s::JSONB ... 543 characters truncated ...  (%(conversation_id__7)s::UUID, %(key__7)s, %(value__7)s::JSONB, %(id__7)s::UUID, %(created_at__7)s)
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - [generated in 0.00070s (insertmanyvalues) 1/1 (unordered)] {'value__0': '"Ricardo Altamirano"', 'id__0': UUID('7f3de785-9eb4-4a33-b14f-a3a1d40868b7'), 'key__0': 'user_name', 'conversation_id__0': UUID('a7165b82-889b-4907-9504-000c40fdb175'), 'created_at__0': datetime.datetime(2025, 5, 19, 15, 15, 44, 334798), 'value__1': '"los mochis"', 'id__1': UUID('9e4dc2a3-b6ce-4748-9a9c-ee295a214853'), 'key__1': 'user_location', 'conversation_id__1': UUID('a7165b82-889b-4907-9504-000c40fdb175'), 'created_at__1': datetime.datetime(2025, 5, 19, 15, 15, 44, 334805), 'value__2': '"commercial"', 'id__2': UUID('90c88bc1-28de-4331-b5a4-b2cbb279e474'), 'key__2': 'sector', 'conversation_id__2': UUID('a7165b82-889b-4907-9504-000c40fdb175'), 'created_at__2': datetime.datetime(2025, 5, 19, 15, 15, 44, 334807), 'value__3': '"Hotel"', 'id__3': UUID('646a3c3d-9a8b-4061-86be-9de001ad3a6b'), 'key__3': 'subsector', 'conversation_id__3': UUID('a7165b82-889b-4907-9504-000c40fdb175'), 'created_at__3': datetime.datetime(2025, 5, 19, 15, 15, 44, 334808), 'value__4': '"hydrous"', 'id__4': UUID('ff8587b9-bbaa-4409-ba08-773f48aa54e6'), 'key__4': 'company_name', 'conversation_id__4': UUID('a7165b82-889b-4907-9504-000c40fdb175'), 'created_at__4': datetime.datetime(2025, 5, 19, 15, 15, 44, 334810), 'value__5': '"hydrous20@gmail.com"', 'id__5': UUID('e1dde8c6-7c98-4c68-8f61-c375981050d0'), 'key__5': 'user_email', 'conversation_id__5': UUID('a7165b82-889b-4907-9504-000c40fdb175'), 'created_at__5': datetime.datetime(2025, 5, 19, 15, 15, 44, 334811), 'value__6': 'true', 'id__6': UUID('73687fc3-7b7b-4c75-8af0-98e377745740'), 'key__6': 'is_new_conversation', 'conversation_id__6': UUID('a7165b82-889b-4907-9504-000c40fdb175'), 'created_at__6': datetime.datetime(2025, 5, 19, 15, 15, 44, 334813), 'value__7': 'true', 'id__7': UUID('b06b0f71-6be1-47f8-9a49-ebf3214cc46d'), 'key__7': 'first_interaction', 'conversation_id__7': UUID('a7165b82-889b-4907-9504-000c40fdb175'), 'created_at__7': datetime.datetime(2025, 5, 19, 15, 15, 44, 334814)}
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - [generated in 0.00037s] {'pk_1': UUID('a7165b82-889b-4907-9504-000c40fdb175')}
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - [cached since 3.683s ago] {'id_1': UUID('a7165b82-889b-4907-9504-000c40fdb175'), 'param_1': 1}
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - [cached since 0.00962s ago] {'pk_1': UUID('a7165b82-889b-4907-9504-000c40fdb175')}
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - [generated in 0.00092s] {'conversation_id_1': UUID('a7165b82-889b-4907-9504-000c40fdb175'), 'key_1': 'user_name', 'param_1': 1}
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - [cached since 0.004982s ago] {'conversation_id_1': UUID('a7165b82-889b-4907-9504-000c40fdb175'), 'key_1': 'user_location', 'param_1': 1}
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - [cached since 0.007886s ago] {'conversation_id_1': UUID('a7165b82-889b-4907-9504-000c40fdb175'), 'key_1': 'sector', 'param_1': 1}
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - [cached since 0.01097s ago] {'conversation_id_1': UUID('a7165b82-889b-4907-9504-000c40fdb175'), 'key_1': 'subsector', 'param_1': 1}
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - [cached since 0.0133s ago] {'conversation_id_1': UUID('a7165b82-889b-4907-9504-000c40fdb175'), 'key_1': 'company_name', 'param_1': 1}
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - [cached since 0.01644s ago] {'conversation_id_1': UUID('a7165b82-889b-4907-9504-000c40fdb175'), 'key_1': 'user_email', 'param_1': 1}
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - [cached since 0.01977s ago] {'conversation_id_1': UUID('a7165b82-889b-4907-9504-000c40fdb175'), 'key_1': 'is_new_conversation', 'param_1': 1}
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - [cached since 0.02388s ago] {'conversation_id_1': UUID('a7165b82-889b-4907-9504-000c40fdb175'), 'key_1': 'first_interaction', 'param_1': 1}
2025-05-19 15:15:44 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:15:44 - hydrous - INFO - DBG_SS: Conversación a7165b82-889b-4907-9504-000c40fdb175 actualizada en base de datos.
2025-05-19 15:15:59 - root - INFO - Configuración de logging inicializada
2025-05-19 15:16:40 - root - INFO - Configuración de logging inicializada
2025-05-19 15:16:44 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-05-19 15:16:44 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-05-19 15:16:44 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-05-19 15:16:44 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-05-19 15:16:44 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-05-19 15:16:44 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-05-19 15:16:44 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:16:44 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:16:44 - sqlalchemy.engine.Engine - INFO - [generated in 0.00862s] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 15:16:44 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:16:44 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:16:44 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:16:44 - sqlalchemy.engine.Engine - INFO - [generated in 0.00306s] {'id_1': UUID('a7165b82-889b-4907-9504-000c40fdb175'), 'param_1': 1}
2025-05-19 15:16:44 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE messages.conversation_id = %(conversation_id_1)s::UUID ORDER BY messages.created_at
2025-05-19 15:16:44 - sqlalchemy.engine.Engine - INFO - [generated in 0.00135s] {'conversation_id_1': UUID('a7165b82-889b-4907-9504-000c40fdb175')}
2025-05-19 15:16:44 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID
2025-05-19 15:16:44 - sqlalchemy.engine.Engine - INFO - [generated in 0.00080s] {'conversation_id_1': UUID('a7165b82-889b-4907-9504-000c40fdb175')}
2025-05-19 15:16:44 - hydrous - INFO - DBG_SS: Conversación a7165b82-889b-4907-9504-000c40fdb175 RECUPERADA. Metadata actual: {'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:16:44 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:16:44 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:16:44 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:16:44 - sqlalchemy.engine.Engine - INFO - [cached since 0.1758s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 15:16:44 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:16:44 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:16:44 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:16:44 - sqlalchemy.engine.Engine - INFO - [cached since 0.08116s ago] {'id_1': UUID('a7165b82-889b-4907-9504-000c40fdb175'), 'param_1': 1}
2025-05-19 15:16:44 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE messages.conversation_id = %(conversation_id_1)s::UUID ORDER BY messages.created_at
2025-05-19 15:16:44 - sqlalchemy.engine.Engine - INFO - [cached since 0.05224s ago] {'conversation_id_1': UUID('a7165b82-889b-4907-9504-000c40fdb175')}
2025-05-19 15:16:44 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID
2025-05-19 15:16:44 - sqlalchemy.engine.Engine - INFO - [cached since 0.04847s ago] {'conversation_id_1': UUID('a7165b82-889b-4907-9504-000c40fdb175')}
2025-05-19 15:16:44 - hydrous - INFO - DBG_SS: Conversación a7165b82-889b-4907-9504-000c40fdb175 RECUPERADA. Metadata actual: {'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:16:44 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - [cached since 3.51s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:16:47 - hydrous - INFO - Datos del usuario al iniciar conversación: nombre=Ricardo Altamirano, empresa=hydrous, sector=commercial, subsector=Hotel, ubicación=los mochis, email=hydrous20@gmail.com
2025-05-19 15:16:47 - hydrous - INFO - Metadata inicial de la conversación: {'client_name': 'Ricardo Altamirano', 'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'selected_sector': 'commercial', 'selected_subsector': 'Hotel', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversations (user_id, selected_sector, selected_subsector, current_question_id, is_complete, has_proposal, client_name, proposal_text, pdf_path, id, created_at) VALUES (%(user_id)s::UUID, %(selected_sector)s, %(selected_subsector)s, %(current_question_id)s, %(is_complete)s, %(has_proposal)s, %(client_name)s, %(proposal_text)s, %(pdf_path)s, %(id)s::UUID, %(created_at)s)
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - [generated in 0.00132s] {'user_id': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'selected_sector': 'commercial', 'selected_subsector': 'Hotel', 'current_question_id': None, 'is_complete': False, 'has_proposal': False, 'client_name': 'Ricardo Altamirano', 'proposal_text': None, 'pdf_path': None, 'id': UUID('5b2f0691-8c7e-4fdb-9a38-0ebef7f11ffa'), 'created_at': datetime.datetime(2025, 5, 19, 15, 16, 47, 827515)}
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversation_metadata (conversation_id, key, value, id, created_at) VALUES (%(conversation_id__0)s::UUID, %(key__0)s, %(value__0)s::JSONB, %(id__0)s::UUID, %(created_at__0)s), (%(conversation_id__1)s::UUID, %(key__1)s, %(value__1)s::JSONB ... 543 characters truncated ...  (%(conversation_id__7)s::UUID, %(key__7)s, %(value__7)s::JSONB, %(id__7)s::UUID, %(created_at__7)s)
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - [generated in 0.00040s (insertmanyvalues) 1/1 (unordered)] {'id__0': UUID('66281514-aaa9-419e-b115-cb458dfaa365'), 'value__0': '"Ricardo Altamirano"', 'conversation_id__0': UUID('5b2f0691-8c7e-4fdb-9a38-0ebef7f11ffa'), 'created_at__0': datetime.datetime(2025, 5, 19, 15, 16, 47, 836644), 'key__0': 'user_name', 'id__1': UUID('1d1655a9-4988-4f8c-99f1-1867931004f0'), 'value__1': '"los mochis"', 'conversation_id__1': UUID('5b2f0691-8c7e-4fdb-9a38-0ebef7f11ffa'), 'created_at__1': datetime.datetime(2025, 5, 19, 15, 16, 47, 836649), 'key__1': 'user_location', 'id__2': UUID('6fd3411b-e120-4c0c-9480-2d8a6e5b439a'), 'value__2': '"commercial"', 'conversation_id__2': UUID('5b2f0691-8c7e-4fdb-9a38-0ebef7f11ffa'), 'created_at__2': datetime.datetime(2025, 5, 19, 15, 16, 47, 836650), 'key__2': 'sector', 'id__3': UUID('8fef13e4-8003-475c-a91b-965bdc39d971'), 'value__3': '"Hotel"', 'conversation_id__3': UUID('5b2f0691-8c7e-4fdb-9a38-0ebef7f11ffa'), 'created_at__3': datetime.datetime(2025, 5, 19, 15, 16, 47, 836652), 'key__3': 'subsector', 'id__4': UUID('b53f6a46-3f4c-4747-ba7e-0a3e863f80cd'), 'value__4': '"hydrous"', 'conversation_id__4': UUID('5b2f0691-8c7e-4fdb-9a38-0ebef7f11ffa'), 'created_at__4': datetime.datetime(2025, 5, 19, 15, 16, 47, 836653), 'key__4': 'company_name', 'id__5': UUID('384558c7-3973-4012-adec-db58a682a96d'), 'value__5': '"hydrous20@gmail.com"', 'conversation_id__5': UUID('5b2f0691-8c7e-4fdb-9a38-0ebef7f11ffa'), 'created_at__5': datetime.datetime(2025, 5, 19, 15, 16, 47, 836655), 'key__5': 'user_email', 'id__6': UUID('fa838046-d681-4e1f-9169-a080c743ec73'), 'value__6': 'true', 'conversation_id__6': UUID('5b2f0691-8c7e-4fdb-9a38-0ebef7f11ffa'), 'created_at__6': datetime.datetime(2025, 5, 19, 15, 16, 47, 836657), 'key__6': 'is_new_conversation', 'id__7': UUID('8fa65c75-552c-438d-88af-266777c30653'), 'value__7': 'true', 'conversation_id__7': UUID('5b2f0691-8c7e-4fdb-9a38-0ebef7f11ffa'), 'created_at__7': datetime.datetime(2025, 5, 19, 15, 16, 47, 836658), 'key__7': 'first_interaction'}
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - [generated in 0.00205s] {'pk_1': UUID('5b2f0691-8c7e-4fdb-9a38-0ebef7f11ffa')}
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - [cached since 3.469s ago] {'id_1': UUID('5b2f0691-8c7e-4fdb-9a38-0ebef7f11ffa'), 'param_1': 1}
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - [cached since 0.007697s ago] {'pk_1': UUID('5b2f0691-8c7e-4fdb-9a38-0ebef7f11ffa')}
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - [generated in 0.00047s] {'conversation_id_1': UUID('5b2f0691-8c7e-4fdb-9a38-0ebef7f11ffa'), 'key_1': 'user_name', 'param_1': 1}
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - [cached since 0.01055s ago] {'conversation_id_1': UUID('5b2f0691-8c7e-4fdb-9a38-0ebef7f11ffa'), 'key_1': 'user_location', 'param_1': 1}
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - [cached since 0.01829s ago] {'conversation_id_1': UUID('5b2f0691-8c7e-4fdb-9a38-0ebef7f11ffa'), 'key_1': 'sector', 'param_1': 1}
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - [cached since 0.02225s ago] {'conversation_id_1': UUID('5b2f0691-8c7e-4fdb-9a38-0ebef7f11ffa'), 'key_1': 'subsector', 'param_1': 1}
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - [cached since 0.02627s ago] {'conversation_id_1': UUID('5b2f0691-8c7e-4fdb-9a38-0ebef7f11ffa'), 'key_1': 'company_name', 'param_1': 1}
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - [cached since 0.02982s ago] {'conversation_id_1': UUID('5b2f0691-8c7e-4fdb-9a38-0ebef7f11ffa'), 'key_1': 'user_email', 'param_1': 1}
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - [cached since 0.03398s ago] {'conversation_id_1': UUID('5b2f0691-8c7e-4fdb-9a38-0ebef7f11ffa'), 'key_1': 'is_new_conversation', 'param_1': 1}
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - [cached since 0.03749s ago] {'conversation_id_1': UUID('5b2f0691-8c7e-4fdb-9a38-0ebef7f11ffa'), 'key_1': 'first_interaction', 'param_1': 1}
2025-05-19 15:16:47 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:16:47 - hydrous - INFO - DBG_SS: Conversación 5b2f0691-8c7e-4fdb-9a38-0ebef7f11ffa actualizada en base de datos.
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - [cached since 9.776s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:16:54 - hydrous - INFO - Datos del usuario al iniciar conversación: nombre=Ricardo Altamirano, empresa=hydrous, sector=commercial, subsector=Hotel, ubicación=los mochis, email=hydrous20@gmail.com
2025-05-19 15:16:54 - hydrous - INFO - Metadata inicial de la conversación: {'client_name': 'Ricardo Altamirano', 'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'selected_sector': 'commercial', 'selected_subsector': 'Hotel', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversations (user_id, selected_sector, selected_subsector, current_question_id, is_complete, has_proposal, client_name, proposal_text, pdf_path, id, created_at) VALUES (%(user_id)s::UUID, %(selected_sector)s, %(selected_subsector)s, %(current_question_id)s, %(is_complete)s, %(has_proposal)s, %(client_name)s, %(proposal_text)s, %(pdf_path)s, %(id)s::UUID, %(created_at)s)
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - [cached since 6.252s ago] {'user_id': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'selected_sector': 'commercial', 'selected_subsector': 'Hotel', 'current_question_id': None, 'is_complete': False, 'has_proposal': False, 'client_name': 'Ricardo Altamirano', 'proposal_text': None, 'pdf_path': None, 'id': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8'), 'created_at': datetime.datetime(2025, 5, 19, 15, 16, 54, 77917)}
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversation_metadata (conversation_id, key, value, id, created_at) VALUES (%(conversation_id__0)s::UUID, %(key__0)s, %(value__0)s::JSONB, %(id__0)s::UUID, %(created_at__0)s), (%(conversation_id__1)s::UUID, %(key__1)s, %(value__1)s::JSONB ... 543 characters truncated ...  (%(conversation_id__7)s::UUID, %(key__7)s, %(value__7)s::JSONB, %(id__7)s::UUID, %(created_at__7)s)
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - [cached since 6.247s ago (insertmanyvalues) 1/1 (unordered)] {'id__0': UUID('33179638-ed70-47dc-854f-1b286547af56'), 'value__0': '"Ricardo Altamirano"', 'conversation_id__0': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8'), 'created_at__0': datetime.datetime(2025, 5, 19, 15, 16, 54, 83225), 'key__0': 'user_name', 'id__1': UUID('c5b34425-4c01-4f1c-b143-eaa5548b587f'), 'value__1': '"los mochis"', 'conversation_id__1': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8'), 'created_at__1': datetime.datetime(2025, 5, 19, 15, 16, 54, 83244), 'key__1': 'user_location', 'id__2': UUID('2eaccc6a-a768-4090-b10c-f59b1719735c'), 'value__2': '"commercial"', 'conversation_id__2': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8'), 'created_at__2': datetime.datetime(2025, 5, 19, 15, 16, 54, 83246), 'key__2': 'sector', 'id__3': UUID('74895287-de2e-4007-a4d4-34d9c98e38d2'), 'value__3': '"Hotel"', 'conversation_id__3': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8'), 'created_at__3': datetime.datetime(2025, 5, 19, 15, 16, 54, 83248), 'key__3': 'subsector', 'id__4': UUID('c465ee87-a0cc-49c9-b046-12ca773c9acc'), 'value__4': '"hydrous"', 'conversation_id__4': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8'), 'created_at__4': datetime.datetime(2025, 5, 19, 15, 16, 54, 83249), 'key__4': 'company_name', 'id__5': UUID('86a6dbf7-3817-483e-8f57-a86ef3faad02'), 'value__5': '"hydrous20@gmail.com"', 'conversation_id__5': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8'), 'created_at__5': datetime.datetime(2025, 5, 19, 15, 16, 54, 83250), 'key__5': 'user_email', 'id__6': UUID('67298f1e-0626-40ba-8466-27433d9fe0d5'), 'value__6': 'true', 'conversation_id__6': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8'), 'created_at__6': datetime.datetime(2025, 5, 19, 15, 16, 54, 83252), 'key__6': 'is_new_conversation', 'id__7': UUID('87a4a920-e7f8-4369-8838-fbc9b75ec03c'), 'value__7': 'true', 'conversation_id__7': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8'), 'created_at__7': datetime.datetime(2025, 5, 19, 15, 16, 54, 83253), 'key__7': 'first_interaction'}
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - [cached since 6.244s ago] {'pk_1': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8')}
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - [cached since 9.711s ago] {'id_1': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8'), 'param_1': 1}
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - [cached since 6.25s ago] {'pk_1': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8')}
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - [cached since 6.241s ago] {'conversation_id_1': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8'), 'key_1': 'user_name', 'param_1': 1}
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - [cached since 6.243s ago] {'conversation_id_1': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8'), 'key_1': 'user_location', 'param_1': 1}
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - [cached since 6.246s ago] {'conversation_id_1': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8'), 'key_1': 'sector', 'param_1': 1}
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - [cached since 6.25s ago] {'conversation_id_1': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8'), 'key_1': 'subsector', 'param_1': 1}
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - [cached since 6.254s ago] {'conversation_id_1': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8'), 'key_1': 'company_name', 'param_1': 1}
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - [cached since 6.258s ago] {'conversation_id_1': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8'), 'key_1': 'user_email', 'param_1': 1}
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - [cached since 6.261s ago] {'conversation_id_1': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8'), 'key_1': 'is_new_conversation', 'param_1': 1}
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - [cached since 6.264s ago] {'conversation_id_1': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8'), 'key_1': 'first_interaction', 'param_1': 1}
2025-05-19 15:16:54 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:16:54 - hydrous - INFO - DBG_SS: Conversación 0acb463a-5ce9-499b-95a0-b602775a6bf8 actualizada en base de datos.
2025-05-19 15:16:59 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:16:59 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:16:59 - sqlalchemy.engine.Engine - INFO - [cached since 14.92s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 15:16:59 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:16:59 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:16:59 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:16:59 - sqlalchemy.engine.Engine - INFO - [cached since 14.83s ago] {'id_1': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8'), 'param_1': 1}
2025-05-19 15:16:59 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE messages.conversation_id = %(conversation_id_1)s::UUID ORDER BY messages.created_at
2025-05-19 15:16:59 - sqlalchemy.engine.Engine - INFO - [cached since 14.8s ago] {'conversation_id_1': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8')}
2025-05-19 15:16:59 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID
2025-05-19 15:16:59 - sqlalchemy.engine.Engine - INFO - [cached since 14.8s ago] {'conversation_id_1': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8')}
2025-05-19 15:16:59 - hydrous - INFO - DBG_SS: Conversación 0acb463a-5ce9-499b-95a0-b602775a6bf8 RECUPERADA. Metadata actual: {'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:16:59 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:16:59 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:16:59 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:16:59 - sqlalchemy.engine.Engine - INFO - [cached since 14.95s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 15:16:59 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:16:59 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:16:59 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:16:59 - sqlalchemy.engine.Engine - INFO - [cached since 14.85s ago] {'id_1': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8'), 'param_1': 1}
2025-05-19 15:16:59 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE messages.conversation_id = %(conversation_id_1)s::UUID ORDER BY messages.created_at
2025-05-19 15:16:59 - sqlalchemy.engine.Engine - INFO - [cached since 14.83s ago] {'conversation_id_1': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8')}
2025-05-19 15:16:59 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID
2025-05-19 15:16:59 - sqlalchemy.engine.Engine - INFO - [cached since 14.82s ago] {'conversation_id_1': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8')}
2025-05-19 15:16:59 - hydrous - INFO - DBG_SS: Conversación 0acb463a-5ce9-499b-95a0-b602775a6bf8 RECUPERADA. Metadata actual: {'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:16:59 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:17:20 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:17:20 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:17:20 - sqlalchemy.engine.Engine - INFO - [cached since 35.86s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 15:17:20 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:17:20 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:17:20 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:17:20 - sqlalchemy.engine.Engine - INFO - [cached since 35.79s ago] {'id_1': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8'), 'param_1': 1}
2025-05-19 15:17:20 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE messages.conversation_id = %(conversation_id_1)s::UUID ORDER BY messages.created_at
2025-05-19 15:17:20 - sqlalchemy.engine.Engine - INFO - [cached since 35.76s ago] {'conversation_id_1': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8')}
2025-05-19 15:17:20 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID
2025-05-19 15:17:20 - sqlalchemy.engine.Engine - INFO - [cached since 35.76s ago] {'conversation_id_1': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8')}
2025-05-19 15:17:20 - hydrous - INFO - DBG_SS: Conversación 0acb463a-5ce9-499b-95a0-b602775a6bf8 RECUPERADA. Metadata actual: {'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:17:20 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:17:20 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:17:20 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:17:20 - sqlalchemy.engine.Engine - INFO - [cached since 35.93s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 15:17:20 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:17:20 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:17:20 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:17:20 - sqlalchemy.engine.Engine - INFO - [cached since 35.84s ago] {'id_1': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8'), 'param_1': 1}
2025-05-19 15:17:20 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE messages.conversation_id = %(conversation_id_1)s::UUID ORDER BY messages.created_at
2025-05-19 15:17:20 - sqlalchemy.engine.Engine - INFO - [cached since 35.81s ago] {'conversation_id_1': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8')}
2025-05-19 15:17:20 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID
2025-05-19 15:17:20 - sqlalchemy.engine.Engine - INFO - [cached since 35.81s ago] {'conversation_id_1': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8')}
2025-05-19 15:17:20 - hydrous - INFO - DBG_SS: Conversación 0acb463a-5ce9-499b-95a0-b602775a6bf8 RECUPERADA. Metadata actual: {'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:17:20 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:21:58 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:21:58 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:21:58 - sqlalchemy.engine.Engine - INFO - [cached since 314.4s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 15:21:59 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:21:59 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:21:59 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:21:59 - sqlalchemy.engine.Engine - INFO - [cached since 315s ago] {'id_1': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8'), 'param_1': 1}
2025-05-19 15:21:59 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE messages.conversation_id = %(conversation_id_1)s::UUID ORDER BY messages.created_at
2025-05-19 15:21:59 - sqlalchemy.engine.Engine - INFO - [cached since 315s ago] {'conversation_id_1': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8')}
2025-05-19 15:21:59 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID
2025-05-19 15:21:59 - sqlalchemy.engine.Engine - INFO - [cached since 315s ago] {'conversation_id_1': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8')}
2025-05-19 15:21:59 - hydrous - INFO - DBG_SS: Conversación 0acb463a-5ce9-499b-95a0-b602775a6bf8 RECUPERADA. Metadata actual: {'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:21:59 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:21:59 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:21:59 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:21:59 - sqlalchemy.engine.Engine - INFO - [cached since 315.2s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 15:21:59 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:21:59 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:21:59 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:21:59 - sqlalchemy.engine.Engine - INFO - [cached since 315.1s ago] {'id_1': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8'), 'param_1': 1}
2025-05-19 15:21:59 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE messages.conversation_id = %(conversation_id_1)s::UUID ORDER BY messages.created_at
2025-05-19 15:21:59 - sqlalchemy.engine.Engine - INFO - [cached since 315.1s ago] {'conversation_id_1': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8')}
2025-05-19 15:21:59 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID
2025-05-19 15:21:59 - sqlalchemy.engine.Engine - INFO - [cached since 315.1s ago] {'conversation_id_1': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8')}
2025-05-19 15:21:59 - hydrous - INFO - DBG_SS: Conversación 0acb463a-5ce9-499b-95a0-b602775a6bf8 RECUPERADA. Metadata actual: {'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:21:59 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:30:18 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:30:18 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:30:18 - sqlalchemy.engine.Engine - INFO - [cached since 814.4s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 15:30:18 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:30:18 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:30:18 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:30:18 - sqlalchemy.engine.Engine - INFO - [cached since 814.4s ago] {'id_1': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8'), 'param_1': 1}
2025-05-19 15:30:18 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE messages.conversation_id = %(conversation_id_1)s::UUID ORDER BY messages.created_at
2025-05-19 15:30:18 - sqlalchemy.engine.Engine - INFO - [cached since 814.3s ago] {'conversation_id_1': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8')}
2025-05-19 15:30:18 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID
2025-05-19 15:30:18 - sqlalchemy.engine.Engine - INFO - [cached since 814.3s ago] {'conversation_id_1': UUID('0acb463a-5ce9-499b-95a0-b602775a6bf8')}
2025-05-19 15:30:18 - hydrous - INFO - DBG_SS: Conversación 0acb463a-5ce9-499b-95a0-b602775a6bf8 RECUPERADA. Metadata actual: {'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:30:18 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:30:20 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:30:20 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:30:20 - sqlalchemy.engine.Engine - INFO - [cached since 816.6s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 15:30:20 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:30:20 - hydrous - INFO - Datos del usuario al iniciar conversación: nombre=Ricardo Altamirano, empresa=hydrous, sector=commercial, subsector=Hotel, ubicación=los mochis, email=hydrous20@gmail.com
2025-05-19 15:30:20 - hydrous - INFO - Metadata inicial de la conversación: {'client_name': 'Ricardo Altamirano', 'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'selected_sector': 'commercial', 'selected_subsector': 'Hotel', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:30:20 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:30:20 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversations (user_id, selected_sector, selected_subsector, current_question_id, is_complete, has_proposal, client_name, proposal_text, pdf_path, id, created_at) VALUES (%(user_id)s::UUID, %(selected_sector)s, %(selected_subsector)s, %(current_question_id)s, %(is_complete)s, %(has_proposal)s, %(client_name)s, %(proposal_text)s, %(pdf_path)s, %(id)s::UUID, %(created_at)s)
2025-05-19 15:30:20 - sqlalchemy.engine.Engine - INFO - [cached since 813.1s ago] {'user_id': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'selected_sector': 'commercial', 'selected_subsector': 'Hotel', 'current_question_id': None, 'is_complete': False, 'has_proposal': False, 'client_name': 'Ricardo Altamirano', 'proposal_text': None, 'pdf_path': None, 'id': UUID('e3fdae4c-5c8c-44ec-ae27-ce17c2f59fbb'), 'created_at': datetime.datetime(2025, 5, 19, 15, 30, 20, 949066)}
2025-05-19 15:30:20 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversation_metadata (conversation_id, key, value, id, created_at) VALUES (%(conversation_id__0)s::UUID, %(key__0)s, %(value__0)s::JSONB, %(id__0)s::UUID, %(created_at__0)s), (%(conversation_id__1)s::UUID, %(key__1)s, %(value__1)s::JSONB ... 543 characters truncated ...  (%(conversation_id__7)s::UUID, %(key__7)s, %(value__7)s::JSONB, %(id__7)s::UUID, %(created_at__7)s)
2025-05-19 15:30:20 - sqlalchemy.engine.Engine - INFO - [cached since 813.1s ago (insertmanyvalues) 1/1 (unordered)] {'id__0': UUID('a1c621dd-c3c2-42f1-80b7-1437187ad78b'), 'value__0': '"Ricardo Altamirano"', 'conversation_id__0': UUID('e3fdae4c-5c8c-44ec-ae27-ce17c2f59fbb'), 'created_at__0': datetime.datetime(2025, 5, 19, 15, 30, 20, 970335), 'key__0': 'user_name', 'id__1': UUID('23d65636-9916-4d2a-9575-4841e23bd8b2'), 'value__1': '"los mochis"', 'conversation_id__1': UUID('e3fdae4c-5c8c-44ec-ae27-ce17c2f59fbb'), 'created_at__1': datetime.datetime(2025, 5, 19, 15, 30, 20, 970341), 'key__1': 'user_location', 'id__2': UUID('04c8d408-b7f8-4b9f-bcc4-576389520ee4'), 'value__2': '"commercial"', 'conversation_id__2': UUID('e3fdae4c-5c8c-44ec-ae27-ce17c2f59fbb'), 'created_at__2': datetime.datetime(2025, 5, 19, 15, 30, 20, 970343), 'key__2': 'sector', 'id__3': UUID('e542be60-4128-4aa3-b599-7e7c61584fab'), 'value__3': '"Hotel"', 'conversation_id__3': UUID('e3fdae4c-5c8c-44ec-ae27-ce17c2f59fbb'), 'created_at__3': datetime.datetime(2025, 5, 19, 15, 30, 20, 970345), 'key__3': 'subsector', 'id__4': UUID('f78e474c-3c27-4178-a6ea-0e4c5e78cabe'), 'value__4': '"hydrous"', 'conversation_id__4': UUID('e3fdae4c-5c8c-44ec-ae27-ce17c2f59fbb'), 'created_at__4': datetime.datetime(2025, 5, 19, 15, 30, 20, 970347), 'key__4': 'company_name', 'id__5': UUID('e67dc517-d12f-4d55-a5e6-b58d10bae842'), 'value__5': '"hydrous20@gmail.com"', 'conversation_id__5': UUID('e3fdae4c-5c8c-44ec-ae27-ce17c2f59fbb'), 'created_at__5': datetime.datetime(2025, 5, 19, 15, 30, 20, 970355), 'key__5': 'user_email', 'id__6': UUID('3a4fe6ca-6bba-4a91-a523-3b0e26d4e5bd'), 'value__6': 'true', 'conversation_id__6': UUID('e3fdae4c-5c8c-44ec-ae27-ce17c2f59fbb'), 'created_at__6': datetime.datetime(2025, 5, 19, 15, 30, 20, 970359), 'key__6': 'is_new_conversation', 'id__7': UUID('af4cea70-2b67-48d1-82d0-31969f5ae804'), 'value__7': 'true', 'conversation_id__7': UUID('e3fdae4c-5c8c-44ec-ae27-ce17c2f59fbb'), 'created_at__7': datetime.datetime(2025, 5, 19, 15, 30, 20, 970360), 'key__7': 'first_interaction'}
2025-05-19 15:30:20 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - [cached since 813.2s ago] {'pk_1': UUID('e3fdae4c-5c8c-44ec-ae27-ce17c2f59fbb')}
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - [cached since 816.6s ago] {'id_1': UUID('e3fdae4c-5c8c-44ec-ae27-ce17c2f59fbb'), 'param_1': 1}
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - [cached since 813.2s ago] {'pk_1': UUID('e3fdae4c-5c8c-44ec-ae27-ce17c2f59fbb')}
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - [cached since 813.2s ago] {'conversation_id_1': UUID('e3fdae4c-5c8c-44ec-ae27-ce17c2f59fbb'), 'key_1': 'user_name', 'param_1': 1}
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - [cached since 813.2s ago] {'conversation_id_1': UUID('e3fdae4c-5c8c-44ec-ae27-ce17c2f59fbb'), 'key_1': 'user_location', 'param_1': 1}
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - [cached since 813.2s ago] {'conversation_id_1': UUID('e3fdae4c-5c8c-44ec-ae27-ce17c2f59fbb'), 'key_1': 'sector', 'param_1': 1}
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - [cached since 813.2s ago] {'conversation_id_1': UUID('e3fdae4c-5c8c-44ec-ae27-ce17c2f59fbb'), 'key_1': 'subsector', 'param_1': 1}
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - [cached since 813.2s ago] {'conversation_id_1': UUID('e3fdae4c-5c8c-44ec-ae27-ce17c2f59fbb'), 'key_1': 'company_name', 'param_1': 1}
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - [cached since 813.2s ago] {'conversation_id_1': UUID('e3fdae4c-5c8c-44ec-ae27-ce17c2f59fbb'), 'key_1': 'user_email', 'param_1': 1}
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - [cached since 813.2s ago] {'conversation_id_1': UUID('e3fdae4c-5c8c-44ec-ae27-ce17c2f59fbb'), 'key_1': 'is_new_conversation', 'param_1': 1}
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - [cached since 813.2s ago] {'conversation_id_1': UUID('e3fdae4c-5c8c-44ec-ae27-ce17c2f59fbb'), 'key_1': 'first_interaction', 'param_1': 1}
2025-05-19 15:30:21 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:30:21 - hydrous - INFO - DBG_SS: Conversación e3fdae4c-5c8c-44ec-ae27-ce17c2f59fbb actualizada en base de datos.
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - [cached since 819.1s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:30:23 - hydrous - INFO - Datos del usuario al iniciar conversación: nombre=Ricardo Altamirano, empresa=hydrous, sector=commercial, subsector=Hotel, ubicación=los mochis, email=hydrous20@gmail.com
2025-05-19 15:30:23 - hydrous - INFO - Metadata inicial de la conversación: {'client_name': 'Ricardo Altamirano', 'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'selected_sector': 'commercial', 'selected_subsector': 'Hotel', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversations (user_id, selected_sector, selected_subsector, current_question_id, is_complete, has_proposal, client_name, proposal_text, pdf_path, id, created_at) VALUES (%(user_id)s::UUID, %(selected_sector)s, %(selected_subsector)s, %(current_question_id)s, %(is_complete)s, %(has_proposal)s, %(client_name)s, %(proposal_text)s, %(pdf_path)s, %(id)s::UUID, %(created_at)s)
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - [cached since 815.6s ago] {'user_id': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'selected_sector': 'commercial', 'selected_subsector': 'Hotel', 'current_question_id': None, 'is_complete': False, 'has_proposal': False, 'client_name': 'Ricardo Altamirano', 'proposal_text': None, 'pdf_path': None, 'id': UUID('ad4dce48-54fe-4c81-a1e5-8d0c9b39ae88'), 'created_at': datetime.datetime(2025, 5, 19, 15, 30, 23, 403633)}
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversation_metadata (conversation_id, key, value, id, created_at) VALUES (%(conversation_id__0)s::UUID, %(key__0)s, %(value__0)s::JSONB, %(id__0)s::UUID, %(created_at__0)s), (%(conversation_id__1)s::UUID, %(key__1)s, %(value__1)s::JSONB ... 543 characters truncated ...  (%(conversation_id__7)s::UUID, %(key__7)s, %(value__7)s::JSONB, %(id__7)s::UUID, %(created_at__7)s)
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - [cached since 815.6s ago (insertmanyvalues) 1/1 (unordered)] {'id__0': UUID('e2c7b8d4-9a9c-4ce2-aac6-1c76773ee5c1'), 'value__0': '"Ricardo Altamirano"', 'conversation_id__0': UUID('ad4dce48-54fe-4c81-a1e5-8d0c9b39ae88'), 'created_at__0': datetime.datetime(2025, 5, 19, 15, 30, 23, 410765), 'key__0': 'user_name', 'id__1': UUID('1ca1dbf3-7051-492c-9ff0-c92725b53e27'), 'value__1': '"los mochis"', 'conversation_id__1': UUID('ad4dce48-54fe-4c81-a1e5-8d0c9b39ae88'), 'created_at__1': datetime.datetime(2025, 5, 19, 15, 30, 23, 410771), 'key__1': 'user_location', 'id__2': UUID('3aa68ec8-8a97-430a-820f-7e0ba0e7ce45'), 'value__2': '"commercial"', 'conversation_id__2': UUID('ad4dce48-54fe-4c81-a1e5-8d0c9b39ae88'), 'created_at__2': datetime.datetime(2025, 5, 19, 15, 30, 23, 410773), 'key__2': 'sector', 'id__3': UUID('75f97602-9f7d-4455-bfd6-f48ec75f53ce'), 'value__3': '"Hotel"', 'conversation_id__3': UUID('ad4dce48-54fe-4c81-a1e5-8d0c9b39ae88'), 'created_at__3': datetime.datetime(2025, 5, 19, 15, 30, 23, 410774), 'key__3': 'subsector', 'id__4': UUID('f051bfd6-f420-4c42-80c2-f1d65c50b35b'), 'value__4': '"hydrous"', 'conversation_id__4': UUID('ad4dce48-54fe-4c81-a1e5-8d0c9b39ae88'), 'created_at__4': datetime.datetime(2025, 5, 19, 15, 30, 23, 410777), 'key__4': 'company_name', 'id__5': UUID('3d241d73-e3c3-4ac1-be59-f696ff19ecc3'), 'value__5': '"hydrous20@gmail.com"', 'conversation_id__5': UUID('ad4dce48-54fe-4c81-a1e5-8d0c9b39ae88'), 'created_at__5': datetime.datetime(2025, 5, 19, 15, 30, 23, 410778), 'key__5': 'user_email', 'id__6': UUID('b7403493-4f38-4304-9100-c4fb6d8c231b'), 'value__6': 'true', 'conversation_id__6': UUID('ad4dce48-54fe-4c81-a1e5-8d0c9b39ae88'), 'created_at__6': datetime.datetime(2025, 5, 19, 15, 30, 23, 410780), 'key__6': 'is_new_conversation', 'id__7': UUID('96cca96c-dd08-4e6e-b76e-59a4a671c52b'), 'value__7': 'true', 'conversation_id__7': UUID('ad4dce48-54fe-4c81-a1e5-8d0c9b39ae88'), 'created_at__7': datetime.datetime(2025, 5, 19, 15, 30, 23, 410781), 'key__7': 'first_interaction'}
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - [cached since 815.6s ago] {'pk_1': UUID('ad4dce48-54fe-4c81-a1e5-8d0c9b39ae88')}
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - [cached since 819.1s ago] {'id_1': UUID('ad4dce48-54fe-4c81-a1e5-8d0c9b39ae88'), 'param_1': 1}
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - [cached since 815.6s ago] {'pk_1': UUID('ad4dce48-54fe-4c81-a1e5-8d0c9b39ae88')}
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - [cached since 815.6s ago] {'conversation_id_1': UUID('ad4dce48-54fe-4c81-a1e5-8d0c9b39ae88'), 'key_1': 'user_name', 'param_1': 1}
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - [cached since 815.6s ago] {'conversation_id_1': UUID('ad4dce48-54fe-4c81-a1e5-8d0c9b39ae88'), 'key_1': 'user_location', 'param_1': 1}
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - [cached since 815.6s ago] {'conversation_id_1': UUID('ad4dce48-54fe-4c81-a1e5-8d0c9b39ae88'), 'key_1': 'sector', 'param_1': 1}
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - [cached since 815.6s ago] {'conversation_id_1': UUID('ad4dce48-54fe-4c81-a1e5-8d0c9b39ae88'), 'key_1': 'subsector', 'param_1': 1}
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - [cached since 815.6s ago] {'conversation_id_1': UUID('ad4dce48-54fe-4c81-a1e5-8d0c9b39ae88'), 'key_1': 'company_name', 'param_1': 1}
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - [cached since 815.6s ago] {'conversation_id_1': UUID('ad4dce48-54fe-4c81-a1e5-8d0c9b39ae88'), 'key_1': 'user_email', 'param_1': 1}
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - [cached since 815.6s ago] {'conversation_id_1': UUID('ad4dce48-54fe-4c81-a1e5-8d0c9b39ae88'), 'key_1': 'is_new_conversation', 'param_1': 1}
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - [cached since 815.6s ago] {'conversation_id_1': UUID('ad4dce48-54fe-4c81-a1e5-8d0c9b39ae88'), 'key_1': 'first_interaction', 'param_1': 1}
2025-05-19 15:30:23 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:30:23 - hydrous - INFO - DBG_SS: Conversación ad4dce48-54fe-4c81-a1e5-8d0c9b39ae88 actualizada en base de datos.
2025-05-19 15:30:27 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:30:27 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:30:27 - sqlalchemy.engine.Engine - INFO - [cached since 822.7s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 15:30:27 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:30:27 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:30:27 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:30:27 - sqlalchemy.engine.Engine - INFO - [cached since 822.7s ago] {'id_1': UUID('ad4dce48-54fe-4c81-a1e5-8d0c9b39ae88'), 'param_1': 1}
2025-05-19 15:30:27 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE messages.conversation_id = %(conversation_id_1)s::UUID ORDER BY messages.created_at
2025-05-19 15:30:27 - sqlalchemy.engine.Engine - INFO - [cached since 822.6s ago] {'conversation_id_1': UUID('ad4dce48-54fe-4c81-a1e5-8d0c9b39ae88')}
2025-05-19 15:30:27 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID
2025-05-19 15:30:27 - sqlalchemy.engine.Engine - INFO - [cached since 822.6s ago] {'conversation_id_1': UUID('ad4dce48-54fe-4c81-a1e5-8d0c9b39ae88')}
2025-05-19 15:30:27 - hydrous - INFO - DBG_SS: Conversación ad4dce48-54fe-4c81-a1e5-8d0c9b39ae88 RECUPERADA. Metadata actual: {'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:30:27 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:41:50 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:41:50 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:41:50 - sqlalchemy.engine.Engine - INFO - [cached since 1506s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 15:41:50 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:41:51 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:41:51 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:41:51 - sqlalchemy.engine.Engine - INFO - [cached since 1507s ago] {'id_1': UUID('ad4dce48-54fe-4c81-a1e5-8d0c9b39ae88'), 'param_1': 1}
2025-05-19 15:41:51 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE messages.conversation_id = %(conversation_id_1)s::UUID ORDER BY messages.created_at
2025-05-19 15:41:51 - sqlalchemy.engine.Engine - INFO - [cached since 1507s ago] {'conversation_id_1': UUID('ad4dce48-54fe-4c81-a1e5-8d0c9b39ae88')}
2025-05-19 15:41:51 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID
2025-05-19 15:41:51 - sqlalchemy.engine.Engine - INFO - [cached since 1507s ago] {'conversation_id_1': UUID('ad4dce48-54fe-4c81-a1e5-8d0c9b39ae88')}
2025-05-19 15:41:51 - hydrous - INFO - DBG_SS: Conversación ad4dce48-54fe-4c81-a1e5-8d0c9b39ae88 RECUPERADA. Metadata actual: {'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:41:51 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:41:54 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:41:55 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:41:55 - sqlalchemy.engine.Engine - INFO - [cached since 1511s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 15:41:55 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:41:55 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:41:55 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:41:55 - sqlalchemy.engine.Engine - INFO - [cached since 1511s ago] {'id_1': UUID('ad4dce48-54fe-4c81-a1e5-8d0c9b39ae88'), 'param_1': 1}
2025-05-19 15:41:55 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE messages.conversation_id = %(conversation_id_1)s::UUID ORDER BY messages.created_at
2025-05-19 15:41:55 - sqlalchemy.engine.Engine - INFO - [cached since 1511s ago] {'conversation_id_1': UUID('ad4dce48-54fe-4c81-a1e5-8d0c9b39ae88')}
2025-05-19 15:41:55 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID
2025-05-19 15:41:55 - sqlalchemy.engine.Engine - INFO - [cached since 1511s ago] {'conversation_id_1': UUID('ad4dce48-54fe-4c81-a1e5-8d0c9b39ae88')}
2025-05-19 15:41:55 - hydrous - INFO - DBG_SS: Conversación ad4dce48-54fe-4c81-a1e5-8d0c9b39ae88 RECUPERADA. Metadata actual: {'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:41:55 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - [cached since 1513s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:41:57 - hydrous - INFO - Datos del usuario al iniciar conversación: nombre=Ricardo Altamirano, empresa=hydrous, sector=commercial, subsector=Hotel, ubicación=los mochis, email=hydrous20@gmail.com
2025-05-19 15:41:57 - hydrous - INFO - Metadata inicial de la conversación: {'client_name': 'Ricardo Altamirano', 'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'selected_sector': 'commercial', 'selected_subsector': 'Hotel', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversations (user_id, selected_sector, selected_subsector, current_question_id, is_complete, has_proposal, client_name, proposal_text, pdf_path, id, created_at) VALUES (%(user_id)s::UUID, %(selected_sector)s, %(selected_subsector)s, %(current_question_id)s, %(is_complete)s, %(has_proposal)s, %(client_name)s, %(proposal_text)s, %(pdf_path)s, %(id)s::UUID, %(created_at)s)
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - [cached since 1510s ago] {'user_id': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'selected_sector': 'commercial', 'selected_subsector': 'Hotel', 'current_question_id': None, 'is_complete': False, 'has_proposal': False, 'client_name': 'Ricardo Altamirano', 'proposal_text': None, 'pdf_path': None, 'id': UUID('95e9e6a5-0503-416f-bd0a-27518d4dc775'), 'created_at': datetime.datetime(2025, 5, 19, 15, 41, 57, 487534)}
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversation_metadata (conversation_id, key, value, id, created_at) VALUES (%(conversation_id__0)s::UUID, %(key__0)s, %(value__0)s::JSONB, %(id__0)s::UUID, %(created_at__0)s), (%(conversation_id__1)s::UUID, %(key__1)s, %(value__1)s::JSONB ... 543 characters truncated ...  (%(conversation_id__7)s::UUID, %(key__7)s, %(value__7)s::JSONB, %(id__7)s::UUID, %(created_at__7)s)
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - [cached since 1510s ago (insertmanyvalues) 1/1 (unordered)] {'id__0': UUID('cdcfc721-ee8d-4e37-9446-191dcc400498'), 'value__0': '"Ricardo Altamirano"', 'conversation_id__0': UUID('95e9e6a5-0503-416f-bd0a-27518d4dc775'), 'created_at__0': datetime.datetime(2025, 5, 19, 15, 41, 57, 494965), 'key__0': 'user_name', 'id__1': UUID('877c465a-3cec-4828-af05-298b4ffc1620'), 'value__1': '"los mochis"', 'conversation_id__1': UUID('95e9e6a5-0503-416f-bd0a-27518d4dc775'), 'created_at__1': datetime.datetime(2025, 5, 19, 15, 41, 57, 494972), 'key__1': 'user_location', 'id__2': UUID('7c61cd0c-3830-46db-a4c3-d095b0fea3b7'), 'value__2': '"commercial"', 'conversation_id__2': UUID('95e9e6a5-0503-416f-bd0a-27518d4dc775'), 'created_at__2': datetime.datetime(2025, 5, 19, 15, 41, 57, 494973), 'key__2': 'sector', 'id__3': UUID('f9c32a34-946f-47d7-8b7a-d40652224e79'), 'value__3': '"Hotel"', 'conversation_id__3': UUID('95e9e6a5-0503-416f-bd0a-27518d4dc775'), 'created_at__3': datetime.datetime(2025, 5, 19, 15, 41, 57, 494975), 'key__3': 'subsector', 'id__4': UUID('042482ea-3c5f-4433-8ba8-c185cea94bcd'), 'value__4': '"hydrous"', 'conversation_id__4': UUID('95e9e6a5-0503-416f-bd0a-27518d4dc775'), 'created_at__4': datetime.datetime(2025, 5, 19, 15, 41, 57, 494978), 'key__4': 'company_name', 'id__5': UUID('298ef7c4-e6b3-4ceb-a570-b9b602ee1555'), 'value__5': '"hydrous20@gmail.com"', 'conversation_id__5': UUID('95e9e6a5-0503-416f-bd0a-27518d4dc775'), 'created_at__5': datetime.datetime(2025, 5, 19, 15, 41, 57, 494981), 'key__5': 'user_email', 'id__6': UUID('ece51c61-1c75-4ebc-b48d-a2515c69fbe1'), 'value__6': 'true', 'conversation_id__6': UUID('95e9e6a5-0503-416f-bd0a-27518d4dc775'), 'created_at__6': datetime.datetime(2025, 5, 19, 15, 41, 57, 494982), 'key__6': 'is_new_conversation', 'id__7': UUID('9001c77d-9bfa-4ebd-8c9e-70db0bd1074a'), 'value__7': 'true', 'conversation_id__7': UUID('95e9e6a5-0503-416f-bd0a-27518d4dc775'), 'created_at__7': datetime.datetime(2025, 5, 19, 15, 41, 57, 494984), 'key__7': 'first_interaction'}
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - [cached since 1510s ago] {'pk_1': UUID('95e9e6a5-0503-416f-bd0a-27518d4dc775')}
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - [cached since 1513s ago] {'id_1': UUID('95e9e6a5-0503-416f-bd0a-27518d4dc775'), 'param_1': 1}
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - [cached since 1510s ago] {'pk_1': UUID('95e9e6a5-0503-416f-bd0a-27518d4dc775')}
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - [cached since 1510s ago] {'conversation_id_1': UUID('95e9e6a5-0503-416f-bd0a-27518d4dc775'), 'key_1': 'user_name', 'param_1': 1}
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - [cached since 1510s ago] {'conversation_id_1': UUID('95e9e6a5-0503-416f-bd0a-27518d4dc775'), 'key_1': 'user_location', 'param_1': 1}
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - [cached since 1510s ago] {'conversation_id_1': UUID('95e9e6a5-0503-416f-bd0a-27518d4dc775'), 'key_1': 'sector', 'param_1': 1}
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - [cached since 1510s ago] {'conversation_id_1': UUID('95e9e6a5-0503-416f-bd0a-27518d4dc775'), 'key_1': 'subsector', 'param_1': 1}
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - [cached since 1510s ago] {'conversation_id_1': UUID('95e9e6a5-0503-416f-bd0a-27518d4dc775'), 'key_1': 'company_name', 'param_1': 1}
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - [cached since 1510s ago] {'conversation_id_1': UUID('95e9e6a5-0503-416f-bd0a-27518d4dc775'), 'key_1': 'user_email', 'param_1': 1}
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - [cached since 1510s ago] {'conversation_id_1': UUID('95e9e6a5-0503-416f-bd0a-27518d4dc775'), 'key_1': 'is_new_conversation', 'param_1': 1}
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - [cached since 1510s ago] {'conversation_id_1': UUID('95e9e6a5-0503-416f-bd0a-27518d4dc775'), 'key_1': 'first_interaction', 'param_1': 1}
2025-05-19 15:41:57 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:41:57 - hydrous - INFO - DBG_SS: Conversación 95e9e6a5-0503-416f-bd0a-27518d4dc775 actualizada en base de datos.
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - [cached since 2189s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:53:13 - hydrous - INFO - Datos del usuario al iniciar conversación: nombre=Ricardo Altamirano, empresa=hydrous, sector=commercial, subsector=Hotel, ubicación=los mochis, email=hydrous20@gmail.com
2025-05-19 15:53:13 - hydrous - INFO - Metadata inicial de la conversación: {'client_name': 'Ricardo Altamirano', 'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'selected_sector': 'commercial', 'selected_subsector': 'Hotel', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversations (user_id, selected_sector, selected_subsector, current_question_id, is_complete, has_proposal, client_name, proposal_text, pdf_path, id, created_at) VALUES (%(user_id)s::UUID, %(selected_sector)s, %(selected_subsector)s, %(current_question_id)s, %(is_complete)s, %(has_proposal)s, %(client_name)s, %(proposal_text)s, %(pdf_path)s, %(id)s::UUID, %(created_at)s)
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - [cached since 2186s ago] {'user_id': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'selected_sector': 'commercial', 'selected_subsector': 'Hotel', 'current_question_id': None, 'is_complete': False, 'has_proposal': False, 'client_name': 'Ricardo Altamirano', 'proposal_text': None, 'pdf_path': None, 'id': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce'), 'created_at': datetime.datetime(2025, 5, 19, 15, 53, 13, 858652)}
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversation_metadata (conversation_id, key, value, id, created_at) VALUES (%(conversation_id__0)s::UUID, %(key__0)s, %(value__0)s::JSONB, %(id__0)s::UUID, %(created_at__0)s), (%(conversation_id__1)s::UUID, %(key__1)s, %(value__1)s::JSONB ... 543 characters truncated ...  (%(conversation_id__7)s::UUID, %(key__7)s, %(value__7)s::JSONB, %(id__7)s::UUID, %(created_at__7)s)
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - [cached since 2186s ago (insertmanyvalues) 1/1 (unordered)] {'id__0': UUID('374985b7-a2e1-4a01-adbd-601750a6e0f7'), 'value__0': '"Ricardo Altamirano"', 'conversation_id__0': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce'), 'created_at__0': datetime.datetime(2025, 5, 19, 15, 53, 13, 889012), 'key__0': 'user_name', 'id__1': UUID('a6a80980-f098-4d7a-92bf-3f5602bda1bd'), 'value__1': '"los mochis"', 'conversation_id__1': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce'), 'created_at__1': datetime.datetime(2025, 5, 19, 15, 53, 13, 889021), 'key__1': 'user_location', 'id__2': UUID('da80387f-9587-49ad-b92c-f39812a39bff'), 'value__2': '"commercial"', 'conversation_id__2': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce'), 'created_at__2': datetime.datetime(2025, 5, 19, 15, 53, 13, 889056), 'key__2': 'sector', 'id__3': UUID('7f7141c9-5012-452c-b716-8742103c5c25'), 'value__3': '"Hotel"', 'conversation_id__3': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce'), 'created_at__3': datetime.datetime(2025, 5, 19, 15, 53, 13, 889064), 'key__3': 'subsector', 'id__4': UUID('7a517745-fe3f-4495-b60e-aec2d4da5c26'), 'value__4': '"hydrous"', 'conversation_id__4': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce'), 'created_at__4': datetime.datetime(2025, 5, 19, 15, 53, 13, 889067), 'key__4': 'company_name', 'id__5': UUID('13af23b5-7838-4249-9644-367181455f46'), 'value__5': '"hydrous20@gmail.com"', 'conversation_id__5': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce'), 'created_at__5': datetime.datetime(2025, 5, 19, 15, 53, 13, 889069), 'key__5': 'user_email', 'id__6': UUID('fafdf7fa-991e-484a-be0a-15307c3537bd'), 'value__6': 'true', 'conversation_id__6': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce'), 'created_at__6': datetime.datetime(2025, 5, 19, 15, 53, 13, 889071), 'key__6': 'is_new_conversation', 'id__7': UUID('ac526cfd-aad3-4a23-a177-6cf1d8b197a1'), 'value__7': 'true', 'conversation_id__7': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce'), 'created_at__7': datetime.datetime(2025, 5, 19, 15, 53, 13, 889072), 'key__7': 'first_interaction'}
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - [cached since 2186s ago] {'pk_1': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce')}
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - [cached since 2190s ago] {'id_1': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce'), 'param_1': 1}
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - [cached since 2186s ago] {'pk_1': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce')}
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - [cached since 2186s ago] {'conversation_id_1': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce'), 'key_1': 'user_name', 'param_1': 1}
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - [cached since 2186s ago] {'conversation_id_1': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce'), 'key_1': 'user_location', 'param_1': 1}
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - [cached since 2186s ago] {'conversation_id_1': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce'), 'key_1': 'sector', 'param_1': 1}
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - [cached since 2186s ago] {'conversation_id_1': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce'), 'key_1': 'subsector', 'param_1': 1}
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - [cached since 2186s ago] {'conversation_id_1': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce'), 'key_1': 'company_name', 'param_1': 1}
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:53:13 - sqlalchemy.engine.Engine - INFO - [cached since 2186s ago] {'conversation_id_1': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce'), 'key_1': 'user_email', 'param_1': 1}
2025-05-19 15:53:14 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:14 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:14 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:53:14 - sqlalchemy.engine.Engine - INFO - [cached since 2186s ago] {'conversation_id_1': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce'), 'key_1': 'is_new_conversation', 'param_1': 1}
2025-05-19 15:53:14 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:14 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:14 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:53:14 - sqlalchemy.engine.Engine - INFO - [cached since 2186s ago] {'conversation_id_1': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce'), 'key_1': 'first_interaction', 'param_1': 1}
2025-05-19 15:53:14 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:14 - hydrous - INFO - DBG_SS: Conversación 55a694b0-82cd-47d9-9352-1fb4f1a09bce actualizada en base de datos.
2025-05-19 15:53:18 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:18 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:53:18 - sqlalchemy.engine.Engine - INFO - [cached since 2194s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 15:53:18 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:53:18 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:18 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:53:18 - sqlalchemy.engine.Engine - INFO - [cached since 2194s ago] {'id_1': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce'), 'param_1': 1}
2025-05-19 15:53:18 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE messages.conversation_id = %(conversation_id_1)s::UUID ORDER BY messages.created_at
2025-05-19 15:53:18 - sqlalchemy.engine.Engine - INFO - [cached since 2194s ago] {'conversation_id_1': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce')}
2025-05-19 15:53:18 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID
2025-05-19 15:53:18 - sqlalchemy.engine.Engine - INFO - [cached since 2194s ago] {'conversation_id_1': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce')}
2025-05-19 15:53:18 - hydrous - INFO - DBG_SS: Conversación 55a694b0-82cd-47d9-9352-1fb4f1a09bce RECUPERADA. Metadata actual: {'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:53:18 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:53:18 - sqlalchemy.engine.Engine - INFO - [cached since 2194s ago] {'id_1': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce'), 'param_1': 1}
2025-05-19 15:53:18 - hydrous - INFO - PDF_CHECK: ConvID=55a694b0-82cd-47d9-9352-1fb4f1a09bce, Input='yes', is_pdf_req=False, proposal_ready=False, is_complete=False, pdf_path=None, ready_for_proposal=False
2025-05-19 15:53:18 - hydrous - INFO - Normal flow for conversation 55a694b0-82cd-47d9-9352-1fb4f1a09bce
2025-05-19 15:53:18 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:53:18 - sqlalchemy.engine.Engine - INFO - [cached since 2194s ago] {'id_1': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce'), 'param_1': 1}
2025-05-19 15:53:18 - sqlalchemy.engine.Engine - INFO - INSERT INTO messages (conversation_id, role, content, id, created_at) VALUES (%(conversation_id)s::UUID, %(role)s, %(content)s, %(id)s::UUID, %(created_at)s)
2025-05-19 15:53:18 - sqlalchemy.engine.Engine - INFO - [generated in 0.00275s] {'conversation_id': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce'), 'role': 'user', 'content': 'yes', 'id': UUID('f6eff459-6ca7-4e46-b8fe-ec43e415c312'), 'created_at': datetime.datetime(2025, 5, 19, 15, 53, 18, 580587)}
2025-05-19 15:53:18 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:18 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:18 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id, messages.role, messages.content, messages.id, messages.created_at 
FROM messages 
WHERE messages.id = %(pk_1)s::UUID
2025-05-19 15:53:18 - sqlalchemy.engine.Engine - INFO - [generated in 0.00076s] {'pk_1': UUID('f6eff459-6ca7-4e46-b8fe-ec43e415c312')}
2025-05-19 15:53:18 - hydrous - INFO - Primera interacción detectada para conversación 55a694b0-82cd-47d9-9352-1fb4f1a09bce. Actualizando metadata.
2025-05-19 15:53:18 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:53:18 - sqlalchemy.engine.Engine - INFO - [cached since 2194s ago] {'id_1': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce'), 'param_1': 1}
2025-05-19 15:53:18 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE messages.conversation_id = %(conversation_id_1)s::UUID ORDER BY messages.created_at
2025-05-19 15:53:18 - sqlalchemy.engine.Engine - INFO - [cached since 2194s ago] {'conversation_id_1': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce')}
2025-05-19 15:53:18 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID
2025-05-19 15:53:18 - sqlalchemy.engine.Engine - INFO - [cached since 2194s ago] {'conversation_id_1': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce')}
2025-05-19 15:53:18 - hydrous - INFO - DBG_SS: Conversación 55a694b0-82cd-47d9-9352-1fb4f1a09bce RECUPERADA. Metadata actual: {'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:53:18 - hydrous - INFO - DBG_AI_HANDLE: Iniciando handle_conversation para conv 55a694b0-82cd-47d9-9352-1fb4f1a09bce
2025-05-19 15:53:18 - hydrous - INFO - Metadata recibida en _prepare_messages: sector=commercial, subsector=Hotel, location=los mochis, client_name=Ricardo Altamirano, company_name=hydrous, is_new_conversation=True
2025-05-19 15:53:18 - hydrous - INFO - Datos de usuario procesados: nombre=Ricardo Altamirano, empresa=hydrous, sector=commercial, subsector=Hotel, ubicacion=los mochis, nueva_conversacion=True, primera_interaccion=True
2025-05-19 15:53:18 - hydrous - INFO - Added additional user context and conversation state to the prompt.
2025-05-19 15:53:18 - hydrous - INFO - DBG_AI_HANDLE: Mensajes preparados OK (Total: 3).
2025-05-19 15:53:19 - hydrous - INFO - DBG_AI_CALL: Iniciando llamada a API LLM. URL: https://api.openai.com/v1/chat/completions, Model: gpt-4o-mini, #Msgs: 3
2025-05-19 15:53:23 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-19 15:53:23 - hydrous - INFO - DBG_AI_CALL: Llamada a API completada. Status: 200
2025-05-19 15:53:23 - hydrous - INFO - DBG_AI_CALL: Contenido LLM extraído exitosamente (longitud: 680).
2025-05-19 15:53:23 - hydrous - INFO - DBG_AI_HANDLE: Respuesta LLM recibida (primeros 50 chars): 'I see you're in el sector comercial, específicamen'
2025-05-19 15:53:23 - hydrous - INFO - Metadata[current_question_asked_summary] actualizada a: '¿Cuántas personas (empleados, clientes, visitantes) atiende su hotel por día?'
2025-05-19 15:53:23 - hydrous - INFO - DBG_AI_HANDLE: Finalizando handle_conversation para 55a694b0-82cd-47d9-9352-1fb4f1a09bce. Respuesta final: 'I see you're in el sector comercial, específicamen...'
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - [cached since 2199s ago] {'id_1': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce'), 'param_1': 1}
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - INSERT INTO messages (conversation_id, role, content, id, created_at) VALUES (%(conversation_id)s::UUID, %(role)s, %(content)s, %(id)s::UUID, %(created_at)s)
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - [cached since 4.817s ago] {'conversation_id': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce'), 'role': 'assistant', 'content': "I see you're in el sector comercial, específicamente en la industria hotelera, y ubicado en Los Mochis. \n\n💧 **Dato relevante:** En la industria hot ... (396 characters truncated) ... ué preguntamos esto?* Esta información nos ayudará a entender mejor la demanda de agua y el potencial de tratamiento y reutilización en su operación.", 'id': UUID('2ec5b11e-d3db-410a-bba7-5c3fbaaa71f7'), 'created_at': datetime.datetime(2025, 5, 19, 15, 53, 23, 396879)}
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id, messages.role, messages.content, messages.id, messages.created_at 
FROM messages 
WHERE messages.id = %(pk_1)s::UUID
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - [cached since 4.794s ago] {'pk_1': UUID('2ec5b11e-d3db-410a-bba7-5c3fbaaa71f7')}
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - [cached since 2199s ago] {'id_1': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce'), 'param_1': 1}
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - UPDATE conversations SET current_question_id=%(current_question_id)s WHERE conversations.id = %(conversations_id)s::UUID
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - [generated in 0.00054s] {'current_question_id': 'q_4', 'conversations_id': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce')}
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - [cached since 2196s ago] {'pk_1': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce')}
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - [cached since 2196s ago] {'conversation_id_1': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce'), 'key_1': 'user_name', 'param_1': 1}
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - [cached since 2196s ago] {'conversation_id_1': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce'), 'key_1': 'user_location', 'param_1': 1}
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - [cached since 2196s ago] {'conversation_id_1': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce'), 'key_1': 'sector', 'param_1': 1}
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - [cached since 2196s ago] {'conversation_id_1': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce'), 'key_1': 'subsector', 'param_1': 1}
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - [cached since 2196s ago] {'conversation_id_1': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce'), 'key_1': 'company_name', 'param_1': 1}
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - [cached since 2196s ago] {'conversation_id_1': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce'), 'key_1': 'user_email', 'param_1': 1}
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - [cached since 2196s ago] {'conversation_id_1': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce'), 'key_1': 'is_new_conversation', 'param_1': 1}
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - [cached since 2196s ago] {'conversation_id_1': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce'), 'key_1': 'first_interaction', 'param_1': 1}
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - [cached since 2196s ago] {'conversation_id_1': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce'), 'key_1': 'location', 'param_1': 1}
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversation_metadata (conversation_id, key, value, id, created_at) VALUES (%(conversation_id)s::UUID, %(key)s, %(value)s::JSONB, %(id)s::UUID, %(created_at)s)
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - [generated in 0.00048s] {'conversation_id': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce'), 'key': 'location', 'value': '"los mochis"', 'id': UUID('aba02f00-348d-4577-abf4-b2114321d35e'), 'created_at': datetime.datetime(2025, 5, 19, 15, 53, 23, 475249)}
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - [cached since 2196s ago] {'conversation_id_1': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce'), 'key_1': 'current_question_asked_summary', 'param_1': 1}
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversation_metadata (conversation_id, key, value, id, created_at) VALUES (%(conversation_id)s::UUID, %(key)s, %(value)s::JSONB, %(id)s::UUID, %(created_at)s)
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - [cached since 0.005091s ago] {'conversation_id': UUID('55a694b0-82cd-47d9-9352-1fb4f1a09bce'), 'key': 'current_question_asked_summary', 'value': '"\\u00bfCu\\u00e1ntas personas (empleados, clientes, visitantes) atiende su hotel por d\\u00eda?"', 'id': UUID('551539fd-cc45-4289-85a6-f8b1fb7e769d'), 'created_at': datetime.datetime(2025, 5, 19, 15, 53, 23, 480029)}
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:23 - hydrous - INFO - DBG_SS: Conversación 55a694b0-82cd-47d9-9352-1fb4f1a09bce actualizada en base de datos.
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.created_at < %(created_at_1)s
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - [generated in 0.00059s] {'created_at_1': datetime.datetime(2025, 5, 18, 15, 53, 23, 490915)}
2025-05-19 15:53:23 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - [cached since 2214s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:53:38 - hydrous - INFO - Datos del usuario al iniciar conversación: nombre=Ricardo Altamirano, empresa=hydrous, sector=commercial, subsector=Hotel, ubicación=los mochis, email=hydrous20@gmail.com
2025-05-19 15:53:38 - hydrous - INFO - Metadata inicial de la conversación: {'client_name': 'Ricardo Altamirano', 'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'selected_sector': 'commercial', 'selected_subsector': 'Hotel', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversations (user_id, selected_sector, selected_subsector, current_question_id, is_complete, has_proposal, client_name, proposal_text, pdf_path, id, created_at) VALUES (%(user_id)s::UUID, %(selected_sector)s, %(selected_subsector)s, %(current_question_id)s, %(is_complete)s, %(has_proposal)s, %(client_name)s, %(proposal_text)s, %(pdf_path)s, %(id)s::UUID, %(created_at)s)
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - [cached since 2210s ago] {'user_id': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'selected_sector': 'commercial', 'selected_subsector': 'Hotel', 'current_question_id': None, 'is_complete': False, 'has_proposal': False, 'client_name': 'Ricardo Altamirano', 'proposal_text': None, 'pdf_path': None, 'id': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a'), 'created_at': datetime.datetime(2025, 5, 19, 15, 53, 38, 246033)}
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversation_metadata (conversation_id, key, value, id, created_at) VALUES (%(conversation_id__0)s::UUID, %(key__0)s, %(value__0)s::JSONB, %(id__0)s::UUID, %(created_at__0)s), (%(conversation_id__1)s::UUID, %(key__1)s, %(value__1)s::JSONB ... 543 characters truncated ...  (%(conversation_id__7)s::UUID, %(key__7)s, %(value__7)s::JSONB, %(id__7)s::UUID, %(created_at__7)s)
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - [cached since 2210s ago (insertmanyvalues) 1/1 (unordered)] {'id__0': UUID('9e017606-d409-4210-b5ff-24a03a5d3415'), 'value__0': '"Ricardo Altamirano"', 'conversation_id__0': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a'), 'created_at__0': datetime.datetime(2025, 5, 19, 15, 53, 38, 252378), 'key__0': 'user_name', 'id__1': UUID('68fcb20d-95dd-4457-a9df-4a29a6409d7a'), 'value__1': '"los mochis"', 'conversation_id__1': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a'), 'created_at__1': datetime.datetime(2025, 5, 19, 15, 53, 38, 252383), 'key__1': 'user_location', 'id__2': UUID('88a012c5-6e64-4183-a35b-5a205fe3fcb7'), 'value__2': '"commercial"', 'conversation_id__2': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a'), 'created_at__2': datetime.datetime(2025, 5, 19, 15, 53, 38, 252384), 'key__2': 'sector', 'id__3': UUID('a9956617-1690-407f-8246-701adfa4a886'), 'value__3': '"Hotel"', 'conversation_id__3': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a'), 'created_at__3': datetime.datetime(2025, 5, 19, 15, 53, 38, 252386), 'key__3': 'subsector', 'id__4': UUID('ac508b8c-c9b0-425f-85d5-f70f9ef261b0'), 'value__4': '"hydrous"', 'conversation_id__4': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a'), 'created_at__4': datetime.datetime(2025, 5, 19, 15, 53, 38, 252387), 'key__4': 'company_name', 'id__5': UUID('d713c46f-e64e-44c8-9ab9-a111572c0365'), 'value__5': '"hydrous20@gmail.com"', 'conversation_id__5': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a'), 'created_at__5': datetime.datetime(2025, 5, 19, 15, 53, 38, 252389), 'key__5': 'user_email', 'id__6': UUID('f2d660f5-7b77-4701-aee9-f06647f23140'), 'value__6': 'true', 'conversation_id__6': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a'), 'created_at__6': datetime.datetime(2025, 5, 19, 15, 53, 38, 252390), 'key__6': 'is_new_conversation', 'id__7': UUID('00c44322-a119-488e-af09-6c4e6cb851b0'), 'value__7': 'true', 'conversation_id__7': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a'), 'created_at__7': datetime.datetime(2025, 5, 19, 15, 53, 38, 252392), 'key__7': 'first_interaction'}
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - [cached since 2210s ago] {'pk_1': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a')}
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - [cached since 2214s ago] {'id_1': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a'), 'param_1': 1}
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - [cached since 2210s ago] {'pk_1': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a')}
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - [cached since 2210s ago] {'conversation_id_1': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a'), 'key_1': 'user_name', 'param_1': 1}
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - [cached since 2210s ago] {'conversation_id_1': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a'), 'key_1': 'user_location', 'param_1': 1}
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - [cached since 2210s ago] {'conversation_id_1': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a'), 'key_1': 'sector', 'param_1': 1}
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - [cached since 2210s ago] {'conversation_id_1': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a'), 'key_1': 'subsector', 'param_1': 1}
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - [cached since 2210s ago] {'conversation_id_1': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a'), 'key_1': 'company_name', 'param_1': 1}
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - [cached since 2210s ago] {'conversation_id_1': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a'), 'key_1': 'user_email', 'param_1': 1}
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - [cached since 2210s ago] {'conversation_id_1': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a'), 'key_1': 'is_new_conversation', 'param_1': 1}
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - [cached since 2210s ago] {'conversation_id_1': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a'), 'key_1': 'first_interaction', 'param_1': 1}
2025-05-19 15:53:38 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:38 - hydrous - INFO - DBG_SS: Conversación d94afb1f-08ab-42f8-8529-f4b9b889684a actualizada en base de datos.
2025-05-19 15:53:41 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:41 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:53:41 - sqlalchemy.engine.Engine - INFO - [cached since 2217s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 15:53:41 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:53:41 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:41 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:53:41 - sqlalchemy.engine.Engine - INFO - [cached since 2217s ago] {'id_1': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a'), 'param_1': 1}
2025-05-19 15:53:41 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE messages.conversation_id = %(conversation_id_1)s::UUID ORDER BY messages.created_at
2025-05-19 15:53:41 - sqlalchemy.engine.Engine - INFO - [cached since 2217s ago] {'conversation_id_1': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a')}
2025-05-19 15:53:41 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID
2025-05-19 15:53:41 - sqlalchemy.engine.Engine - INFO - [cached since 2217s ago] {'conversation_id_1': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a')}
2025-05-19 15:53:41 - hydrous - INFO - DBG_SS: Conversación d94afb1f-08ab-42f8-8529-f4b9b889684a RECUPERADA. Metadata actual: {'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:53:41 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:53:41 - sqlalchemy.engine.Engine - INFO - [cached since 2217s ago] {'id_1': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a'), 'param_1': 1}
2025-05-19 15:53:41 - hydrous - INFO - PDF_CHECK: ConvID=d94afb1f-08ab-42f8-8529-f4b9b889684a, Input='yes', is_pdf_req=False, proposal_ready=False, is_complete=False, pdf_path=None, ready_for_proposal=False
2025-05-19 15:53:41 - hydrous - INFO - Normal flow for conversation d94afb1f-08ab-42f8-8529-f4b9b889684a
2025-05-19 15:53:41 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:53:41 - sqlalchemy.engine.Engine - INFO - [cached since 2217s ago] {'id_1': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a'), 'param_1': 1}
2025-05-19 15:53:41 - sqlalchemy.engine.Engine - INFO - INSERT INTO messages (conversation_id, role, content, id, created_at) VALUES (%(conversation_id)s::UUID, %(role)s, %(content)s, %(id)s::UUID, %(created_at)s)
2025-05-19 15:53:41 - sqlalchemy.engine.Engine - INFO - [cached since 23.15s ago] {'conversation_id': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a'), 'role': 'user', 'content': 'yes', 'id': UUID('eb064072-0902-4863-b619-e5fa85c67038'), 'created_at': datetime.datetime(2025, 5, 19, 15, 53, 41, 725280)}
2025-05-19 15:53:41 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:41 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:41 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id, messages.role, messages.content, messages.id, messages.created_at 
FROM messages 
WHERE messages.id = %(pk_1)s::UUID
2025-05-19 15:53:41 - sqlalchemy.engine.Engine - INFO - [cached since 23.12s ago] {'pk_1': UUID('eb064072-0902-4863-b619-e5fa85c67038')}
2025-05-19 15:53:41 - hydrous - INFO - Primera interacción detectada para conversación d94afb1f-08ab-42f8-8529-f4b9b889684a. Actualizando metadata.
2025-05-19 15:53:41 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:53:41 - sqlalchemy.engine.Engine - INFO - [cached since 2217s ago] {'id_1': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a'), 'param_1': 1}
2025-05-19 15:53:41 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE messages.conversation_id = %(conversation_id_1)s::UUID ORDER BY messages.created_at
2025-05-19 15:53:41 - sqlalchemy.engine.Engine - INFO - [cached since 2217s ago] {'conversation_id_1': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a')}
2025-05-19 15:53:41 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID
2025-05-19 15:53:41 - sqlalchemy.engine.Engine - INFO - [cached since 2217s ago] {'conversation_id_1': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a')}
2025-05-19 15:53:41 - hydrous - INFO - DBG_SS: Conversación d94afb1f-08ab-42f8-8529-f4b9b889684a RECUPERADA. Metadata actual: {'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:53:41 - hydrous - INFO - DBG_AI_HANDLE: Iniciando handle_conversation para conv d94afb1f-08ab-42f8-8529-f4b9b889684a
2025-05-19 15:53:41 - hydrous - INFO - Metadata recibida en _prepare_messages: sector=commercial, subsector=Hotel, location=los mochis, client_name=Ricardo Altamirano, company_name=hydrous, is_new_conversation=True
2025-05-19 15:53:41 - hydrous - INFO - Datos de usuario procesados: nombre=Ricardo Altamirano, empresa=hydrous, sector=commercial, subsector=Hotel, ubicacion=los mochis, nueva_conversacion=True, primera_interaccion=True
2025-05-19 15:53:41 - hydrous - INFO - Added additional user context and conversation state to the prompt.
2025-05-19 15:53:41 - hydrous - INFO - DBG_AI_HANDLE: Mensajes preparados OK (Total: 3).
2025-05-19 15:53:41 - hydrous - INFO - DBG_AI_CALL: Iniciando llamada a API LLM. URL: https://api.openai.com/v1/chat/completions, Model: gpt-4o-mini, #Msgs: 3
2025-05-19 15:53:44 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-19 15:53:44 - hydrous - INFO - DBG_AI_CALL: Llamada a API completada. Status: 200
2025-05-19 15:53:44 - hydrous - INFO - DBG_AI_CALL: Contenido LLM extraído exitosamente (longitud: 579).
2025-05-19 15:53:44 - hydrous - INFO - DBG_AI_HANDLE: Respuesta LLM recibida (primeros 50 chars): 'Gracias por confirmar la información, Ricardo. Vam'
2025-05-19 15:53:44 - hydrous - INFO - Metadata[current_question_asked_summary] actualizada a: '¿Cuál es el costo del agua en tu ubicación (moneda/unidad de medición)?'
2025-05-19 15:53:44 - hydrous - INFO - DBG_AI_HANDLE: Finalizando handle_conversation para d94afb1f-08ab-42f8-8529-f4b9b889684a. Respuesta final: 'Gracias por confirmar la información, Ricardo. Vam...'
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - [cached since 2220s ago] {'id_1': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a'), 'param_1': 1}
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - INSERT INTO messages (conversation_id, role, content, id, created_at) VALUES (%(conversation_id)s::UUID, %(role)s, %(content)s, %(id)s::UUID, %(created_at)s)
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - [cached since 25.72s ago] {'conversation_id': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a'), 'role': 'assistant', 'content': 'Gracias por confirmar la información, Ricardo. Vamos a seguir adelante con el proceso para diseñar una solución de tratamiento de agua adaptada a tu  ... (286 characters truncated) ... idad de medición)?  \n*Por qué preguntamos esto:* Conocer el costo del agua nos ayuda a evaluar la viabilidad económica de las soluciones propuestas.', 'id': UUID('2f7486ff-e14e-4834-9f99-d1a4b5410cf4'), 'created_at': datetime.datetime(2025, 5, 19, 15, 53, 44, 295411)}
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id, messages.role, messages.content, messages.id, messages.created_at 
FROM messages 
WHERE messages.id = %(pk_1)s::UUID
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - [cached since 25.69s ago] {'pk_1': UUID('2f7486ff-e14e-4834-9f99-d1a4b5410cf4')}
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - [cached since 2220s ago] {'id_1': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a'), 'param_1': 1}
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - UPDATE conversations SET current_question_id=%(current_question_id)s WHERE conversations.id = %(conversations_id)s::UUID
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - [cached since 20.89s ago] {'current_question_id': 'q_4', 'conversations_id': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a')}
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - [cached since 2216s ago] {'pk_1': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a')}
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - [cached since 2216s ago] {'conversation_id_1': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a'), 'key_1': 'user_name', 'param_1': 1}
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - [cached since 2216s ago] {'conversation_id_1': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a'), 'key_1': 'user_location', 'param_1': 1}
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - [cached since 2216s ago] {'conversation_id_1': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a'), 'key_1': 'sector', 'param_1': 1}
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - [cached since 2216s ago] {'conversation_id_1': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a'), 'key_1': 'subsector', 'param_1': 1}
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - [cached since 2216s ago] {'conversation_id_1': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a'), 'key_1': 'company_name', 'param_1': 1}
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - [cached since 2216s ago] {'conversation_id_1': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a'), 'key_1': 'user_email', 'param_1': 1}
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - [cached since 2216s ago] {'conversation_id_1': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a'), 'key_1': 'is_new_conversation', 'param_1': 1}
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - [cached since 2217s ago] {'conversation_id_1': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a'), 'key_1': 'first_interaction', 'param_1': 1}
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - [cached since 2217s ago] {'conversation_id_1': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a'), 'key_1': 'location', 'param_1': 1}
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversation_metadata (conversation_id, key, value, id, created_at) VALUES (%(conversation_id)s::UUID, %(key)s, %(value)s::JSONB, %(id)s::UUID, %(created_at)s)
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - [cached since 20.89s ago] {'conversation_id': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a'), 'key': 'location', 'value': '"los mochis"', 'id': UUID('a65bcbec-4fb7-46ca-9016-1bbba32cc2bb'), 'created_at': datetime.datetime(2025, 5, 19, 15, 53, 44, 362440)}
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - [cached since 2217s ago] {'conversation_id_1': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a'), 'key_1': 'current_question_asked_summary', 'param_1': 1}
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversation_metadata (conversation_id, key, value, id, created_at) VALUES (%(conversation_id)s::UUID, %(key)s, %(value)s::JSONB, %(id)s::UUID, %(created_at)s)
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - [cached since 20.9s ago] {'conversation_id': UUID('d94afb1f-08ab-42f8-8529-f4b9b889684a'), 'key': 'current_question_asked_summary', 'value': '"\\u00bfCu\\u00e1l es el costo del agua en tu ubicaci\\u00f3n (moneda/unidad de medici\\u00f3n)?"', 'id': UUID('a6f09c35-fa23-41c9-a9b5-4d2f4d6e29ab'), 'created_at': datetime.datetime(2025, 5, 19, 15, 53, 44, 370319)}
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:53:44 - hydrous - INFO - DBG_SS: Conversación d94afb1f-08ab-42f8-8529-f4b9b889684a actualizada en base de datos.
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.created_at < %(created_at_1)s
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - [cached since 20.81s ago] {'created_at_1': datetime.datetime(2025, 5, 18, 15, 53, 44, 387761)}
2025-05-19 15:53:44 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - [cached since 2505s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:58:29 - hydrous - INFO - Datos del usuario al iniciar conversación: nombre=Ricardo Altamirano, empresa=hydrous, sector=commercial, subsector=Hotel, ubicación=los mochis, email=hydrous20@gmail.com
2025-05-19 15:58:29 - hydrous - INFO - Metadata inicial de la conversación: {'client_name': 'Ricardo Altamirano', 'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'selected_sector': 'commercial', 'selected_subsector': 'Hotel', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversations (user_id, selected_sector, selected_subsector, current_question_id, is_complete, has_proposal, client_name, proposal_text, pdf_path, id, created_at) VALUES (%(user_id)s::UUID, %(selected_sector)s, %(selected_subsector)s, %(current_question_id)s, %(is_complete)s, %(has_proposal)s, %(client_name)s, %(proposal_text)s, %(pdf_path)s, %(id)s::UUID, %(created_at)s)
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - [cached since 2501s ago] {'user_id': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'selected_sector': 'commercial', 'selected_subsector': 'Hotel', 'current_question_id': None, 'is_complete': False, 'has_proposal': False, 'client_name': 'Ricardo Altamirano', 'proposal_text': None, 'pdf_path': None, 'id': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809'), 'created_at': datetime.datetime(2025, 5, 19, 15, 58, 29, 155870)}
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversation_metadata (conversation_id, key, value, id, created_at) VALUES (%(conversation_id__0)s::UUID, %(key__0)s, %(value__0)s::JSONB, %(id__0)s::UUID, %(created_at__0)s), (%(conversation_id__1)s::UUID, %(key__1)s, %(value__1)s::JSONB ... 543 characters truncated ...  (%(conversation_id__7)s::UUID, %(key__7)s, %(value__7)s::JSONB, %(id__7)s::UUID, %(created_at__7)s)
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - [cached since 2501s ago (insertmanyvalues) 1/1 (unordered)] {'id__0': UUID('bc0f1dba-07c9-4321-999a-466f216d7dd9'), 'value__0': '"Ricardo Altamirano"', 'conversation_id__0': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809'), 'created_at__0': datetime.datetime(2025, 5, 19, 15, 58, 29, 168683), 'key__0': 'user_name', 'id__1': UUID('7b7092b8-4f78-43d8-8068-9b25c8ec0f23'), 'value__1': '"los mochis"', 'conversation_id__1': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809'), 'created_at__1': datetime.datetime(2025, 5, 19, 15, 58, 29, 168688), 'key__1': 'user_location', 'id__2': UUID('a54c43ca-a849-4349-8ff5-360c886a6b9b'), 'value__2': '"commercial"', 'conversation_id__2': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809'), 'created_at__2': datetime.datetime(2025, 5, 19, 15, 58, 29, 168690), 'key__2': 'sector', 'id__3': UUID('b12b1a27-6146-401c-b81c-a7fc6aef1db6'), 'value__3': '"Hotel"', 'conversation_id__3': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809'), 'created_at__3': datetime.datetime(2025, 5, 19, 15, 58, 29, 168691), 'key__3': 'subsector', 'id__4': UUID('820aeb0a-7cd7-4795-8595-937f6275ea19'), 'value__4': '"hydrous"', 'conversation_id__4': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809'), 'created_at__4': datetime.datetime(2025, 5, 19, 15, 58, 29, 168693), 'key__4': 'company_name', 'id__5': UUID('837253d1-d754-4243-a22b-fae440049d86'), 'value__5': '"hydrous20@gmail.com"', 'conversation_id__5': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809'), 'created_at__5': datetime.datetime(2025, 5, 19, 15, 58, 29, 168694), 'key__5': 'user_email', 'id__6': UUID('4b3174b5-9b16-430e-9629-eec7e409d291'), 'value__6': 'true', 'conversation_id__6': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809'), 'created_at__6': datetime.datetime(2025, 5, 19, 15, 58, 29, 168695), 'key__6': 'is_new_conversation', 'id__7': UUID('8080160d-72ac-4710-b2bb-cd1a306225b8'), 'value__7': 'true', 'conversation_id__7': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809'), 'created_at__7': datetime.datetime(2025, 5, 19, 15, 58, 29, 168697), 'key__7': 'first_interaction'}
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - [cached since 2501s ago] {'pk_1': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809')}
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - [cached since 2505s ago] {'id_1': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809'), 'param_1': 1}
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - [cached since 2501s ago] {'pk_1': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809')}
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - [cached since 2501s ago] {'conversation_id_1': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809'), 'key_1': 'user_name', 'param_1': 1}
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - [cached since 2501s ago] {'conversation_id_1': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809'), 'key_1': 'user_location', 'param_1': 1}
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - [cached since 2501s ago] {'conversation_id_1': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809'), 'key_1': 'sector', 'param_1': 1}
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - [cached since 2501s ago] {'conversation_id_1': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809'), 'key_1': 'subsector', 'param_1': 1}
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - [cached since 2501s ago] {'conversation_id_1': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809'), 'key_1': 'company_name', 'param_1': 1}
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - [cached since 2501s ago] {'conversation_id_1': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809'), 'key_1': 'user_email', 'param_1': 1}
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - [cached since 2501s ago] {'conversation_id_1': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809'), 'key_1': 'is_new_conversation', 'param_1': 1}
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - [cached since 2501s ago] {'conversation_id_1': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809'), 'key_1': 'first_interaction', 'param_1': 1}
2025-05-19 15:58:29 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:58:29 - hydrous - INFO - DBG_SS: Conversación 3810ebd6-042b-4e46-87a3-f9e2e2459809 actualizada en base de datos.
2025-05-19 15:58:32 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:58:32 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:58:32 - sqlalchemy.engine.Engine - INFO - [cached since 2508s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 15:58:32 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 15:58:32 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:58:32 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:58:32 - sqlalchemy.engine.Engine - INFO - [cached since 2508s ago] {'id_1': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809'), 'param_1': 1}
2025-05-19 15:58:32 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE messages.conversation_id = %(conversation_id_1)s::UUID ORDER BY messages.created_at
2025-05-19 15:58:32 - sqlalchemy.engine.Engine - INFO - [cached since 2508s ago] {'conversation_id_1': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809')}
2025-05-19 15:58:32 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID
2025-05-19 15:58:32 - sqlalchemy.engine.Engine - INFO - [cached since 2508s ago] {'conversation_id_1': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809')}
2025-05-19 15:58:32 - hydrous - INFO - DBG_SS: Conversación 3810ebd6-042b-4e46-87a3-f9e2e2459809 RECUPERADA. Metadata actual: {'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:58:32 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:58:32 - sqlalchemy.engine.Engine - INFO - [cached since 2508s ago] {'id_1': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809'), 'param_1': 1}
2025-05-19 15:58:32 - hydrous - INFO - PDF_CHECK: ConvID=3810ebd6-042b-4e46-87a3-f9e2e2459809, Input='yes', is_pdf_req=False, proposal_ready=False, is_complete=False, pdf_path=None, ready_for_proposal=False
2025-05-19 15:58:32 - hydrous - INFO - Normal flow for conversation 3810ebd6-042b-4e46-87a3-f9e2e2459809
2025-05-19 15:58:32 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:58:32 - sqlalchemy.engine.Engine - INFO - [cached since 2508s ago] {'id_1': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809'), 'param_1': 1}
2025-05-19 15:58:32 - sqlalchemy.engine.Engine - INFO - INSERT INTO messages (conversation_id, role, content, id, created_at) VALUES (%(conversation_id)s::UUID, %(role)s, %(content)s, %(id)s::UUID, %(created_at)s)
2025-05-19 15:58:32 - sqlalchemy.engine.Engine - INFO - [cached since 313.6s ago] {'conversation_id': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809'), 'role': 'user', 'content': 'yes', 'id': UUID('51bccae0-7697-47ac-b358-38d0f97bec93'), 'created_at': datetime.datetime(2025, 5, 19, 15, 58, 32, 190558)}
2025-05-19 15:58:32 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:58:32 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:58:32 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id, messages.role, messages.content, messages.id, messages.created_at 
FROM messages 
WHERE messages.id = %(pk_1)s::UUID
2025-05-19 15:58:32 - sqlalchemy.engine.Engine - INFO - [cached since 313.6s ago] {'pk_1': UUID('51bccae0-7697-47ac-b358-38d0f97bec93')}
2025-05-19 15:58:32 - hydrous - INFO - Primera interacción detectada para conversación 3810ebd6-042b-4e46-87a3-f9e2e2459809. Actualizando metadata.
2025-05-19 15:58:32 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:58:32 - sqlalchemy.engine.Engine - INFO - [cached since 2508s ago] {'id_1': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809'), 'param_1': 1}
2025-05-19 15:58:32 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE messages.conversation_id = %(conversation_id_1)s::UUID ORDER BY messages.created_at
2025-05-19 15:58:32 - sqlalchemy.engine.Engine - INFO - [cached since 2508s ago] {'conversation_id_1': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809')}
2025-05-19 15:58:32 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID
2025-05-19 15:58:32 - sqlalchemy.engine.Engine - INFO - [cached since 2508s ago] {'conversation_id_1': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809')}
2025-05-19 15:58:32 - hydrous - INFO - DBG_SS: Conversación 3810ebd6-042b-4e46-87a3-f9e2e2459809 RECUPERADA. Metadata actual: {'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 15:58:32 - hydrous - INFO - DBG_AI_HANDLE: Iniciando handle_conversation para conv 3810ebd6-042b-4e46-87a3-f9e2e2459809
2025-05-19 15:58:32 - hydrous - INFO - Metadata recibida en _prepare_messages: sector=commercial, subsector=Hotel, location=los mochis, client_name=Ricardo Altamirano, company_name=hydrous, is_new_conversation=True
2025-05-19 15:58:32 - hydrous - INFO - Datos de usuario procesados: nombre=Ricardo Altamirano, empresa=hydrous, sector=commercial, subsector=Hotel, ubicacion=los mochis, nueva_conversacion=True, primera_interaccion=True
2025-05-19 15:58:32 - hydrous - INFO - Added additional user context and conversation state to the prompt.
2025-05-19 15:58:32 - hydrous - INFO - DBG_AI_HANDLE: Mensajes preparados OK (Total: 3).
2025-05-19 15:58:32 - hydrous - INFO - DBG_AI_CALL: Iniciando llamada a API LLM. URL: https://api.openai.com/v1/chat/completions, Model: gpt-4o-mini, #Msgs: 3
2025-05-19 15:58:35 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-19 15:58:35 - hydrous - INFO - DBG_AI_CALL: Llamada a API completada. Status: 200
2025-05-19 15:58:35 - hydrous - INFO - DBG_AI_CALL: Contenido LLM extraído exitosamente (longitud: 534).
2025-05-19 15:58:35 - hydrous - INFO - DBG_AI_HANDLE: Respuesta LLM recibida (primeros 50 chars): 'Gracias por confirmar tu información. Me doy cuent'
2025-05-19 15:58:35 - hydrous - INFO - Metadata[current_question_asked_summary] actualizada a: '¿Cuál es el costo del agua en tu área (moneda/unidad de medición)?'
2025-05-19 15:58:35 - hydrous - INFO - DBG_AI_HANDLE: Finalizando handle_conversation para 3810ebd6-042b-4e46-87a3-f9e2e2459809. Respuesta final: 'Gracias por confirmar tu información. Me doy cuent...'
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - [cached since 2511s ago] {'id_1': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809'), 'param_1': 1}
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - INSERT INTO messages (conversation_id, role, content, id, created_at) VALUES (%(conversation_id)s::UUID, %(role)s, %(content)s, %(id)s::UUID, %(created_at)s)
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - [cached since 316.6s ago] {'conversation_id': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809'), 'role': 'assistant', 'content': 'Gracias por confirmar tu información. Me doy cuenta de que estás en la industria **hotelera** en **Los Mochis**. \n\n💧 **Dato relevante:** En el sect ... (242 characters truncated) ... r qué preguntamos esto?* Conocer el costo del agua es esencial para evaluar la viabilidad económica de las soluciones de tratamiento y reutilización.', 'id': UUID('2725e861-dd59-4d85-a9ab-a6c8c18332e5'), 'created_at': datetime.datetime(2025, 5, 19, 15, 58, 35, 197176)}
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id, messages.role, messages.content, messages.id, messages.created_at 
FROM messages 
WHERE messages.id = %(pk_1)s::UUID
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - [cached since 316.6s ago] {'pk_1': UUID('2725e861-dd59-4d85-a9ab-a6c8c18332e5')}
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - [cached since 2511s ago] {'id_1': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809'), 'param_1': 1}
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - UPDATE conversations SET current_question_id=%(current_question_id)s WHERE conversations.id = %(conversations_id)s::UUID
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - [cached since 311.8s ago] {'current_question_id': 'q_4', 'conversations_id': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809')}
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - [cached since 2507s ago] {'pk_1': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809')}
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - [cached since 2507s ago] {'conversation_id_1': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809'), 'key_1': 'user_name', 'param_1': 1}
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - [cached since 2507s ago] {'conversation_id_1': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809'), 'key_1': 'user_location', 'param_1': 1}
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - [cached since 2507s ago] {'conversation_id_1': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809'), 'key_1': 'sector', 'param_1': 1}
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - [cached since 2507s ago] {'conversation_id_1': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809'), 'key_1': 'subsector', 'param_1': 1}
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - [cached since 2507s ago] {'conversation_id_1': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809'), 'key_1': 'company_name', 'param_1': 1}
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - [cached since 2507s ago] {'conversation_id_1': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809'), 'key_1': 'user_email', 'param_1': 1}
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - [cached since 2507s ago] {'conversation_id_1': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809'), 'key_1': 'is_new_conversation', 'param_1': 1}
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - [cached since 2507s ago] {'conversation_id_1': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809'), 'key_1': 'first_interaction', 'param_1': 1}
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - [cached since 2507s ago] {'conversation_id_1': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809'), 'key_1': 'location', 'param_1': 1}
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversation_metadata (conversation_id, key, value, id, created_at) VALUES (%(conversation_id)s::UUID, %(key)s, %(value)s::JSONB, %(id)s::UUID, %(created_at)s)
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - [cached since 311.8s ago] {'conversation_id': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809'), 'key': 'location', 'value': '"los mochis"', 'id': UUID('ef61b9c3-189e-4fb5-ae29-6194aa789758'), 'created_at': datetime.datetime(2025, 5, 19, 15, 58, 35, 251161)}
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - [cached since 2507s ago] {'conversation_id_1': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809'), 'key_1': 'current_question_asked_summary', 'param_1': 1}
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversation_metadata (conversation_id, key, value, id, created_at) VALUES (%(conversation_id)s::UUID, %(key)s, %(value)s::JSONB, %(id)s::UUID, %(created_at)s)
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - [cached since 311.8s ago] {'conversation_id': UUID('3810ebd6-042b-4e46-87a3-f9e2e2459809'), 'key': 'current_question_asked_summary', 'value': '"\\u00bfCu\\u00e1l es el costo del agua en tu \\u00e1rea (moneda/unidad de medici\\u00f3n)?"', 'id': UUID('65b8cced-6624-4c04-b256-b8c1f65321a1'), 'created_at': datetime.datetime(2025, 5, 19, 15, 58, 35, 256530)}
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 15:58:35 - hydrous - INFO - DBG_SS: Conversación 3810ebd6-042b-4e46-87a3-f9e2e2459809 actualizada en base de datos.
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.created_at < %(created_at_1)s
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - [cached since 311.7s ago] {'created_at_1': datetime.datetime(2025, 5, 18, 15, 58, 35, 264106)}
2025-05-19 15:58:35 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 16:01:54 - root - INFO - Configuración de logging inicializada
2025-05-19 16:02:05 - root - INFO - Configuración de logging inicializada
2025-05-19 16:04:07 - root - INFO - Configuración de logging inicializada
2025-05-19 16:04:28 - root - INFO - Configuración de logging inicializada
2025-05-19 16:04:46 - root - INFO - Configuración de logging inicializada
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - [generated in 0.00122s] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 16:04:54 - hydrous - INFO - Datos del usuario al iniciar conversación: nombre=Ricardo Altamirano, empresa=hydrous, sector=commercial, subsector=Hotel, ubicación=los mochis, email=hydrous20@gmail.com
2025-05-19 16:04:54 - hydrous - INFO - Metadata inicial de la conversación: {'client_name': 'Ricardo Altamirano', 'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'selected_sector': 'commercial', 'selected_subsector': 'Hotel', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversations (user_id, selected_sector, selected_subsector, current_question_id, is_complete, has_proposal, client_name, proposal_text, pdf_path, id, created_at) VALUES (%(user_id)s::UUID, %(selected_sector)s, %(selected_subsector)s, %(current_question_id)s, %(is_complete)s, %(has_proposal)s, %(client_name)s, %(proposal_text)s, %(pdf_path)s, %(id)s::UUID, %(created_at)s)
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - [generated in 0.00064s] {'user_id': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'selected_sector': 'commercial', 'selected_subsector': 'Hotel', 'current_question_id': None, 'is_complete': False, 'has_proposal': False, 'client_name': 'Ricardo Altamirano', 'proposal_text': None, 'pdf_path': None, 'id': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d'), 'created_at': datetime.datetime(2025, 5, 19, 16, 4, 54, 598802)}
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversation_metadata (conversation_id, key, value, id, created_at) VALUES (%(conversation_id__0)s::UUID, %(key__0)s, %(value__0)s::JSONB, %(id__0)s::UUID, %(created_at__0)s), (%(conversation_id__1)s::UUID, %(key__1)s, %(value__1)s::JSONB ... 543 characters truncated ...  (%(conversation_id__7)s::UUID, %(key__7)s, %(value__7)s::JSONB, %(id__7)s::UUID, %(created_at__7)s)
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - [generated in 0.00030s (insertmanyvalues) 1/1 (unordered)] {'value__0': '"Ricardo Altamirano"', 'created_at__0': datetime.datetime(2025, 5, 19, 16, 4, 54, 608784), 'id__0': UUID('e8e370d9-560a-48e4-ac2a-fa3d63ecebbf'), 'conversation_id__0': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d'), 'key__0': 'user_name', 'value__1': '"los mochis"', 'created_at__1': datetime.datetime(2025, 5, 19, 16, 4, 54, 608789), 'id__1': UUID('9343160b-63a9-45cc-89ca-5407cb0e3c9b'), 'conversation_id__1': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d'), 'key__1': 'user_location', 'value__2': '"commercial"', 'created_at__2': datetime.datetime(2025, 5, 19, 16, 4, 54, 608791), 'id__2': UUID('33b49077-4422-4b10-9c8e-5c45390f2b90'), 'conversation_id__2': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d'), 'key__2': 'sector', 'value__3': '"Hotel"', 'created_at__3': datetime.datetime(2025, 5, 19, 16, 4, 54, 608793), 'id__3': UUID('685c75bb-fa71-4fe2-a531-f66076adba34'), 'conversation_id__3': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d'), 'key__3': 'subsector', 'value__4': '"hydrous"', 'created_at__4': datetime.datetime(2025, 5, 19, 16, 4, 54, 608795), 'id__4': UUID('4bed33a6-d897-405c-b518-3277388e2423'), 'conversation_id__4': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d'), 'key__4': 'company_name', 'value__5': '"hydrous20@gmail.com"', 'created_at__5': datetime.datetime(2025, 5, 19, 16, 4, 54, 608796), 'id__5': UUID('7ea941ca-fe3b-491d-91b8-f9a21562451b'), 'conversation_id__5': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d'), 'key__5': 'user_email', 'value__6': 'true', 'created_at__6': datetime.datetime(2025, 5, 19, 16, 4, 54, 608799), 'id__6': UUID('081869d3-e4ee-4caf-b597-a13f88ba0427'), 'conversation_id__6': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d'), 'key__6': 'is_new_conversation', 'value__7': 'true', 'created_at__7': datetime.datetime(2025, 5, 19, 16, 4, 54, 608801), 'id__7': UUID('2e64af59-4277-4476-8abc-846ae3b1c55c'), 'conversation_id__7': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d'), 'key__7': 'first_interaction'}
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - [generated in 0.00082s] {'pk_1': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d')}
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - [generated in 0.00056s] {'id_1': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d'), 'param_1': 1}
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - [cached since 0.01194s ago] {'pk_1': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d')}
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - [generated in 0.00072s] {'conversation_id_1': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d'), 'key_1': 'user_name', 'param_1': 1}
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - [cached since 0.0105s ago] {'conversation_id_1': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d'), 'key_1': 'user_location', 'param_1': 1}
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - [cached since 0.01683s ago] {'conversation_id_1': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d'), 'key_1': 'sector', 'param_1': 1}
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - [cached since 0.02629s ago] {'conversation_id_1': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d'), 'key_1': 'subsector', 'param_1': 1}
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - [cached since 0.03706s ago] {'conversation_id_1': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d'), 'key_1': 'company_name', 'param_1': 1}
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - [cached since 0.04229s ago] {'conversation_id_1': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d'), 'key_1': 'user_email', 'param_1': 1}
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - [cached since 0.05042s ago] {'conversation_id_1': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d'), 'key_1': 'is_new_conversation', 'param_1': 1}
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - [cached since 0.05593s ago] {'conversation_id_1': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d'), 'key_1': 'first_interaction', 'param_1': 1}
2025-05-19 16:04:54 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 16:04:54 - hydrous - INFO - DBG_SS: Conversación 1583bd51-e7d9-4091-85c5-3203ec60274d actualizada en base de datos.
2025-05-19 16:04:57 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 16:04:57 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 16:04:57 - sqlalchemy.engine.Engine - INFO - [cached since 2.915s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 16:04:57 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 16:04:57 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 16:04:57 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 16:04:57 - sqlalchemy.engine.Engine - INFO - [cached since 2.879s ago] {'id_1': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d'), 'param_1': 1}
2025-05-19 16:04:57 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE messages.conversation_id = %(conversation_id_1)s::UUID ORDER BY messages.created_at
2025-05-19 16:04:57 - sqlalchemy.engine.Engine - INFO - [generated in 0.00142s] {'conversation_id_1': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d')}
2025-05-19 16:04:57 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID
2025-05-19 16:04:57 - sqlalchemy.engine.Engine - INFO - [generated in 0.00035s] {'conversation_id_1': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d')}
2025-05-19 16:04:57 - hydrous - INFO - DBG_SS: Conversación 1583bd51-e7d9-4091-85c5-3203ec60274d RECUPERADA. Metadata actual: {'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 16:04:57 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 16:04:57 - sqlalchemy.engine.Engine - INFO - [cached since 2.915s ago] {'id_1': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d'), 'param_1': 1}
2025-05-19 16:04:57 - hydrous - INFO - PDF_CHECK: ConvID=1583bd51-e7d9-4091-85c5-3203ec60274d, Input='yes', is_pdf_req=False, proposal_ready=False, is_complete=False, pdf_path=None, ready_for_proposal=False
2025-05-19 16:04:57 - hydrous - INFO - Normal flow for conversation 1583bd51-e7d9-4091-85c5-3203ec60274d
2025-05-19 16:04:57 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 16:04:57 - sqlalchemy.engine.Engine - INFO - [cached since 2.921s ago] {'id_1': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d'), 'param_1': 1}
2025-05-19 16:04:57 - sqlalchemy.engine.Engine - INFO - INSERT INTO messages (conversation_id, role, content, id, created_at) VALUES (%(conversation_id)s::UUID, %(role)s, %(content)s, %(id)s::UUID, %(created_at)s)
2025-05-19 16:04:57 - sqlalchemy.engine.Engine - INFO - [generated in 0.00388s] {'conversation_id': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d'), 'role': 'user', 'content': 'yes', 'id': UUID('c1bc8764-b3ba-4869-bb41-b19cf055fac4'), 'created_at': datetime.datetime(2025, 5, 19, 16, 4, 57, 568781)}
2025-05-19 16:04:57 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 16:04:57 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 16:04:57 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id, messages.role, messages.content, messages.id, messages.created_at 
FROM messages 
WHERE messages.id = %(pk_1)s::UUID
2025-05-19 16:04:57 - sqlalchemy.engine.Engine - INFO - [generated in 0.00115s] {'pk_1': UUID('c1bc8764-b3ba-4869-bb41-b19cf055fac4')}
2025-05-19 16:04:57 - hydrous - INFO - Primera interacción detectada para conversación 1583bd51-e7d9-4091-85c5-3203ec60274d. Actualizando metadata.
2025-05-19 16:04:57 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 16:04:57 - sqlalchemy.engine.Engine - INFO - [cached since 2.961s ago] {'id_1': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d'), 'param_1': 1}
2025-05-19 16:04:57 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id AS messages_conversation_id, messages.role AS messages_role, messages.content AS messages_content, messages.id AS messages_id, messages.created_at AS messages_created_at 
FROM messages 
WHERE messages.conversation_id = %(conversation_id_1)s::UUID ORDER BY messages.created_at
2025-05-19 16:04:57 - sqlalchemy.engine.Engine - INFO - [cached since 0.0715s ago] {'conversation_id_1': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d')}
2025-05-19 16:04:57 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID
2025-05-19 16:04:57 - sqlalchemy.engine.Engine - INFO - [cached since 0.0686s ago] {'conversation_id_1': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d')}
2025-05-19 16:04:57 - hydrous - INFO - DBG_SS: Conversación 1583bd51-e7d9-4091-85c5-3203ec60274d RECUPERADA. Metadata actual: {'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 16:04:57 - hydrous - INFO - DBG_AI_HANDLE: Iniciando handle_conversation para conv 1583bd51-e7d9-4091-85c5-3203ec60274d
2025-05-19 16:04:57 - hydrous - INFO - Metadata recibida en _prepare_messages: sector=commercial, subsector=Hotel, location=los mochis, client_name=Ricardo Altamirano, company_name=hydrous, is_new_conversation=True
2025-05-19 16:04:57 - hydrous - INFO - Datos de usuario procesados: nombre=Ricardo Altamirano, empresa=hydrous, sector=commercial, subsector=Hotel, ubicacion=los mochis, nueva_conversacion=True, primera_interaccion=True
2025-05-19 16:04:57 - hydrous - INFO - Added additional user context and conversation state to the prompt.
2025-05-19 16:04:57 - hydrous - INFO - DBG_AI_HANDLE: Mensajes preparados OK (Total: 3).
2025-05-19 16:04:57 - hydrous - INFO - DBG_AI_CALL: Iniciando llamada a API LLM. URL: https://api.openai.com/v1/chat/completions, Model: gpt-4o-mini, #Msgs: 3
2025-05-19 16:05:00 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-19 16:05:00 - hydrous - INFO - DBG_AI_CALL: Llamada a API completada. Status: 200
2025-05-19 16:05:00 - hydrous - INFO - DBG_AI_CALL: Contenido LLM extraído exitosamente (longitud: 553).
2025-05-19 16:05:00 - hydrous - INFO - DBG_AI_HANDLE: Respuesta LLM recibida (primeros 50 chars): 'I see you're in the **hotel** sector in **Los Moch'
2025-05-19 16:05:00 - hydrous - INFO - Metadata[current_question_asked_summary] actualizada a: 'What is the average cost of water in your area (currency/unit of measurement)?'
2025-05-19 16:05:00 - hydrous - INFO - DBG_AI_HANDLE: Finalizando handle_conversation para 1583bd51-e7d9-4091-85c5-3203ec60274d. Respuesta final: 'I see you're in the **hotel** sector in **Los Moch...'
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - [cached since 6.366s ago] {'id_1': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d'), 'param_1': 1}
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - INSERT INTO messages (conversation_id, role, content, id, created_at) VALUES (%(conversation_id)s::UUID, %(role)s, %(content)s, %(id)s::UUID, %(created_at)s)
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - [cached since 3.458s ago] {'conversation_id': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d'), 'role': 'assistant', 'content': "I see you're in the **hotel** sector in **Los Mochis**. \n\n> 💧 **Relevant fact:** Hotels can consume between 100 to 300 gallons of water per room pe ... (260 characters truncated) ... we ask this?* Understanding the cost of water helps us evaluate the potential savings from implementing a wastewater treatment or recycling solution.", 'id': UUID('2f20a674-cada-41c3-9225-916f4df63df6'), 'created_at': datetime.datetime(2025, 5, 19, 16, 5, 1, 24413)}
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - SELECT messages.conversation_id, messages.role, messages.content, messages.id, messages.created_at 
FROM messages 
WHERE messages.id = %(pk_1)s::UUID
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - [cached since 3.457s ago] {'pk_1': UUID('2f20a674-cada-41c3-9225-916f4df63df6')}
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - [cached since 6.414s ago] {'id_1': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d'), 'param_1': 1}
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - UPDATE conversations SET current_question_id=%(current_question_id)s WHERE conversations.id = %(conversations_id)s::UUID
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - [generated in 0.00096s] {'current_question_id': 'q_4', 'conversations_id': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d')}
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - [cached since 6.451s ago] {'pk_1': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d')}
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - [cached since 6.437s ago] {'conversation_id_1': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d'), 'key_1': 'user_name', 'param_1': 1}
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - [cached since 6.442s ago] {'conversation_id_1': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d'), 'key_1': 'user_location', 'param_1': 1}
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - [cached since 6.446s ago] {'conversation_id_1': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d'), 'key_1': 'sector', 'param_1': 1}
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - [cached since 6.448s ago] {'conversation_id_1': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d'), 'key_1': 'subsector', 'param_1': 1}
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - [cached since 6.451s ago] {'conversation_id_1': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d'), 'key_1': 'company_name', 'param_1': 1}
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - [cached since 6.455s ago] {'conversation_id_1': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d'), 'key_1': 'user_email', 'param_1': 1}
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - [cached since 6.457s ago] {'conversation_id_1': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d'), 'key_1': 'is_new_conversation', 'param_1': 1}
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - [cached since 6.462s ago] {'conversation_id_1': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d'), 'key_1': 'first_interaction', 'param_1': 1}
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - [cached since 6.467s ago] {'conversation_id_1': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d'), 'key_1': 'location', 'param_1': 1}
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversation_metadata (conversation_id, key, value, id, created_at) VALUES (%(conversation_id)s::UUID, %(key)s, %(value)s::JSONB, %(id)s::UUID, %(created_at)s)
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - [generated in 0.00060s] {'conversation_id': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d'), 'key': 'location', 'value': '"los mochis"', 'id': UUID('fa69a5b6-3d81-433d-896f-cb1eb6140e64'), 'created_at': datetime.datetime(2025, 5, 19, 16, 5, 1, 116635)}
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - [cached since 6.474s ago] {'conversation_id_1': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d'), 'key_1': 'current_question_asked_summary', 'param_1': 1}
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversation_metadata (conversation_id, key, value, id, created_at) VALUES (%(conversation_id)s::UUID, %(key)s, %(value)s::JSONB, %(id)s::UUID, %(created_at)s)
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - [cached since 0.006751s ago] {'conversation_id': UUID('1583bd51-e7d9-4091-85c5-3203ec60274d'), 'key': 'current_question_asked_summary', 'value': '"What is the average cost of water in your area (currency/unit of measurement)?"', 'id': UUID('7fe101dc-a01c-4ce1-abe8-faedff72ef72'), 'created_at': datetime.datetime(2025, 5, 19, 16, 5, 1, 123014)}
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 16:05:01 - hydrous - INFO - DBG_SS: Conversación 1583bd51-e7d9-4091-85c5-3203ec60274d actualizada en base de datos.
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.created_at < %(created_at_1)s
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - [generated in 0.00058s] {'created_at_1': datetime.datetime(2025, 5, 18, 16, 5, 1, 134296)}
2025-05-19 16:05:01 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.company_name AS users_company_name, users.location AS users_location, users.sector AS users_sector, users.subsector AS users_subsector, users.is_active AS users_is_active, users.id AS users_id, users.created_at AS users_created_at 
FROM users 
WHERE users.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - [cached since 21.48s ago] {'id_1': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'param_1': 1}
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-05-19 16:05:16 - hydrous - INFO - Datos del usuario al iniciar conversación: nombre=Ricardo Altamirano, empresa=hydrous, sector=commercial, subsector=Hotel, ubicación=los mochis, email=hydrous20@gmail.com
2025-05-19 16:05:16 - hydrous - INFO - Metadata inicial de la conversación: {'client_name': 'Ricardo Altamirano', 'user_name': 'Ricardo Altamirano', 'user_location': 'los mochis', 'selected_sector': 'commercial', 'selected_subsector': 'Hotel', 'sector': 'commercial', 'subsector': 'Hotel', 'company_name': 'hydrous', 'user_email': 'hydrous20@gmail.com', 'is_new_conversation': True, 'first_interaction': True}
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversations (user_id, selected_sector, selected_subsector, current_question_id, is_complete, has_proposal, client_name, proposal_text, pdf_path, id, created_at) VALUES (%(user_id)s::UUID, %(selected_sector)s, %(selected_subsector)s, %(current_question_id)s, %(is_complete)s, %(has_proposal)s, %(client_name)s, %(proposal_text)s, %(pdf_path)s, %(id)s::UUID, %(created_at)s)
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - [cached since 21.54s ago] {'user_id': UUID('0a2d81c2-a9ae-4009-bd02-749bd4e44967'), 'selected_sector': 'commercial', 'selected_subsector': 'Hotel', 'current_question_id': None, 'is_complete': False, 'has_proposal': False, 'client_name': 'Ricardo Altamirano', 'proposal_text': None, 'pdf_path': None, 'id': UUID('4437c3c4-d6be-466e-a2be-42265c96fc24'), 'created_at': datetime.datetime(2025, 5, 19, 16, 5, 16, 136985)}
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - INSERT INTO conversation_metadata (conversation_id, key, value, id, created_at) VALUES (%(conversation_id__0)s::UUID, %(key__0)s, %(value__0)s::JSONB, %(id__0)s::UUID, %(created_at__0)s), (%(conversation_id__1)s::UUID, %(key__1)s, %(value__1)s::JSONB ... 543 characters truncated ...  (%(conversation_id__7)s::UUID, %(key__7)s, %(value__7)s::JSONB, %(id__7)s::UUID, %(created_at__7)s)
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - [cached since 21.54s ago (insertmanyvalues) 1/1 (unordered)] {'value__0': '"Ricardo Altamirano"', 'created_at__0': datetime.datetime(2025, 5, 19, 16, 5, 16, 148069), 'id__0': UUID('602931e3-bfba-4f3e-8a83-faeac73b7fcb'), 'conversation_id__0': UUID('4437c3c4-d6be-466e-a2be-42265c96fc24'), 'key__0': 'user_name', 'value__1': '"los mochis"', 'created_at__1': datetime.datetime(2025, 5, 19, 16, 5, 16, 148075), 'id__1': UUID('77db1a3d-5739-4843-b992-f56e1e268007'), 'conversation_id__1': UUID('4437c3c4-d6be-466e-a2be-42265c96fc24'), 'key__1': 'user_location', 'value__2': '"commercial"', 'created_at__2': datetime.datetime(2025, 5, 19, 16, 5, 16, 148077), 'id__2': UUID('2d958f66-268c-4b14-92d1-450c5c4b1673'), 'conversation_id__2': UUID('4437c3c4-d6be-466e-a2be-42265c96fc24'), 'key__2': 'sector', 'value__3': '"Hotel"', 'created_at__3': datetime.datetime(2025, 5, 19, 16, 5, 16, 148079), 'id__3': UUID('2ccb97fd-30c3-4929-95b0-50472a7549c1'), 'conversation_id__3': UUID('4437c3c4-d6be-466e-a2be-42265c96fc24'), 'key__3': 'subsector', 'value__4': '"hydrous"', 'created_at__4': datetime.datetime(2025, 5, 19, 16, 5, 16, 148080), 'id__4': UUID('6bb18487-d124-40d7-bfd1-bebbc39767fc'), 'conversation_id__4': UUID('4437c3c4-d6be-466e-a2be-42265c96fc24'), 'key__4': 'company_name', 'value__5': '"hydrous20@gmail.com"', 'created_at__5': datetime.datetime(2025, 5, 19, 16, 5, 16, 148082), 'id__5': UUID('41f604e9-07e7-437d-ba66-ebce0be3a2cf'), 'conversation_id__5': UUID('4437c3c4-d6be-466e-a2be-42265c96fc24'), 'key__5': 'user_email', 'value__6': 'true', 'created_at__6': datetime.datetime(2025, 5, 19, 16, 5, 16, 148084), 'id__6': UUID('aff35a4e-d0f2-47e0-9c4b-0770414b1d86'), 'conversation_id__6': UUID('4437c3c4-d6be-466e-a2be-42265c96fc24'), 'key__6': 'is_new_conversation', 'value__7': 'true', 'created_at__7': datetime.datetime(2025, 5, 19, 16, 5, 16, 148085), 'id__7': UUID('57ccf0c4-9081-4f33-998d-df2204205251'), 'conversation_id__7': UUID('4437c3c4-d6be-466e-a2be-42265c96fc24'), 'key__7': 'first_interaction'}
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - [cached since 21.53s ago] {'pk_1': UUID('4437c3c4-d6be-466e-a2be-42265c96fc24')}
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id AS conversations_user_id, conversations.selected_sector AS conversations_selected_sector, conversations.selected_subsector AS conversations_selected_subsector, conversations.current_question_id AS conversations_current_question_id, conversations.is_complete AS conversations_is_complete, conversations.has_proposal AS conversations_has_proposal, conversations.client_name AS conversations_client_name, conversations.proposal_text AS conversations_proposal_text, conversations.pdf_path AS conversations_pdf_path, conversations.id AS conversations_id, conversations.created_at AS conversations_created_at 
FROM conversations 
WHERE conversations.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - [cached since 21.53s ago] {'id_1': UUID('4437c3c4-d6be-466e-a2be-42265c96fc24'), 'param_1': 1}
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - SELECT conversations.user_id, conversations.selected_sector, conversations.selected_subsector, conversations.current_question_id, conversations.is_complete, conversations.has_proposal, conversations.client_name, conversations.proposal_text, conversations.pdf_path, conversations.id, conversations.created_at 
FROM conversations 
WHERE conversations.id = %(pk_1)s::UUID
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - [cached since 21.54s ago] {'pk_1': UUID('4437c3c4-d6be-466e-a2be-42265c96fc24')}
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - [cached since 21.54s ago] {'conversation_id_1': UUID('4437c3c4-d6be-466e-a2be-42265c96fc24'), 'key_1': 'user_name', 'param_1': 1}
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - [cached since 21.55s ago] {'conversation_id_1': UUID('4437c3c4-d6be-466e-a2be-42265c96fc24'), 'key_1': 'user_location', 'param_1': 1}
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - [cached since 21.56s ago] {'conversation_id_1': UUID('4437c3c4-d6be-466e-a2be-42265c96fc24'), 'key_1': 'sector', 'param_1': 1}
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - [cached since 21.58s ago] {'conversation_id_1': UUID('4437c3c4-d6be-466e-a2be-42265c96fc24'), 'key_1': 'subsector', 'param_1': 1}
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - [cached since 21.58s ago] {'conversation_id_1': UUID('4437c3c4-d6be-466e-a2be-42265c96fc24'), 'key_1': 'company_name', 'param_1': 1}
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - [cached since 21.59s ago] {'conversation_id_1': UUID('4437c3c4-d6be-466e-a2be-42265c96fc24'), 'key_1': 'user_email', 'param_1': 1}
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - [cached since 21.59s ago] {'conversation_id_1': UUID('4437c3c4-d6be-466e-a2be-42265c96fc24'), 'key_1': 'is_new_conversation', 'param_1': 1}
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - SELECT conversation_metadata.conversation_id AS conversation_metadata_conversation_id, conversation_metadata.key AS conversation_metadata_key, conversation_metadata.value AS conversation_metadata_value, conversation_metadata.id AS conversation_metadata_id, conversation_metadata.created_at AS conversation_metadata_created_at 
FROM conversation_metadata 
WHERE conversation_metadata.conversation_id = %(conversation_id_1)s::UUID AND conversation_metadata.key = %(key_1)s 
 LIMIT %(param_1)s
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - [cached since 21.6s ago] {'conversation_id_1': UUID('4437c3c4-d6be-466e-a2be-42265c96fc24'), 'key_1': 'first_interaction', 'param_1': 1}
2025-05-19 16:05:16 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-05-19 16:05:16 - hydrous - INFO - DBG_SS: Conversación 4437c3c4-d6be-466e-a2be-42265c96fc24 actualizada en base de datos.
